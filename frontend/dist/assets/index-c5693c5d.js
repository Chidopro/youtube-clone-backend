var ca=(t,s)=>()=>(s||t((s={exports:{}}).exports,s),s.exports);import{r as l,a as da,u as je,L as Pe,b as Bt,N as ha,d as ct,e as wt,R as ua,f as ue,h as ma,B as pa}from"./vendor-86b923c5.js";import{c as fa}from"./supabase-0ee22f2c.js";var hc=ca((gc,Ot)=>{(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var nr={exports:{}},Ht={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ga=l,xa=Symbol.for("react.element"),ya=Symbol.for("react.fragment"),va=Object.prototype.hasOwnProperty,ja=ga.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,wa={key:!0,ref:!0,__self:!0,__source:!0};function ir(t,s,r){var a,n={},i=null,o=null;r!==void 0&&(i=""+r),s.key!==void 0&&(i=""+s.key),s.ref!==void 0&&(o=s.ref);for(a in s)va.call(s,a)&&!wa.hasOwnProperty(a)&&(n[a]=s[a]);if(t&&t.defaultProps)for(a in s=t.defaultProps,s)n[a]===void 0&&(n[a]=s[a]);return{$$typeof:xa,type:t,key:i,ref:o,props:n,_owner:ja.current}}Ht.Fragment=ya;Ht.jsx=ir;Ht.jsxs=ir;nr.exports=Ht;var e=nr.exports,us={},Xs=da;us.createRoot=Xs.createRoot,us.hydrateRoot=Xs.hydrateRoot;const Sa="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAhCAYAAABN2CLhAAAAAXNSR0IArs4c6QAAARhJREFUWAntWNENgjAQpYYBdAM3EDZgA9lAnMC4ARs4AnWDuoEbqBt0BNjA9z5M+kNaI8WS3CWXUO64vr42uUdV0zRVlmUXeAFP2SzAGa31WQH0A4PUAbtkliuMNu6bBTwXBG0WANSFaBRHOCI8HrUbSfDZAhPPdJ8gNoEkDAgDwoAwsHQGKJi2WMQJzq74L+uVUqbrumsIAII2SNyHJM+QU6JNP33zUDBVvqQZ43XIXKmpPO6613JktHBuSdAqkRfDLIpSwRGHmDAgDAgDwoAwMD8Dn3sPdsPdBNP3qHFDZ7MT1BotkUPlaUQPoxnfB1p8EvWqjYJpas2xBhEV6kYzgr5HqB5V+BB0C+cfwwD/1V4ocIx93/YG6YM08g0WFTYAAAAASUVORK5CYII=",Vt="/assets/screenmerch_logo.png-13fa081f.png",ba="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAYCAYAAAARfGZ1AAAAAXNSR0IArs4c6QAAAh5JREFUSA2tlDFP60AMx0m6doCJkZGxfRIDEwoDAxNlKSuv6ohE+QCIdGOEiaGVyjcARrYgsTd8kac3MLf8fLWPS0hRW9WSY5/v778dXy7RxhwZjUYtthpogjZRkRzNptNp3ul0Xlzkl0dU3oNUiEaoEZYhtpZCfxGxlRKHUYhT1mO0SXcf2D56iG6pit/XPSk+JucGWym+cyU24D0d9SozCILdxKToJSpyBf5u5n4/HTlg14WGTwE+f0Pme+S12H1SxJ/yiNxYeM1HBUjHCxELXrH3mivnVJBYqkdR1JA5Au4VdhdbpHYG+iY+SzpvyooCC3fss3Fo6H+Q67hsP6ZqoovMgitYlxtwOQrfOat8BVJLcbkyXguILXzn4cYqPp37T9vIrePCvJYkt1zjcukxr5IpUaJ2FeNyAy7HIWOxaid8SpvLMmvOieYZ14xcLoJ9p0RSBS1jJMf9i/RS+Vx3oLzOuUYuyxfBIyscxbr/S8Dhkf50AaZE7cd1h9+XC+KRgaOjEGxPw1dgJacgnlyipQI5IRlZRlfy+93Ab+AnuC20iYrcEt+bTCZn3W733yw0exbIJUQBmd8jJIULESaJD+ZDR/HAcp/1uF6vH7Tb7U/D/iC3DYq47khKiFmXOYQZ69wObzgc7sRx/EZ8B+w7BY6twFxyCBYWLfBKgd2wwFrIpYvBYLBdq9XkDVwB7NHayCsKXK+VPChwwezTL5f411qp3J6CAAAAAElFTkSuQmCC",_a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAAAidJREFUaAXtmN1NwzAQx++SSuWNVPAOGxBASOWJbAAjdISyAWzABu0mLU8UISAjtO9IgQFic1fJUWi+HLBaB9kPdXK+2P79a+cuBnDFKeAUcAo4BZwCToH/owAqlCQMg7TvTxBkBIiBsm+zlgBzP01vBy9x3HZcTz1AEFNEuNkVBM+DVI2E581YVDWvqpp9kmF4rNozEIK4Vsad1rwa9iCsmwNDiL4/I59j5ZeBKIPtdQaBP2E7BVIFweL3TPwDB4vX7KWh+vsYns0R8Erd/7Wug+C+O/GPNEF0AkQHwnoQXQirQdpAMIiRzc4dmSyp8APsw4wiZG08yY9pJQiinLTNMDRB5IryoGVegaZrlBBL+ikrZA5ooidlbWvbL3I9TRCYHi7e7ioHLmk4eH4bl5jXJsqRIgE+pxjGSifiiA6tA9FRaZs+unvkKLk8rcybBk/vj5uTTi7CEHq4v2nneyG8E/74MFk0QXAkJI5qBi5MK/W9B5QVSWPBu6ZnzSY794iUtyDhS5Nh7WYliIci9kQatYGxEoQl5gOINjDWgrSFsRqkDYz1ILowmq9f7q66fAzPC3kTSmk0VvCeodhE517+nGJQIT4ZAaGwEBUw6aDMdKmD6cTSygtS9TbLgchV/oEdXy/rxs9gUvhUftnSkgLHtBqmZetPOW+nlveDRbxsGoth8j4/FjJ/8Dedu+YfNn5NCm9O0PgYrkOngFPAKeAUcAr8ZwW+ASU7qyTOpG88AAAAAElFTkSuQmCC",Na={development:{API_BASE_URL:"http://127.0.0.1:5000",EMAIL_API_URL:"http://localhost:3001",SUBSCRIPTION_API_URL:"http://localhost:3002",SUPABASE_URL:"https://sojxbydpcdcdzfdtbypd.supabase.co",SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNvanhieWRwY2RjZHpmZHRieXBkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4NTIwNTUsImV4cCI6MjA2NTQyODA1NX0.BUm9LKbNs-EdJKxwwtoY3IRyokmDtRbS0XP-WBw-5no"},production:{API_BASE_URL:"https://screenmerch.fly.dev",EMAIL_API_URL:"https://screenmerch.fly.dev",SUBSCRIPTION_API_URL:"https://screenmerch.fly.dev",SUPABASE_URL:"https://sojxbydpcdcdzfdtbypd.supabase.co",SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNvanhieWRwY2RjZHpmZHRieXBkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4NTIwNTUsImV4cCI6MjA2NTQyODA1NX0.BUm9LKbNs-EdJKxwwtoY3IRyokmDtRbS0XP-WBw-5no"}},ge=Na.production;ge.API_BASE_URL="https://screenmerch.fly.dev",ge.EMAIL_API_URL="https://screenmerch.fly.dev",ge.SUBSCRIPTION_API_URL="https://screenmerch.fly.dev",console.log("🔧 FORCING PRODUCTION API CONFIG OVERRIDE"),console.log("🔧 Forced API_BASE_URL:",ge.API_BASE_URL);const ve={BASE_URL:ge.API_BASE_URL,EMAIL_API_URL:ge.EMAIL_API_URL,SUBSCRIPTION_API_URL:ge.SUBSCRIPTION_API_URL,SUPABASE_URL:ge.SUPABASE_URL,SUPABASE_ANON_KEY:ge.SUPABASE_ANON_KEY,ENDPOINTS:{CREATE_PRODUCT:`${ge.API_BASE_URL}/api/create-product`,CALCULATE_SHIPPING:`${ge.API_BASE_URL}/api/calculate-shipping`,PLACE_ORDER:`${ge.API_BASE_URL}/api/place-order`,CREATE_CHECKOUT_SESSION:`${ge.API_BASE_URL}/api/create-checkout-session`,SEND_SUBSCRIPTION_EMAIL:`${ge.EMAIL_API_URL}/api/send-subscription-email`,VERIFY_SUBSCRIPTION:`${ge.SUBSCRIPTION_API_URL}/api/verify-subscription`,USER_SUBSCRIPTION:`${ge.SUBSCRIPTION_API_URL}/api/users`,CAPTURE_SCREENSHOT:`${ge.API_BASE_URL}/api/capture-screenshot`,CAPTURE_MULTIPLE_SCREENSHOTS:`${ge.API_BASE_URL}/api/capture-multiple-screenshots`,VIDEO_INFO:`${ge.API_BASE_URL}/api/video-info`}},ka=({isOpen:t,onClose:s})=>{const[r,a]=l.useState(""),[n,i]=l.useState(!1),[o,d]=l.useState(""),[x,y]=l.useState(""),m=async v=>{if(v.preventDefault(),!r){d("Please enter a valid email address"),y("error");return}i(!0),d("");try{const u=await fetch(ve.ENDPOINTS.SEND_SUBSCRIPTION_EMAIL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r})}),g=await u.json();if(u.ok)d(`Subscription email sent to ${r}! Please check your inbox for approval link.`),y("success"),a(""),setTimeout(()=>{s(),d("")},3e3);else throw new Error(g.error||"Failed to send email")}catch(u){console.error("Error:",u),u.message.includes("fetch")?d("Backend server is not running. Please start the backend server first."):d(`Failed to send email: ${u.message}`),y("error")}finally{i(!1)}};return t?e.jsx("div",{className:"modal-overlay",onClick:s,children:e.jsxs("div",{className:"modal-content",onClick:v=>v.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:"Subscribe to ScreenMerch"}),e.jsx("button",{className:"close-btn",onClick:s,children:"×"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("p",{children:"Enter your email to receive a subscription approval link:"}),e.jsxs("form",{onSubmit:m,children:[e.jsx("div",{className:"email-input-group",children:e.jsx("input",{type:"email",value:r,onChange:v=>a(v.target.value),placeholder:"Enter your email address",required:!0,disabled:n})}),o&&e.jsx("div",{className:`message ${x}`,children:o}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{type:"button",className:"cancel-btn",onClick:s,disabled:n,children:"Cancel"}),e.jsx("button",{type:"submit",className:"subscribe-modal-btn",disabled:n,children:n?"Sending...":"Send Approval Link"})]})]})]})]})}):null},Ca=({setSidebar:t,resetCategory:s})=>{const[r,a]=l.useState(!1),[n,i]=l.useState(""),o=je(),d=()=>{a(!1)},x=v=>{i(v.target.value)},y=()=>{n.trim()&&o(`/search?q=${encodeURIComponent(n.trim())}`)},m=v=>{v.key==="Enter"&&y()};return console.log("🔍 Navbar component rendering - simplified version"),e.jsxs(e.Fragment,{children:[e.jsxs("nav",{className:"flex-div",style:{position:"sticky",top:0,zIndex:9999,pointerEvents:"auto"},children:[e.jsxs("div",{className:"nav-left flex-div",children:[e.jsx("img",{src:Sa,alt:"Menu",className:"menu-icon",onClick:v=>{v.preventDefault(),v.stopPropagation(),console.log("🍔 Hamburger clicked - redirecting to home"),o("/")},style:{cursor:"pointer",pointerEvents:"auto",zIndex:10001},title:"Go to Home"}),e.jsxs(Pe,{to:"/",onClick:s,children:[" ",e.jsx("img",{src:Vt,alt:"",className:"logo"})]})]}),e.jsx("div",{className:"nav-middle flex-div",children:e.jsxs("div",{className:"search-box flex-div",children:[e.jsx("input",{type:"text",placeholder:"Search creators...",value:n,onChange:x,onKeyPress:m}),e.jsx("img",{src:ba,alt:"Search",onClick:v=>{v.preventDefault(),v.stopPropagation(),console.log("🔍 Search icon clicked!"),y()},style:{cursor:"pointer",pointerEvents:"auto",zIndex:1e4},title:"Search creators"})]})}),e.jsxs("div",{className:"nav-right flex-div",children:[e.jsx("img",{src:_a,alt:"Upload",style:{cursor:"pointer",pointerEvents:"auto",zIndex:10001},onClick:v=>{v.preventDefault(),v.stopPropagation(),console.log("📤 Upload button clicked - redirecting to home"),o("/")},title:"Go to Home"}),e.jsx(Pe,{to:"/subscription-tiers",className:"subscribe-btn",onClick:v=>{console.log("🚀 Get Started Free Link clicked!")},style:{pointerEvents:"auto",zIndex:1e4},children:"Get Started Free"}),e.jsx("button",{className:"sign-in-btn",onClick:async v=>{v.preventDefault(),v.stopPropagation(),console.log("🔐 Sign In button clicked - initiating Google OAuth");try{const u=await fetch("https://screenmerch.fly.dev/api/auth/google/login",{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!u.ok)throw new Error("Failed to initiate Google login");const g=await u.json();if(g.success&&g.auth_url)window.location.href=g.auth_url;else throw new Error(g.error||"Failed to get Google login URL")}catch(u){console.error("Google login error:",u),alert("Login failed: "+u.message)}},style:{pointerEvents:"auto",zIndex:10001},title:"Sign in with Google",children:"Sign In"})]})]}),e.jsx(ka,{isOpen:r,onClose:d})]})},Pa=()=>e.jsx("footer",{className:"site-footer",children:e.jsx("div",{className:"footer-container",children:e.jsxs("div",{className:"footer-content",children:[e.jsx("div",{className:"footer-logo-section",children:e.jsx("img",{src:Vt,alt:"ScreenMerch",className:"footer-logo"})}),e.jsxs("div",{className:"footer-links-section",children:[e.jsx(Pe,{to:"/privacy-policy",children:"Privacy Policy"}),e.jsx(Pe,{to:"/terms-of-service",children:"Terms of Service"}),e.jsx("a",{href:"mailto:support@screenmerch.com",children:"Contact Us"})]}),e.jsx("div",{className:"footer-copyright",children:e.jsx("p",{children:"© 2025 ScreenMerch. All rights reserved."})})]})})}),Ma=t=>t>=1e6?Math.floor(t/1e6)+"M":t>=1e3?Math.floor(t/1e3)+"K":t;//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var or;function A(){return or.apply(null,arguments)}function Ea(t){or=t}function De(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function tt(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function ee(t,s){return Object.prototype.hasOwnProperty.call(t,s)}function js(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var s;for(s in t)if(ee(t,s))return!1;return!0}function be(t){return t===void 0}function ze(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function St(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function lr(t,s){var r=[],a,n=t.length;for(a=0;a<n;++a)r.push(s(t[a],a));return r}function Je(t,s){for(var r in s)ee(s,r)&&(t[r]=s[r]);return ee(s,"toString")&&(t.toString=s.toString),ee(s,"valueOf")&&(t.valueOf=s.valueOf),t}function Ye(t,s,r,a){return Tr(t,s,r,a,!0).utc()}function Ta(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function G(t){return t._pf==null&&(t._pf=Ta()),t._pf}var ms;Array.prototype.some?ms=Array.prototype.some:ms=function(t){var s=Object(this),r=s.length>>>0,a;for(a=0;a<r;a++)if(a in s&&t.call(this,s[a],a,s))return!0;return!1};function ws(t){var s=null,r=!1,a=t._d&&!isNaN(t._d.getTime());if(a&&(s=G(t),r=ms.call(s.parsedDateParts,function(n){return n!=null}),a=s.overflow<0&&!s.empty&&!s.invalidEra&&!s.invalidMonth&&!s.invalidWeekday&&!s.weekdayMismatch&&!s.nullInput&&!s.invalidFormat&&!s.userInvalidated&&(!s.meridiem||s.meridiem&&r),t._strict&&(a=a&&s.charsLeftOver===0&&s.unusedTokens.length===0&&s.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=a;else return a;return t._isValid}function zt(t){var s=Ye(NaN);return t!=null?Je(G(s),t):G(s).userInvalidated=!0,s}var Qs=A.momentProperties=[],ls=!1;function Ss(t,s){var r,a,n,i=Qs.length;if(be(s._isAMomentObject)||(t._isAMomentObject=s._isAMomentObject),be(s._i)||(t._i=s._i),be(s._f)||(t._f=s._f),be(s._l)||(t._l=s._l),be(s._strict)||(t._strict=s._strict),be(s._tzm)||(t._tzm=s._tzm),be(s._isUTC)||(t._isUTC=s._isUTC),be(s._offset)||(t._offset=s._offset),be(s._pf)||(t._pf=G(s)),be(s._locale)||(t._locale=s._locale),i>0)for(r=0;r<i;r++)a=Qs[r],n=s[a],be(n)||(t[a]=n);return t}function bt(t){Ss(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),ls===!1&&(ls=!0,A.updateOffset(this),ls=!1)}function Ie(t){return t instanceof bt||t!=null&&t._isAMomentObject!=null}function cr(t){A.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Me(t,s){var r=!0;return Je(function(){if(A.deprecationHandler!=null&&A.deprecationHandler(null,t),r){var a=[],n,i,o,d=arguments.length;for(i=0;i<d;i++){if(n="",typeof arguments[i]=="object"){n+=`
[`+i+"] ";for(o in arguments[0])ee(arguments[0],o)&&(n+=o+": "+arguments[0][o]+", ");n=n.slice(0,-2)}else n=arguments[i];a.push(n)}cr(t+`
Arguments: `+Array.prototype.slice.call(a).join("")+`
`+new Error().stack),r=!1}return s.apply(this,arguments)},s)}var Ks={};function dr(t,s){A.deprecationHandler!=null&&A.deprecationHandler(t,s),Ks[t]||(cr(s),Ks[t]=!0)}A.suppressDeprecationWarnings=!1;A.deprecationHandler=null;function Le(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function Aa(t){var s,r;for(r in t)ee(t,r)&&(s=t[r],Le(s)?this[r]=s:this["_"+r]=s);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function ps(t,s){var r=Je({},t),a;for(a in s)ee(s,a)&&(tt(t[a])&&tt(s[a])?(r[a]={},Je(r[a],t[a]),Je(r[a],s[a])):s[a]!=null?r[a]=s[a]:delete r[a]);for(a in t)ee(t,a)&&!ee(s,a)&&tt(t[a])&&(r[a]=Je({},r[a]));return r}function bs(t){t!=null&&this.set(t)}var fs;Object.keys?fs=Object.keys:fs=function(t){var s,r=[];for(s in t)ee(t,s)&&r.push(s);return r};var Da={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function Ia(t,s,r){var a=this._calendar[t]||this._calendar.sameElse;return Le(a)?a.call(s,r):a}function Re(t,s,r){var a=""+Math.abs(t),n=s-a.length,i=t>=0;return(i?r?"+":"":"-")+Math.pow(10,Math.max(0,n)).toString().substr(1)+a}var _s=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Tt=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,cs={},it={};function L(t,s,r,a){var n=a;typeof a=="string"&&(n=function(){return this[a]()}),t&&(it[t]=n),s&&(it[s[0]]=function(){return Re(n.apply(this,arguments),s[1],s[2])}),r&&(it[r]=function(){return this.localeData().ordinal(n.apply(this,arguments),t)})}function Ua(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function Oa(t){var s=t.match(_s),r,a;for(r=0,a=s.length;r<a;r++)it[s[r]]?s[r]=it[s[r]]:s[r]=Ua(s[r]);return function(n){var i="",o;for(o=0;o<a;o++)i+=Le(s[o])?s[o].call(n,t):s[o];return i}}function Dt(t,s){return t.isValid()?(s=hr(s,t.localeData()),cs[s]=cs[s]||Oa(s),cs[s](t)):t.localeData().invalidDate()}function hr(t,s){var r=5;function a(n){return s.longDateFormat(n)||n}for(Tt.lastIndex=0;r>=0&&Tt.test(t);)t=t.replace(Tt,a),Tt.lastIndex=0,r-=1;return t}var Ra={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function Ya(t){var s=this._longDateFormat[t],r=this._longDateFormat[t.toUpperCase()];return s||!r?s:(this._longDateFormat[t]=r.match(_s).map(function(a){return a==="MMMM"||a==="MM"||a==="DD"||a==="dddd"?a.slice(1):a}).join(""),this._longDateFormat[t])}var La="Invalid date";function Fa(){return this._invalidDate}var Wa="%d",$a=/\d{1,2}/;function Ba(t){return this._ordinal.replace("%d",t)}var Ha={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function Va(t,s,r,a){var n=this._relativeTime[r];return Le(n)?n(t,s,r,a):n.replace(/%d/i,t)}function za(t,s){var r=this._relativeTime[t>0?"future":"past"];return Le(r)?r(s):r.replace(/%s/i,s)}var er={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Ee(t){return typeof t=="string"?er[t]||er[t.toLowerCase()]:void 0}function Ns(t){var s={},r,a;for(a in t)ee(t,a)&&(r=Ee(a),r&&(s[r]=t[a]));return s}var Ga={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function qa(t){var s=[],r;for(r in t)ee(t,r)&&s.push({unit:r,priority:Ga[r]});return s.sort(function(a,n){return a.priority-n.priority}),s}var ur=/\d/,Ne=/\d\d/,mr=/\d{3}/,ks=/\d{4}/,Gt=/[+-]?\d{6}/,de=/\d\d?/,pr=/\d\d\d\d?/,fr=/\d\d\d\d\d\d?/,qt=/\d{1,3}/,Cs=/\d{1,4}/,Jt=/[+-]?\d{1,6}/,dt=/\d+/,Zt=/[+-]?\d+/,Ja=/Z|[+-]\d\d:?\d\d/gi,Xt=/Z|[+-]\d\d(?::?\d\d)?/gi,Za=/[+-]?\d+(\.\d{1,3})?/,_t=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,ht=/^[1-9]\d?/,Ps=/^([1-9]\d|\d)/,Rt;Rt={};function I(t,s,r){Rt[t]=Le(s)?s:function(a,n){return a&&r?r:s}}function Xa(t,s){return ee(Rt,t)?Rt[t](s._strict,s._locale):new RegExp(Qa(t))}function Qa(t){return He(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(s,r,a,n,i){return r||a||n||i}))}function He(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Ce(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Z(t){var s=+t,r=0;return s!==0&&isFinite(s)&&(r=Ce(s)),r}var gs={};function ie(t,s){var r,a=s,n;for(typeof t=="string"&&(t=[t]),ze(s)&&(a=function(i,o){o[s]=Z(i)}),n=t.length,r=0;r<n;r++)gs[t[r]]=a}function Nt(t,s){ie(t,function(r,a,n,i){n._w=n._w||{},s(r,n._w,n,i)})}function Ka(t,s,r){s!=null&&ee(gs,t)&&gs[t](s,r._a,r,t)}function Qt(t){return t%4===0&&t%100!==0||t%400===0}var we=0,$e=1,Oe=2,xe=3,Ae=4,Be=5,et=6,en=7,tn=8;L("Y",0,0,function(){var t=this.year();return t<=9999?Re(t,4):"+"+t});L(0,["YY",2],0,function(){return this.year()%100});L(0,["YYYY",4],0,"year");L(0,["YYYYY",5],0,"year");L(0,["YYYYYY",6,!0],0,"year");I("Y",Zt);I("YY",de,Ne);I("YYYY",Cs,ks);I("YYYYY",Jt,Gt);I("YYYYYY",Jt,Gt);ie(["YYYYY","YYYYYY"],we);ie("YYYY",function(t,s){s[we]=t.length===2?A.parseTwoDigitYear(t):Z(t)});ie("YY",function(t,s){s[we]=A.parseTwoDigitYear(t)});ie("Y",function(t,s){s[we]=parseInt(t,10)});function gt(t){return Qt(t)?366:365}A.parseTwoDigitYear=function(t){return Z(t)+(Z(t)>68?1900:2e3)};var gr=ut("FullYear",!0);function sn(){return Qt(this.year())}function ut(t,s){return function(r){return r!=null?(xr(this,t,r),A.updateOffset(this,s),this):xt(this,t)}}function xt(t,s){if(!t.isValid())return NaN;var r=t._d,a=t._isUTC;switch(s){case"Milliseconds":return a?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return a?r.getUTCSeconds():r.getSeconds();case"Minutes":return a?r.getUTCMinutes():r.getMinutes();case"Hours":return a?r.getUTCHours():r.getHours();case"Date":return a?r.getUTCDate():r.getDate();case"Day":return a?r.getUTCDay():r.getDay();case"Month":return a?r.getUTCMonth():r.getMonth();case"FullYear":return a?r.getUTCFullYear():r.getFullYear();default:return NaN}}function xr(t,s,r){var a,n,i,o,d;if(!(!t.isValid()||isNaN(r))){switch(a=t._d,n=t._isUTC,s){case"Milliseconds":return void(n?a.setUTCMilliseconds(r):a.setMilliseconds(r));case"Seconds":return void(n?a.setUTCSeconds(r):a.setSeconds(r));case"Minutes":return void(n?a.setUTCMinutes(r):a.setMinutes(r));case"Hours":return void(n?a.setUTCHours(r):a.setHours(r));case"Date":return void(n?a.setUTCDate(r):a.setDate(r));case"FullYear":break;default:return}i=r,o=t.month(),d=t.date(),d=d===29&&o===1&&!Qt(i)?28:d,n?a.setUTCFullYear(i,o,d):a.setFullYear(i,o,d)}}function rn(t){return t=Ee(t),Le(this[t])?this[t]():this}function an(t,s){if(typeof t=="object"){t=Ns(t);var r=qa(t),a,n=r.length;for(a=0;a<n;a++)this[r[a].unit](t[r[a].unit])}else if(t=Ee(t),Le(this[t]))return this[t](s);return this}function nn(t,s){return(t%s+s)%s}var fe;Array.prototype.indexOf?fe=Array.prototype.indexOf:fe=function(t){var s;for(s=0;s<this.length;++s)if(this[s]===t)return s;return-1};function Ms(t,s){if(isNaN(t)||isNaN(s))return NaN;var r=nn(s,12);return t+=(s-r)/12,r===1?Qt(t)?29:28:31-r%7%2}L("M",["MM",2],"Mo",function(){return this.month()+1});L("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});L("MMMM",0,0,function(t){return this.localeData().months(this,t)});I("M",de,ht);I("MM",de,Ne);I("MMM",function(t,s){return s.monthsShortRegex(t)});I("MMMM",function(t,s){return s.monthsRegex(t)});ie(["M","MM"],function(t,s){s[$e]=Z(t)-1});ie(["MMM","MMMM"],function(t,s,r,a){var n=r._locale.monthsParse(t,a,r._strict);n!=null?s[$e]=n:G(r).invalidMonth=t});var on="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),yr="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),vr=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,ln=_t,cn=_t;function dn(t,s){return t?De(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||vr).test(s)?"format":"standalone"][t.month()]:De(this._months)?this._months:this._months.standalone}function hn(t,s){return t?De(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[vr.test(s)?"format":"standalone"][t.month()]:De(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function un(t,s,r){var a,n,i,o=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],a=0;a<12;++a)i=Ye([2e3,a]),this._shortMonthsParse[a]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[a]=this.months(i,"").toLocaleLowerCase();return r?s==="MMM"?(n=fe.call(this._shortMonthsParse,o),n!==-1?n:null):(n=fe.call(this._longMonthsParse,o),n!==-1?n:null):s==="MMM"?(n=fe.call(this._shortMonthsParse,o),n!==-1?n:(n=fe.call(this._longMonthsParse,o),n!==-1?n:null)):(n=fe.call(this._longMonthsParse,o),n!==-1?n:(n=fe.call(this._shortMonthsParse,o),n!==-1?n:null))}function mn(t,s,r){var a,n,i;if(this._monthsParseExact)return un.call(this,t,s,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),a=0;a<12;a++){if(n=Ye([2e3,a]),r&&!this._longMonthsParse[a]&&(this._longMonthsParse[a]=new RegExp("^"+this.months(n,"").replace(".","")+"$","i"),this._shortMonthsParse[a]=new RegExp("^"+this.monthsShort(n,"").replace(".","")+"$","i")),!r&&!this._monthsParse[a]&&(i="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[a]=new RegExp(i.replace(".",""),"i")),r&&s==="MMMM"&&this._longMonthsParse[a].test(t))return a;if(r&&s==="MMM"&&this._shortMonthsParse[a].test(t))return a;if(!r&&this._monthsParse[a].test(t))return a}}function jr(t,s){if(!t.isValid())return t;if(typeof s=="string"){if(/^\d+$/.test(s))s=Z(s);else if(s=t.localeData().monthsParse(s),!ze(s))return t}var r=s,a=t.date();return a=a<29?a:Math.min(a,Ms(t.year(),r)),t._isUTC?t._d.setUTCMonth(r,a):t._d.setMonth(r,a),t}function wr(t){return t!=null?(jr(this,t),A.updateOffset(this,!0),this):xt(this,"Month")}function pn(){return Ms(this.year(),this.month())}function fn(t){return this._monthsParseExact?(ee(this,"_monthsRegex")||Sr.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(ee(this,"_monthsShortRegex")||(this._monthsShortRegex=ln),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function gn(t){return this._monthsParseExact?(ee(this,"_monthsRegex")||Sr.call(this),t?this._monthsStrictRegex:this._monthsRegex):(ee(this,"_monthsRegex")||(this._monthsRegex=cn),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function Sr(){function t(x,y){return y.length-x.length}var s=[],r=[],a=[],n,i,o,d;for(n=0;n<12;n++)i=Ye([2e3,n]),o=He(this.monthsShort(i,"")),d=He(this.months(i,"")),s.push(o),r.push(d),a.push(d),a.push(o);s.sort(t),r.sort(t),a.sort(t),this._monthsRegex=new RegExp("^("+a.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+s.join("|")+")","i")}function xn(t,s,r,a,n,i,o){var d;return t<100&&t>=0?(d=new Date(t+400,s,r,a,n,i,o),isFinite(d.getFullYear())&&d.setFullYear(t)):d=new Date(t,s,r,a,n,i,o),d}function yt(t){var s,r;return t<100&&t>=0?(r=Array.prototype.slice.call(arguments),r[0]=t+400,s=new Date(Date.UTC.apply(null,r)),isFinite(s.getUTCFullYear())&&s.setUTCFullYear(t)):s=new Date(Date.UTC.apply(null,arguments)),s}function Yt(t,s,r){var a=7+s-r,n=(7+yt(t,0,a).getUTCDay()-s)%7;return-n+a-1}function br(t,s,r,a,n){var i=(7+r-a)%7,o=Yt(t,a,n),d=1+7*(s-1)+i+o,x,y;return d<=0?(x=t-1,y=gt(x)+d):d>gt(t)?(x=t+1,y=d-gt(t)):(x=t,y=d),{year:x,dayOfYear:y}}function vt(t,s,r){var a=Yt(t.year(),s,r),n=Math.floor((t.dayOfYear()-a-1)/7)+1,i,o;return n<1?(o=t.year()-1,i=n+Ve(o,s,r)):n>Ve(t.year(),s,r)?(i=n-Ve(t.year(),s,r),o=t.year()+1):(o=t.year(),i=n),{week:i,year:o}}function Ve(t,s,r){var a=Yt(t,s,r),n=Yt(t+1,s,r);return(gt(t)-a+n)/7}L("w",["ww",2],"wo","week");L("W",["WW",2],"Wo","isoWeek");I("w",de,ht);I("ww",de,Ne);I("W",de,ht);I("WW",de,Ne);Nt(["w","ww","W","WW"],function(t,s,r,a){s[a.substr(0,1)]=Z(t)});function yn(t){return vt(t,this._week.dow,this._week.doy).week}var vn={dow:0,doy:6};function jn(){return this._week.dow}function wn(){return this._week.doy}function Sn(t){var s=this.localeData().week(this);return t==null?s:this.add((t-s)*7,"d")}function bn(t){var s=vt(this,1,4).week;return t==null?s:this.add((t-s)*7,"d")}L("d",0,"do","day");L("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});L("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});L("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});L("e",0,0,"weekday");L("E",0,0,"isoWeekday");I("d",de);I("e",de);I("E",de);I("dd",function(t,s){return s.weekdaysMinRegex(t)});I("ddd",function(t,s){return s.weekdaysShortRegex(t)});I("dddd",function(t,s){return s.weekdaysRegex(t)});Nt(["dd","ddd","dddd"],function(t,s,r,a){var n=r._locale.weekdaysParse(t,a,r._strict);n!=null?s.d=n:G(r).invalidWeekday=t});Nt(["d","e","E"],function(t,s,r,a){s[a]=Z(t)});function _n(t,s){return typeof t!="string"?t:isNaN(t)?(t=s.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function Nn(t,s){return typeof t=="string"?s.weekdaysParse(t)%7||7:isNaN(t)?null:t}function Es(t,s){return t.slice(s,7).concat(t.slice(0,s))}var kn="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),_r="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Cn="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Pn=_t,Mn=_t,En=_t;function Tn(t,s){var r=De(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(s)?"format":"standalone"];return t===!0?Es(r,this._week.dow):t?r[t.day()]:r}function An(t){return t===!0?Es(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function Dn(t){return t===!0?Es(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function In(t,s,r){var a,n,i,o=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],a=0;a<7;++a)i=Ye([2e3,1]).day(a),this._minWeekdaysParse[a]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[a]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[a]=this.weekdays(i,"").toLocaleLowerCase();return r?s==="dddd"?(n=fe.call(this._weekdaysParse,o),n!==-1?n:null):s==="ddd"?(n=fe.call(this._shortWeekdaysParse,o),n!==-1?n:null):(n=fe.call(this._minWeekdaysParse,o),n!==-1?n:null):s==="dddd"?(n=fe.call(this._weekdaysParse,o),n!==-1||(n=fe.call(this._shortWeekdaysParse,o),n!==-1)?n:(n=fe.call(this._minWeekdaysParse,o),n!==-1?n:null)):s==="ddd"?(n=fe.call(this._shortWeekdaysParse,o),n!==-1||(n=fe.call(this._weekdaysParse,o),n!==-1)?n:(n=fe.call(this._minWeekdaysParse,o),n!==-1?n:null)):(n=fe.call(this._minWeekdaysParse,o),n!==-1||(n=fe.call(this._weekdaysParse,o),n!==-1)?n:(n=fe.call(this._shortWeekdaysParse,o),n!==-1?n:null))}function Un(t,s,r){var a,n,i;if(this._weekdaysParseExact)return In.call(this,t,s,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),a=0;a<7;a++){if(n=Ye([2e3,1]).day(a),r&&!this._fullWeekdaysParse[a]&&(this._fullWeekdaysParse[a]=new RegExp("^"+this.weekdays(n,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[a]=new RegExp("^"+this.weekdaysShort(n,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[a]=new RegExp("^"+this.weekdaysMin(n,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[a]||(i="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[a]=new RegExp(i.replace(".",""),"i")),r&&s==="dddd"&&this._fullWeekdaysParse[a].test(t))return a;if(r&&s==="ddd"&&this._shortWeekdaysParse[a].test(t))return a;if(r&&s==="dd"&&this._minWeekdaysParse[a].test(t))return a;if(!r&&this._weekdaysParse[a].test(t))return a}}function On(t){if(!this.isValid())return t!=null?this:NaN;var s=xt(this,"Day");return t!=null?(t=_n(t,this.localeData()),this.add(t-s,"d")):s}function Rn(t){if(!this.isValid())return t!=null?this:NaN;var s=(this.day()+7-this.localeData()._week.dow)%7;return t==null?s:this.add(t-s,"d")}function Yn(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var s=Nn(t,this.localeData());return this.day(this.day()%7?s:s-7)}else return this.day()||7}function Ln(t){return this._weekdaysParseExact?(ee(this,"_weekdaysRegex")||Ts.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(ee(this,"_weekdaysRegex")||(this._weekdaysRegex=Pn),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function Fn(t){return this._weekdaysParseExact?(ee(this,"_weekdaysRegex")||Ts.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(ee(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Mn),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Wn(t){return this._weekdaysParseExact?(ee(this,"_weekdaysRegex")||Ts.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(ee(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=En),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Ts(){function t(m,v){return v.length-m.length}var s=[],r=[],a=[],n=[],i,o,d,x,y;for(i=0;i<7;i++)o=Ye([2e3,1]).day(i),d=He(this.weekdaysMin(o,"")),x=He(this.weekdaysShort(o,"")),y=He(this.weekdays(o,"")),s.push(d),r.push(x),a.push(y),n.push(d),n.push(x),n.push(y);s.sort(t),r.sort(t),a.sort(t),n.sort(t),this._weekdaysRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+s.join("|")+")","i")}function As(){return this.hours()%12||12}function $n(){return this.hours()||24}L("H",["HH",2],0,"hour");L("h",["hh",2],0,As);L("k",["kk",2],0,$n);L("hmm",0,0,function(){return""+As.apply(this)+Re(this.minutes(),2)});L("hmmss",0,0,function(){return""+As.apply(this)+Re(this.minutes(),2)+Re(this.seconds(),2)});L("Hmm",0,0,function(){return""+this.hours()+Re(this.minutes(),2)});L("Hmmss",0,0,function(){return""+this.hours()+Re(this.minutes(),2)+Re(this.seconds(),2)});function Nr(t,s){L(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),s)})}Nr("a",!0);Nr("A",!1);function kr(t,s){return s._meridiemParse}I("a",kr);I("A",kr);I("H",de,Ps);I("h",de,ht);I("k",de,ht);I("HH",de,Ne);I("hh",de,Ne);I("kk",de,Ne);I("hmm",pr);I("hmmss",fr);I("Hmm",pr);I("Hmmss",fr);ie(["H","HH"],xe);ie(["k","kk"],function(t,s,r){var a=Z(t);s[xe]=a===24?0:a});ie(["a","A"],function(t,s,r){r._isPm=r._locale.isPM(t),r._meridiem=t});ie(["h","hh"],function(t,s,r){s[xe]=Z(t),G(r).bigHour=!0});ie("hmm",function(t,s,r){var a=t.length-2;s[xe]=Z(t.substr(0,a)),s[Ae]=Z(t.substr(a)),G(r).bigHour=!0});ie("hmmss",function(t,s,r){var a=t.length-4,n=t.length-2;s[xe]=Z(t.substr(0,a)),s[Ae]=Z(t.substr(a,2)),s[Be]=Z(t.substr(n)),G(r).bigHour=!0});ie("Hmm",function(t,s,r){var a=t.length-2;s[xe]=Z(t.substr(0,a)),s[Ae]=Z(t.substr(a))});ie("Hmmss",function(t,s,r){var a=t.length-4,n=t.length-2;s[xe]=Z(t.substr(0,a)),s[Ae]=Z(t.substr(a,2)),s[Be]=Z(t.substr(n))});function Bn(t){return(t+"").toLowerCase().charAt(0)==="p"}var Hn=/[ap]\.?m?\.?/i,Vn=ut("Hours",!0);function zn(t,s,r){return t>11?r?"pm":"PM":r?"am":"AM"}var Cr={calendar:Da,longDateFormat:Ra,invalidDate:La,ordinal:Wa,dayOfMonthOrdinalParse:$a,relativeTime:Ha,months:on,monthsShort:yr,week:vn,weekdays:kn,weekdaysMin:Cn,weekdaysShort:_r,meridiemParse:Hn},he={},pt={},jt;function Gn(t,s){var r,a=Math.min(t.length,s.length);for(r=0;r<a;r+=1)if(t[r]!==s[r])return r;return a}function tr(t){return t&&t.toLowerCase().replace("_","-")}function qn(t){for(var s=0,r,a,n,i;s<t.length;){for(i=tr(t[s]).split("-"),r=i.length,a=tr(t[s+1]),a=a?a.split("-"):null;r>0;){if(n=Kt(i.slice(0,r).join("-")),n)return n;if(a&&a.length>=r&&Gn(i,a)>=r-1)break;r--}s++}return jt}function Jn(t){return!!(t&&t.match("^[^/\\\\]*$"))}function Kt(t){var s=null,r;if(he[t]===void 0&&typeof Ot<"u"&&Ot&&Ot.exports&&Jn(t))try{s=jt._abbr,r=require,r("./locale/"+t),Xe(s)}catch{he[t]=null}return he[t]}function Xe(t,s){var r;return t&&(be(s)?r=Ge(t):r=Ds(t,s),r?jt=r:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),jt._abbr}function Ds(t,s){if(s!==null){var r,a=Cr;if(s.abbr=t,he[t]!=null)dr("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),a=he[t]._config;else if(s.parentLocale!=null)if(he[s.parentLocale]!=null)a=he[s.parentLocale]._config;else if(r=Kt(s.parentLocale),r!=null)a=r._config;else return pt[s.parentLocale]||(pt[s.parentLocale]=[]),pt[s.parentLocale].push({name:t,config:s}),null;return he[t]=new bs(ps(a,s)),pt[t]&&pt[t].forEach(function(n){Ds(n.name,n.config)}),Xe(t),he[t]}else return delete he[t],null}function Zn(t,s){if(s!=null){var r,a,n=Cr;he[t]!=null&&he[t].parentLocale!=null?he[t].set(ps(he[t]._config,s)):(a=Kt(t),a!=null&&(n=a._config),s=ps(n,s),a==null&&(s.abbr=t),r=new bs(s),r.parentLocale=he[t],he[t]=r),Xe(t)}else he[t]!=null&&(he[t].parentLocale!=null?(he[t]=he[t].parentLocale,t===Xe()&&Xe(t)):he[t]!=null&&delete he[t]);return he[t]}function Ge(t){var s;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return jt;if(!De(t)){if(s=Kt(t),s)return s;t=[t]}return qn(t)}function Xn(){return fs(he)}function Is(t){var s,r=t._a;return r&&G(t).overflow===-2&&(s=r[$e]<0||r[$e]>11?$e:r[Oe]<1||r[Oe]>Ms(r[we],r[$e])?Oe:r[xe]<0||r[xe]>24||r[xe]===24&&(r[Ae]!==0||r[Be]!==0||r[et]!==0)?xe:r[Ae]<0||r[Ae]>59?Ae:r[Be]<0||r[Be]>59?Be:r[et]<0||r[et]>999?et:-1,G(t)._overflowDayOfYear&&(s<we||s>Oe)&&(s=Oe),G(t)._overflowWeeks&&s===-1&&(s=en),G(t)._overflowWeekday&&s===-1&&(s=tn),G(t).overflow=s),t}var Qn=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Kn=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,ei=/Z|[+-]\d\d(?::?\d\d)?/,At=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],ds=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],ti=/^\/?Date\((-?\d+)/i,si=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,ri={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Pr(t){var s,r,a=t._i,n=Qn.exec(a)||Kn.exec(a),i,o,d,x,y=At.length,m=ds.length;if(n){for(G(t).iso=!0,s=0,r=y;s<r;s++)if(At[s][1].exec(n[1])){o=At[s][0],i=At[s][2]!==!1;break}if(o==null){t._isValid=!1;return}if(n[3]){for(s=0,r=m;s<r;s++)if(ds[s][1].exec(n[3])){d=(n[2]||" ")+ds[s][0];break}if(d==null){t._isValid=!1;return}}if(!i&&d!=null){t._isValid=!1;return}if(n[4])if(ei.exec(n[4]))x="Z";else{t._isValid=!1;return}t._f=o+(d||"")+(x||""),Os(t)}else t._isValid=!1}function ai(t,s,r,a,n,i){var o=[ni(t),yr.indexOf(s),parseInt(r,10),parseInt(a,10),parseInt(n,10)];return i&&o.push(parseInt(i,10)),o}function ni(t){var s=parseInt(t,10);return s<=49?2e3+s:s<=999?1900+s:s}function ii(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function oi(t,s,r){if(t){var a=_r.indexOf(t),n=new Date(s[0],s[1],s[2]).getDay();if(a!==n)return G(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function li(t,s,r){if(t)return ri[t];if(s)return 0;var a=parseInt(r,10),n=a%100,i=(a-n)/100;return i*60+n}function Mr(t){var s=si.exec(ii(t._i)),r;if(s){if(r=ai(s[4],s[3],s[2],s[5],s[6],s[7]),!oi(s[1],r,t))return;t._a=r,t._tzm=li(s[8],s[9],s[10]),t._d=yt.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),G(t).rfc2822=!0}else t._isValid=!1}function ci(t){var s=ti.exec(t._i);if(s!==null){t._d=new Date(+s[1]);return}if(Pr(t),t._isValid===!1)delete t._isValid;else return;if(Mr(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:A.createFromInputFallback(t)}A.createFromInputFallback=Me("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function at(t,s,r){return t??s??r}function di(t){var s=new Date(A.now());return t._useUTC?[s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate()]:[s.getFullYear(),s.getMonth(),s.getDate()]}function Us(t){var s,r,a=[],n,i,o;if(!t._d){for(n=di(t),t._w&&t._a[Oe]==null&&t._a[$e]==null&&hi(t),t._dayOfYear!=null&&(o=at(t._a[we],n[we]),(t._dayOfYear>gt(o)||t._dayOfYear===0)&&(G(t)._overflowDayOfYear=!0),r=yt(o,0,t._dayOfYear),t._a[$e]=r.getUTCMonth(),t._a[Oe]=r.getUTCDate()),s=0;s<3&&t._a[s]==null;++s)t._a[s]=a[s]=n[s];for(;s<7;s++)t._a[s]=a[s]=t._a[s]==null?s===2?1:0:t._a[s];t._a[xe]===24&&t._a[Ae]===0&&t._a[Be]===0&&t._a[et]===0&&(t._nextDay=!0,t._a[xe]=0),t._d=(t._useUTC?yt:xn).apply(null,a),i=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[xe]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==i&&(G(t).weekdayMismatch=!0)}}function hi(t){var s,r,a,n,i,o,d,x,y;s=t._w,s.GG!=null||s.W!=null||s.E!=null?(i=1,o=4,r=at(s.GG,t._a[we],vt(ce(),1,4).year),a=at(s.W,1),n=at(s.E,1),(n<1||n>7)&&(x=!0)):(i=t._locale._week.dow,o=t._locale._week.doy,y=vt(ce(),i,o),r=at(s.gg,t._a[we],y.year),a=at(s.w,y.week),s.d!=null?(n=s.d,(n<0||n>6)&&(x=!0)):s.e!=null?(n=s.e+i,(s.e<0||s.e>6)&&(x=!0)):n=i),a<1||a>Ve(r,i,o)?G(t)._overflowWeeks=!0:x!=null?G(t)._overflowWeekday=!0:(d=br(r,a,n,i,o),t._a[we]=d.year,t._dayOfYear=d.dayOfYear)}A.ISO_8601=function(){};A.RFC_2822=function(){};function Os(t){if(t._f===A.ISO_8601){Pr(t);return}if(t._f===A.RFC_2822){Mr(t);return}t._a=[],G(t).empty=!0;var s=""+t._i,r,a,n,i,o,d=s.length,x=0,y,m;for(n=hr(t._f,t._locale).match(_s)||[],m=n.length,r=0;r<m;r++)i=n[r],a=(s.match(Xa(i,t))||[])[0],a&&(o=s.substr(0,s.indexOf(a)),o.length>0&&G(t).unusedInput.push(o),s=s.slice(s.indexOf(a)+a.length),x+=a.length),it[i]?(a?G(t).empty=!1:G(t).unusedTokens.push(i),Ka(i,a,t)):t._strict&&!a&&G(t).unusedTokens.push(i);G(t).charsLeftOver=d-x,s.length>0&&G(t).unusedInput.push(s),t._a[xe]<=12&&G(t).bigHour===!0&&t._a[xe]>0&&(G(t).bigHour=void 0),G(t).parsedDateParts=t._a.slice(0),G(t).meridiem=t._meridiem,t._a[xe]=ui(t._locale,t._a[xe],t._meridiem),y=G(t).era,y!==null&&(t._a[we]=t._locale.erasConvertYear(y,t._a[we])),Us(t),Is(t)}function ui(t,s,r){var a;return r==null?s:t.meridiemHour!=null?t.meridiemHour(s,r):(t.isPM!=null&&(a=t.isPM(r),a&&s<12&&(s+=12),!a&&s===12&&(s=0)),s)}function mi(t){var s,r,a,n,i,o,d=!1,x=t._f.length;if(x===0){G(t).invalidFormat=!0,t._d=new Date(NaN);return}for(n=0;n<x;n++)i=0,o=!1,s=Ss({},t),t._useUTC!=null&&(s._useUTC=t._useUTC),s._f=t._f[n],Os(s),ws(s)&&(o=!0),i+=G(s).charsLeftOver,i+=G(s).unusedTokens.length*10,G(s).score=i,d?i<a&&(a=i,r=s):(a==null||i<a||o)&&(a=i,r=s,o&&(d=!0));Je(t,r||s)}function pi(t){if(!t._d){var s=Ns(t._i),r=s.day===void 0?s.date:s.day;t._a=lr([s.year,s.month,r,s.hour,s.minute,s.second,s.millisecond],function(a){return a&&parseInt(a,10)}),Us(t)}}function fi(t){var s=new bt(Is(Er(t)));return s._nextDay&&(s.add(1,"d"),s._nextDay=void 0),s}function Er(t){var s=t._i,r=t._f;return t._locale=t._locale||Ge(t._l),s===null||r===void 0&&s===""?zt({nullInput:!0}):(typeof s=="string"&&(t._i=s=t._locale.preparse(s)),Ie(s)?new bt(Is(s)):(St(s)?t._d=s:De(r)?mi(t):r?Os(t):gi(t),ws(t)||(t._d=null),t))}function gi(t){var s=t._i;be(s)?t._d=new Date(A.now()):St(s)?t._d=new Date(s.valueOf()):typeof s=="string"?ci(t):De(s)?(t._a=lr(s.slice(0),function(r){return parseInt(r,10)}),Us(t)):tt(s)?pi(t):ze(s)?t._d=new Date(s):A.createFromInputFallback(t)}function Tr(t,s,r,a,n){var i={};return(s===!0||s===!1)&&(a=s,s=void 0),(r===!0||r===!1)&&(a=r,r=void 0),(tt(t)&&js(t)||De(t)&&t.length===0)&&(t=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=n,i._l=r,i._i=t,i._f=s,i._strict=a,fi(i)}function ce(t,s,r,a){return Tr(t,s,r,a,!1)}var xi=Me("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=ce.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:zt()}),yi=Me("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=ce.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:zt()});function Ar(t,s){var r,a;if(s.length===1&&De(s[0])&&(s=s[0]),!s.length)return ce();for(r=s[0],a=1;a<s.length;++a)(!s[a].isValid()||s[a][t](r))&&(r=s[a]);return r}function vi(){var t=[].slice.call(arguments,0);return Ar("isBefore",t)}function ji(){var t=[].slice.call(arguments,0);return Ar("isAfter",t)}var wi=function(){return Date.now?Date.now():+new Date},ft=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Si(t){var s,r=!1,a,n=ft.length;for(s in t)if(ee(t,s)&&!(fe.call(ft,s)!==-1&&(t[s]==null||!isNaN(t[s]))))return!1;for(a=0;a<n;++a)if(t[ft[a]]){if(r)return!1;parseFloat(t[ft[a]])!==Z(t[ft[a]])&&(r=!0)}return!0}function bi(){return this._isValid}function _i(){return Ue(NaN)}function es(t){var s=Ns(t),r=s.year||0,a=s.quarter||0,n=s.month||0,i=s.week||s.isoWeek||0,o=s.day||0,d=s.hour||0,x=s.minute||0,y=s.second||0,m=s.millisecond||0;this._isValid=Si(s),this._milliseconds=+m+y*1e3+x*6e4+d*1e3*60*60,this._days=+o+i*7,this._months=+n+a*3+r*12,this._data={},this._locale=Ge(),this._bubble()}function It(t){return t instanceof es}function xs(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function Ni(t,s,r){var a=Math.min(t.length,s.length),n=Math.abs(t.length-s.length),i=0,o;for(o=0;o<a;o++)(r&&t[o]!==s[o]||!r&&Z(t[o])!==Z(s[o]))&&i++;return i+n}function Dr(t,s){L(t,0,0,function(){var r=this.utcOffset(),a="+";return r<0&&(r=-r,a="-"),a+Re(~~(r/60),2)+s+Re(~~r%60,2)})}Dr("Z",":");Dr("ZZ","");I("Z",Xt);I("ZZ",Xt);ie(["Z","ZZ"],function(t,s,r){r._useUTC=!0,r._tzm=Rs(Xt,t)});var ki=/([\+\-]|\d\d)/gi;function Rs(t,s){var r=(s||"").match(t),a,n,i;return r===null?null:(a=r[r.length-1]||[],n=(a+"").match(ki)||["-",0,0],i=+(n[1]*60)+Z(n[2]),i===0?0:n[0]==="+"?i:-i)}function Ys(t,s){var r,a;return s._isUTC?(r=s.clone(),a=(Ie(t)||St(t)?t.valueOf():ce(t).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+a),A.updateOffset(r,!1),r):ce(t).local()}function ys(t){return-Math.round(t._d.getTimezoneOffset())}A.updateOffset=function(){};function Ci(t,s,r){var a=this._offset||0,n;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=Rs(Xt,t),t===null)return this}else Math.abs(t)<16&&!r&&(t=t*60);return!this._isUTC&&s&&(n=ys(this)),this._offset=t,this._isUTC=!0,n!=null&&this.add(n,"m"),a!==t&&(!s||this._changeInProgress?Or(this,Ue(t-a,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,A.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?a:ys(this)}function Pi(t,s){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,s),this):-this.utcOffset()}function Mi(t){return this.utcOffset(0,t)}function Ei(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(ys(this),"m")),this}function Ti(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=Rs(Ja,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function Ai(t){return this.isValid()?(t=t?ce(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function Di(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Ii(){if(!be(this._isDSTShifted))return this._isDSTShifted;var t={},s;return Ss(t,this),t=Er(t),t._a?(s=t._isUTC?Ye(t._a):ce(t._a),this._isDSTShifted=this.isValid()&&Ni(t._a,s.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Ui(){return this.isValid()?!this._isUTC:!1}function Oi(){return this.isValid()?this._isUTC:!1}function Ir(){return this.isValid()?this._isUTC&&this._offset===0:!1}var Ri=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Yi=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Ue(t,s){var r=t,a=null,n,i,o;return It(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:ze(t)||!isNaN(+t)?(r={},s?r[s]=+t:r.milliseconds=+t):(a=Ri.exec(t))?(n=a[1]==="-"?-1:1,r={y:0,d:Z(a[Oe])*n,h:Z(a[xe])*n,m:Z(a[Ae])*n,s:Z(a[Be])*n,ms:Z(xs(a[et]*1e3))*n}):(a=Yi.exec(t))?(n=a[1]==="-"?-1:1,r={y:Ke(a[2],n),M:Ke(a[3],n),w:Ke(a[4],n),d:Ke(a[5],n),h:Ke(a[6],n),m:Ke(a[7],n),s:Ke(a[8],n)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(o=Li(ce(r.from),ce(r.to)),r={},r.ms=o.milliseconds,r.M=o.months),i=new es(r),It(t)&&ee(t,"_locale")&&(i._locale=t._locale),It(t)&&ee(t,"_isValid")&&(i._isValid=t._isValid),i}Ue.fn=es.prototype;Ue.invalid=_i;function Ke(t,s){var r=t&&parseFloat(t.replace(",","."));return(isNaN(r)?0:r)*s}function sr(t,s){var r={};return r.months=s.month()-t.month()+(s.year()-t.year())*12,t.clone().add(r.months,"M").isAfter(s)&&--r.months,r.milliseconds=+s-+t.clone().add(r.months,"M"),r}function Li(t,s){var r;return t.isValid()&&s.isValid()?(s=Ys(s,t),t.isBefore(s)?r=sr(t,s):(r=sr(s,t),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function Ur(t,s){return function(r,a){var n,i;return a!==null&&!isNaN(+a)&&(dr(s,"moment()."+s+"(period, number) is deprecated. Please use moment()."+s+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=r,r=a,a=i),n=Ue(r,a),Or(this,n,t),this}}function Or(t,s,r,a){var n=s._milliseconds,i=xs(s._days),o=xs(s._months);t.isValid()&&(a=a??!0,o&&jr(t,xt(t,"Month")+o*r),i&&xr(t,"Date",xt(t,"Date")+i*r),n&&t._d.setTime(t._d.valueOf()+n*r),a&&A.updateOffset(t,i||o))}var Fi=Ur(1,"add"),Wi=Ur(-1,"subtract");function Rr(t){return typeof t=="string"||t instanceof String}function $i(t){return Ie(t)||St(t)||Rr(t)||ze(t)||Hi(t)||Bi(t)||t===null||t===void 0}function Bi(t){var s=tt(t)&&!js(t),r=!1,a=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],n,i,o=a.length;for(n=0;n<o;n+=1)i=a[n],r=r||ee(t,i);return s&&r}function Hi(t){var s=De(t),r=!1;return s&&(r=t.filter(function(a){return!ze(a)&&Rr(t)}).length===0),s&&r}function Vi(t){var s=tt(t)&&!js(t),r=!1,a=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],n,i;for(n=0;n<a.length;n+=1)i=a[n],r=r||ee(t,i);return s&&r}function zi(t,s){var r=t.diff(s,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function Gi(t,s){arguments.length===1&&(arguments[0]?$i(arguments[0])?(t=arguments[0],s=void 0):Vi(arguments[0])&&(s=arguments[0],t=void 0):(t=void 0,s=void 0));var r=t||ce(),a=Ys(r,this).startOf("day"),n=A.calendarFormat(this,a)||"sameElse",i=s&&(Le(s[n])?s[n].call(this,r):s[n]);return this.format(i||this.localeData().calendar(n,this,ce(r)))}function qi(){return new bt(this)}function Ji(t,s){var r=Ie(t)?t:ce(t);return this.isValid()&&r.isValid()?(s=Ee(s)||"millisecond",s==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(s).valueOf()):!1}function Zi(t,s){var r=Ie(t)?t:ce(t);return this.isValid()&&r.isValid()?(s=Ee(s)||"millisecond",s==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(s).valueOf()<r.valueOf()):!1}function Xi(t,s,r,a){var n=Ie(t)?t:ce(t),i=Ie(s)?s:ce(s);return this.isValid()&&n.isValid()&&i.isValid()?(a=a||"()",(a[0]==="("?this.isAfter(n,r):!this.isBefore(n,r))&&(a[1]===")"?this.isBefore(i,r):!this.isAfter(i,r))):!1}function Qi(t,s){var r=Ie(t)?t:ce(t),a;return this.isValid()&&r.isValid()?(s=Ee(s)||"millisecond",s==="millisecond"?this.valueOf()===r.valueOf():(a=r.valueOf(),this.clone().startOf(s).valueOf()<=a&&a<=this.clone().endOf(s).valueOf())):!1}function Ki(t,s){return this.isSame(t,s)||this.isAfter(t,s)}function eo(t,s){return this.isSame(t,s)||this.isBefore(t,s)}function to(t,s,r){var a,n,i;if(!this.isValid())return NaN;if(a=Ys(t,this),!a.isValid())return NaN;switch(n=(a.utcOffset()-this.utcOffset())*6e4,s=Ee(s),s){case"year":i=Ut(this,a)/12;break;case"month":i=Ut(this,a);break;case"quarter":i=Ut(this,a)/3;break;case"second":i=(this-a)/1e3;break;case"minute":i=(this-a)/6e4;break;case"hour":i=(this-a)/36e5;break;case"day":i=(this-a-n)/864e5;break;case"week":i=(this-a-n)/6048e5;break;default:i=this-a}return r?i:Ce(i)}function Ut(t,s){if(t.date()<s.date())return-Ut(s,t);var r=(s.year()-t.year())*12+(s.month()-t.month()),a=t.clone().add(r,"months"),n,i;return s-a<0?(n=t.clone().add(r-1,"months"),i=(s-a)/(a-n)):(n=t.clone().add(r+1,"months"),i=(s-a)/(n-a)),-(r+i)||0}A.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";A.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function so(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function ro(t){if(!this.isValid())return null;var s=t!==!0,r=s?this.clone().utc():this;return r.year()<0||r.year()>9999?Dt(r,s?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Le(Date.prototype.toISOString)?s?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Dt(r,"Z")):Dt(r,s?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function ao(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",s="",r,a,n,i;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",s="Z"),r="["+t+'("]',a=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",n="-MM-DD[T]HH:mm:ss.SSS",i=s+'[")]',this.format(r+a+n+i)}function no(t){t||(t=this.isUtc()?A.defaultFormatUtc:A.defaultFormat);var s=Dt(this,t);return this.localeData().postformat(s)}function io(t,s){return this.isValid()&&(Ie(t)&&t.isValid()||ce(t).isValid())?Ue({to:this,from:t}).locale(this.locale()).humanize(!s):this.localeData().invalidDate()}function oo(t){return this.from(ce(),t)}function lo(t,s){return this.isValid()&&(Ie(t)&&t.isValid()||ce(t).isValid())?Ue({from:this,to:t}).locale(this.locale()).humanize(!s):this.localeData().invalidDate()}function co(t){return this.to(ce(),t)}function Yr(t){var s;return t===void 0?this._locale._abbr:(s=Ge(t),s!=null&&(this._locale=s),this)}var Lr=Me("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function Fr(){return this._locale}var Lt=1e3,ot=60*Lt,Ft=60*ot,Wr=(365*400+97)*24*Ft;function lt(t,s){return(t%s+s)%s}function $r(t,s,r){return t<100&&t>=0?new Date(t+400,s,r)-Wr:new Date(t,s,r).valueOf()}function Br(t,s,r){return t<100&&t>=0?Date.UTC(t+400,s,r)-Wr:Date.UTC(t,s,r)}function ho(t){var s,r;if(t=Ee(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?Br:$r,t){case"year":s=r(this.year(),0,1);break;case"quarter":s=r(this.year(),this.month()-this.month()%3,1);break;case"month":s=r(this.year(),this.month(),1);break;case"week":s=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":s=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":s=r(this.year(),this.month(),this.date());break;case"hour":s=this._d.valueOf(),s-=lt(s+(this._isUTC?0:this.utcOffset()*ot),Ft);break;case"minute":s=this._d.valueOf(),s-=lt(s,ot);break;case"second":s=this._d.valueOf(),s-=lt(s,Lt);break}return this._d.setTime(s),A.updateOffset(this,!0),this}function uo(t){var s,r;if(t=Ee(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?Br:$r,t){case"year":s=r(this.year()+1,0,1)-1;break;case"quarter":s=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":s=r(this.year(),this.month()+1,1)-1;break;case"week":s=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":s=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":s=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":s=this._d.valueOf(),s+=Ft-lt(s+(this._isUTC?0:this.utcOffset()*ot),Ft)-1;break;case"minute":s=this._d.valueOf(),s+=ot-lt(s,ot)-1;break;case"second":s=this._d.valueOf(),s+=Lt-lt(s,Lt)-1;break}return this._d.setTime(s),A.updateOffset(this,!0),this}function mo(){return this._d.valueOf()-(this._offset||0)*6e4}function po(){return Math.floor(this.valueOf()/1e3)}function fo(){return new Date(this.valueOf())}function go(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function xo(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function yo(){return this.isValid()?this.toISOString():null}function vo(){return ws(this)}function jo(){return Je({},G(this))}function wo(){return G(this).overflow}function So(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}L("N",0,0,"eraAbbr");L("NN",0,0,"eraAbbr");L("NNN",0,0,"eraAbbr");L("NNNN",0,0,"eraName");L("NNNNN",0,0,"eraNarrow");L("y",["y",1],"yo","eraYear");L("y",["yy",2],0,"eraYear");L("y",["yyy",3],0,"eraYear");L("y",["yyyy",4],0,"eraYear");I("N",Ls);I("NN",Ls);I("NNN",Ls);I("NNNN",Do);I("NNNNN",Io);ie(["N","NN","NNN","NNNN","NNNNN"],function(t,s,r,a){var n=r._locale.erasParse(t,a,r._strict);n?G(r).era=n:G(r).invalidEra=t});I("y",dt);I("yy",dt);I("yyy",dt);I("yyyy",dt);I("yo",Uo);ie(["y","yy","yyy","yyyy"],we);ie(["yo"],function(t,s,r,a){var n;r._locale._eraYearOrdinalRegex&&(n=t.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?s[we]=r._locale.eraYearOrdinalParse(t,n):s[we]=parseInt(t,10)});function bo(t,s){var r,a,n,i=this._eras||Ge("en")._eras;for(r=0,a=i.length;r<a;++r){switch(typeof i[r].since){case"string":n=A(i[r].since).startOf("day"),i[r].since=n.valueOf();break}switch(typeof i[r].until){case"undefined":i[r].until=1/0;break;case"string":n=A(i[r].until).startOf("day").valueOf(),i[r].until=n.valueOf();break}}return i}function _o(t,s,r){var a,n,i=this.eras(),o,d,x;for(t=t.toUpperCase(),a=0,n=i.length;a<n;++a)if(o=i[a].name.toUpperCase(),d=i[a].abbr.toUpperCase(),x=i[a].narrow.toUpperCase(),r)switch(s){case"N":case"NN":case"NNN":if(d===t)return i[a];break;case"NNNN":if(o===t)return i[a];break;case"NNNNN":if(x===t)return i[a];break}else if([o,d,x].indexOf(t)>=0)return i[a]}function No(t,s){var r=t.since<=t.until?1:-1;return s===void 0?A(t.since).year():A(t.since).year()+(s-t.offset)*r}function ko(){var t,s,r,a=this.localeData().eras();for(t=0,s=a.length;t<s;++t)if(r=this.clone().startOf("day").valueOf(),a[t].since<=r&&r<=a[t].until||a[t].until<=r&&r<=a[t].since)return a[t].name;return""}function Co(){var t,s,r,a=this.localeData().eras();for(t=0,s=a.length;t<s;++t)if(r=this.clone().startOf("day").valueOf(),a[t].since<=r&&r<=a[t].until||a[t].until<=r&&r<=a[t].since)return a[t].narrow;return""}function Po(){var t,s,r,a=this.localeData().eras();for(t=0,s=a.length;t<s;++t)if(r=this.clone().startOf("day").valueOf(),a[t].since<=r&&r<=a[t].until||a[t].until<=r&&r<=a[t].since)return a[t].abbr;return""}function Mo(){var t,s,r,a,n=this.localeData().eras();for(t=0,s=n.length;t<s;++t)if(r=n[t].since<=n[t].until?1:-1,a=this.clone().startOf("day").valueOf(),n[t].since<=a&&a<=n[t].until||n[t].until<=a&&a<=n[t].since)return(this.year()-A(n[t].since).year())*r+n[t].offset;return this.year()}function Eo(t){return ee(this,"_erasNameRegex")||Fs.call(this),t?this._erasNameRegex:this._erasRegex}function To(t){return ee(this,"_erasAbbrRegex")||Fs.call(this),t?this._erasAbbrRegex:this._erasRegex}function Ao(t){return ee(this,"_erasNarrowRegex")||Fs.call(this),t?this._erasNarrowRegex:this._erasRegex}function Ls(t,s){return s.erasAbbrRegex(t)}function Do(t,s){return s.erasNameRegex(t)}function Io(t,s){return s.erasNarrowRegex(t)}function Uo(t,s){return s._eraYearOrdinalRegex||dt}function Fs(){var t=[],s=[],r=[],a=[],n,i,o,d,x,y=this.eras();for(n=0,i=y.length;n<i;++n)o=He(y[n].name),d=He(y[n].abbr),x=He(y[n].narrow),s.push(o),t.push(d),r.push(x),a.push(o),a.push(d),a.push(x);this._erasRegex=new RegExp("^("+a.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+s.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}L(0,["gg",2],0,function(){return this.weekYear()%100});L(0,["GG",2],0,function(){return this.isoWeekYear()%100});function ts(t,s){L(0,[t,t.length],0,s)}ts("gggg","weekYear");ts("ggggg","weekYear");ts("GGGG","isoWeekYear");ts("GGGGG","isoWeekYear");I("G",Zt);I("g",Zt);I("GG",de,Ne);I("gg",de,Ne);I("GGGG",Cs,ks);I("gggg",Cs,ks);I("GGGGG",Jt,Gt);I("ggggg",Jt,Gt);Nt(["gggg","ggggg","GGGG","GGGGG"],function(t,s,r,a){s[a.substr(0,2)]=Z(t)});Nt(["gg","GG"],function(t,s,r,a){s[a]=A.parseTwoDigitYear(t)});function Oo(t){return Hr.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function Ro(t){return Hr.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function Yo(){return Ve(this.year(),1,4)}function Lo(){return Ve(this.isoWeekYear(),1,4)}function Fo(){var t=this.localeData()._week;return Ve(this.year(),t.dow,t.doy)}function Wo(){var t=this.localeData()._week;return Ve(this.weekYear(),t.dow,t.doy)}function Hr(t,s,r,a,n){var i;return t==null?vt(this,a,n).year:(i=Ve(t,a,n),s>i&&(s=i),$o.call(this,t,s,r,a,n))}function $o(t,s,r,a,n){var i=br(t,s,r,a,n),o=yt(i.year,0,i.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}L("Q",0,"Qo","quarter");I("Q",ur);ie("Q",function(t,s){s[$e]=(Z(t)-1)*3});function Bo(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}L("D",["DD",2],"Do","date");I("D",de,ht);I("DD",de,Ne);I("Do",function(t,s){return t?s._dayOfMonthOrdinalParse||s._ordinalParse:s._dayOfMonthOrdinalParseLenient});ie(["D","DD"],Oe);ie("Do",function(t,s){s[Oe]=Z(t.match(de)[0])});var Vr=ut("Date",!0);L("DDD",["DDDD",3],"DDDo","dayOfYear");I("DDD",qt);I("DDDD",mr);ie(["DDD","DDDD"],function(t,s,r){r._dayOfYear=Z(t)});function Ho(t){var s=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?s:this.add(t-s,"d")}L("m",["mm",2],0,"minute");I("m",de,Ps);I("mm",de,Ne);ie(["m","mm"],Ae);var Vo=ut("Minutes",!1);L("s",["ss",2],0,"second");I("s",de,Ps);I("ss",de,Ne);ie(["s","ss"],Be);var zo=ut("Seconds",!1);L("S",0,0,function(){return~~(this.millisecond()/100)});L(0,["SS",2],0,function(){return~~(this.millisecond()/10)});L(0,["SSS",3],0,"millisecond");L(0,["SSSS",4],0,function(){return this.millisecond()*10});L(0,["SSSSS",5],0,function(){return this.millisecond()*100});L(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});L(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});L(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});L(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});I("S",qt,ur);I("SS",qt,Ne);I("SSS",qt,mr);var Ze,zr;for(Ze="SSSS";Ze.length<=9;Ze+="S")I(Ze,dt);function Go(t,s){s[et]=Z(("0."+t)*1e3)}for(Ze="S";Ze.length<=9;Ze+="S")ie(Ze,Go);zr=ut("Milliseconds",!1);L("z",0,0,"zoneAbbr");L("zz",0,0,"zoneName");function qo(){return this._isUTC?"UTC":""}function Jo(){return this._isUTC?"Coordinated Universal Time":""}var N=bt.prototype;N.add=Fi;N.calendar=Gi;N.clone=qi;N.diff=to;N.endOf=uo;N.format=no;N.from=io;N.fromNow=oo;N.to=lo;N.toNow=co;N.get=rn;N.invalidAt=wo;N.isAfter=Ji;N.isBefore=Zi;N.isBetween=Xi;N.isSame=Qi;N.isSameOrAfter=Ki;N.isSameOrBefore=eo;N.isValid=vo;N.lang=Lr;N.locale=Yr;N.localeData=Fr;N.max=yi;N.min=xi;N.parsingFlags=jo;N.set=an;N.startOf=ho;N.subtract=Wi;N.toArray=go;N.toObject=xo;N.toDate=fo;N.toISOString=ro;N.inspect=ao;typeof Symbol<"u"&&Symbol.for!=null&&(N[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});N.toJSON=yo;N.toString=so;N.unix=po;N.valueOf=mo;N.creationData=So;N.eraName=ko;N.eraNarrow=Co;N.eraAbbr=Po;N.eraYear=Mo;N.year=gr;N.isLeapYear=sn;N.weekYear=Oo;N.isoWeekYear=Ro;N.quarter=N.quarters=Bo;N.month=wr;N.daysInMonth=pn;N.week=N.weeks=Sn;N.isoWeek=N.isoWeeks=bn;N.weeksInYear=Fo;N.weeksInWeekYear=Wo;N.isoWeeksInYear=Yo;N.isoWeeksInISOWeekYear=Lo;N.date=Vr;N.day=N.days=On;N.weekday=Rn;N.isoWeekday=Yn;N.dayOfYear=Ho;N.hour=N.hours=Vn;N.minute=N.minutes=Vo;N.second=N.seconds=zo;N.millisecond=N.milliseconds=zr;N.utcOffset=Ci;N.utc=Mi;N.local=Ei;N.parseZone=Ti;N.hasAlignedHourOffset=Ai;N.isDST=Di;N.isLocal=Ui;N.isUtcOffset=Oi;N.isUtc=Ir;N.isUTC=Ir;N.zoneAbbr=qo;N.zoneName=Jo;N.dates=Me("dates accessor is deprecated. Use date instead.",Vr);N.months=Me("months accessor is deprecated. Use month instead",wr);N.years=Me("years accessor is deprecated. Use year instead",gr);N.zone=Me("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Pi);N.isDSTShifted=Me("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Ii);function Zo(t){return ce(t*1e3)}function Xo(){return ce.apply(null,arguments).parseZone()}function Gr(t){return t}var te=bs.prototype;te.calendar=Ia;te.longDateFormat=Ya;te.invalidDate=Fa;te.ordinal=Ba;te.preparse=Gr;te.postformat=Gr;te.relativeTime=Va;te.pastFuture=za;te.set=Aa;te.eras=bo;te.erasParse=_o;te.erasConvertYear=No;te.erasAbbrRegex=To;te.erasNameRegex=Eo;te.erasNarrowRegex=Ao;te.months=dn;te.monthsShort=hn;te.monthsParse=mn;te.monthsRegex=gn;te.monthsShortRegex=fn;te.week=yn;te.firstDayOfYear=wn;te.firstDayOfWeek=jn;te.weekdays=Tn;te.weekdaysMin=Dn;te.weekdaysShort=An;te.weekdaysParse=Un;te.weekdaysRegex=Ln;te.weekdaysShortRegex=Fn;te.weekdaysMinRegex=Wn;te.isPM=Bn;te.meridiem=zn;function Wt(t,s,r,a){var n=Ge(),i=Ye().set(a,s);return n[r](i,t)}function qr(t,s,r){if(ze(t)&&(s=t,t=void 0),t=t||"",s!=null)return Wt(t,s,r,"month");var a,n=[];for(a=0;a<12;a++)n[a]=Wt(t,a,r,"month");return n}function Ws(t,s,r,a){typeof t=="boolean"?(ze(s)&&(r=s,s=void 0),s=s||""):(s=t,r=s,t=!1,ze(s)&&(r=s,s=void 0),s=s||"");var n=Ge(),i=t?n._week.dow:0,o,d=[];if(r!=null)return Wt(s,(r+i)%7,a,"day");for(o=0;o<7;o++)d[o]=Wt(s,(o+i)%7,a,"day");return d}function Qo(t,s){return qr(t,s,"months")}function Ko(t,s){return qr(t,s,"monthsShort")}function el(t,s,r){return Ws(t,s,r,"weekdays")}function tl(t,s,r){return Ws(t,s,r,"weekdaysShort")}function sl(t,s,r){return Ws(t,s,r,"weekdaysMin")}Xe("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var s=t%10,r=Z(t%100/10)===1?"th":s===1?"st":s===2?"nd":s===3?"rd":"th";return t+r}});A.lang=Me("moment.lang is deprecated. Use moment.locale instead.",Xe);A.langData=Me("moment.langData is deprecated. Use moment.localeData instead.",Ge);var Fe=Math.abs;function rl(){var t=this._data;return this._milliseconds=Fe(this._milliseconds),this._days=Fe(this._days),this._months=Fe(this._months),t.milliseconds=Fe(t.milliseconds),t.seconds=Fe(t.seconds),t.minutes=Fe(t.minutes),t.hours=Fe(t.hours),t.months=Fe(t.months),t.years=Fe(t.years),this}function Jr(t,s,r,a){var n=Ue(s,r);return t._milliseconds+=a*n._milliseconds,t._days+=a*n._days,t._months+=a*n._months,t._bubble()}function al(t,s){return Jr(this,t,s,1)}function nl(t,s){return Jr(this,t,s,-1)}function rr(t){return t<0?Math.floor(t):Math.ceil(t)}function il(){var t=this._milliseconds,s=this._days,r=this._months,a=this._data,n,i,o,d,x;return t>=0&&s>=0&&r>=0||t<=0&&s<=0&&r<=0||(t+=rr(vs(r)+s)*864e5,s=0,r=0),a.milliseconds=t%1e3,n=Ce(t/1e3),a.seconds=n%60,i=Ce(n/60),a.minutes=i%60,o=Ce(i/60),a.hours=o%24,s+=Ce(o/24),x=Ce(Zr(s)),r+=x,s-=rr(vs(x)),d=Ce(r/12),r%=12,a.days=s,a.months=r,a.years=d,this}function Zr(t){return t*4800/146097}function vs(t){return t*146097/4800}function ol(t){if(!this.isValid())return NaN;var s,r,a=this._milliseconds;if(t=Ee(t),t==="month"||t==="quarter"||t==="year")switch(s=this._days+a/864e5,r=this._months+Zr(s),t){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(s=this._days+Math.round(vs(this._months)),t){case"week":return s/7+a/6048e5;case"day":return s+a/864e5;case"hour":return s*24+a/36e5;case"minute":return s*1440+a/6e4;case"second":return s*86400+a/1e3;case"millisecond":return Math.floor(s*864e5)+a;default:throw new Error("Unknown unit "+t)}}function qe(t){return function(){return this.as(t)}}var Xr=qe("ms"),ll=qe("s"),cl=qe("m"),dl=qe("h"),hl=qe("d"),ul=qe("w"),ml=qe("M"),pl=qe("Q"),fl=qe("y"),gl=Xr;function xl(){return Ue(this)}function yl(t){return t=Ee(t),this.isValid()?this[t+"s"]():NaN}function st(t){return function(){return this.isValid()?this._data[t]:NaN}}var vl=st("milliseconds"),jl=st("seconds"),wl=st("minutes"),Sl=st("hours"),bl=st("days"),_l=st("months"),Nl=st("years");function kl(){return Ce(this.days()/7)}var We=Math.round,nt={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function Cl(t,s,r,a,n){return n.relativeTime(s||1,!!r,t,a)}function Pl(t,s,r,a){var n=Ue(t).abs(),i=We(n.as("s")),o=We(n.as("m")),d=We(n.as("h")),x=We(n.as("d")),y=We(n.as("M")),m=We(n.as("w")),v=We(n.as("y")),u=i<=r.ss&&["s",i]||i<r.s&&["ss",i]||o<=1&&["m"]||o<r.m&&["mm",o]||d<=1&&["h"]||d<r.h&&["hh",d]||x<=1&&["d"]||x<r.d&&["dd",x];return r.w!=null&&(u=u||m<=1&&["w"]||m<r.w&&["ww",m]),u=u||y<=1&&["M"]||y<r.M&&["MM",y]||v<=1&&["y"]||["yy",v],u[2]=s,u[3]=+t>0,u[4]=a,Cl.apply(null,u)}function Ml(t){return t===void 0?We:typeof t=="function"?(We=t,!0):!1}function El(t,s){return nt[t]===void 0?!1:s===void 0?nt[t]:(nt[t]=s,t==="s"&&(nt.ss=s-1),!0)}function Tl(t,s){if(!this.isValid())return this.localeData().invalidDate();var r=!1,a=nt,n,i;return typeof t=="object"&&(s=t,t=!1),typeof t=="boolean"&&(r=t),typeof s=="object"&&(a=Object.assign({},nt,s),s.s!=null&&s.ss==null&&(a.ss=s.s-1)),n=this.localeData(),i=Pl(this,!r,a,n),r&&(i=n.pastFuture(+this,i)),n.postformat(i)}var hs=Math.abs;function rt(t){return(t>0)-(t<0)||+t}function ss(){if(!this.isValid())return this.localeData().invalidDate();var t=hs(this._milliseconds)/1e3,s=hs(this._days),r=hs(this._months),a,n,i,o,d=this.asSeconds(),x,y,m,v;return d?(a=Ce(t/60),n=Ce(a/60),t%=60,a%=60,i=Ce(r/12),r%=12,o=t?t.toFixed(3).replace(/\.?0+$/,""):"",x=d<0?"-":"",y=rt(this._months)!==rt(d)?"-":"",m=rt(this._days)!==rt(d)?"-":"",v=rt(this._milliseconds)!==rt(d)?"-":"",x+"P"+(i?y+i+"Y":"")+(r?y+r+"M":"")+(s?m+s+"D":"")+(n||a||t?"T":"")+(n?v+n+"H":"")+(a?v+a+"M":"")+(t?v+o+"S":"")):"P0D"}var K=es.prototype;K.isValid=bi;K.abs=rl;K.add=al;K.subtract=nl;K.as=ol;K.asMilliseconds=Xr;K.asSeconds=ll;K.asMinutes=cl;K.asHours=dl;K.asDays=hl;K.asWeeks=ul;K.asMonths=ml;K.asQuarters=pl;K.asYears=fl;K.valueOf=gl;K._bubble=il;K.clone=xl;K.get=yl;K.milliseconds=vl;K.seconds=jl;K.minutes=wl;K.hours=Sl;K.days=bl;K.weeks=kl;K.months=_l;K.years=Nl;K.humanize=Tl;K.toISOString=ss;K.toString=ss;K.toJSON=ss;K.locale=Yr;K.localeData=Fr;K.toIsoString=Me("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",ss);K.lang=Lr;L("X",0,0,"unix");L("x",0,0,"valueOf");I("x",Zt);I("X",Za);ie("X",function(t,s,r){r._d=new Date(parseFloat(t)*1e3)});ie("x",function(t,s,r){r._d=new Date(Z(t))});//! moment.js
A.version="2.30.1";Ea(ce);A.fn=N;A.min=vi;A.max=ji;A.now=wi;A.utc=Ye;A.unix=Zo;A.months=Qo;A.isDate=St;A.locale=Xe;A.invalid=zt;A.duration=Ue;A.isMoment=Ie;A.weekdays=el;A.parseZone=Xo;A.localeData=Ge;A.isDuration=It;A.monthsShort=Ko;A.weekdaysMin=sl;A.defineLocale=Ds;A.updateLocale=Zn;A.locales=Xn;A.weekdaysShort=tl;A.normalizeUnits=Ee;A.relativeTimeRounding=Ml;A.relativeTimeThreshold=El;A.calendarFormat=zi;A.prototype=N;A.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const Al=({videos:t})=>{const s=je();return e.jsx("div",{className:"feed",children:t.map(r=>e.jsxs("div",{className:"card",style:{cursor:"pointer"},onClick:()=>{console.log("Clicked item:",r),s(`/video/${r.categoryId||0}/${r.id}`)},children:[e.jsx("img",{src:r.thumbnail||"https://via.placeholder.com/320x180?text=No+Thumbnail",alt:""}),e.jsx("h2",{children:r.title}),e.jsx("h3",{children:r.channelTitle||"Creator"}),e.jsxs("p",{children:[Ma(r.viewCount||0)," Views • "," "+A(r.created_at).fromNow()]})]},r.id))})},Dl=ve.SUPABASE_URL,Il=ve.SUPABASE_ANON_KEY,M=fa(Dl,Il,{auth:{redirectTo:window.location.origin}});typeof window<"u"&&(window.supabase=M,window.__SUPABASE__=M);console.log("VITE ENV:",{VITE_API_BASE_URL:"https://screenmerch.onrender.com",VITE_SUPABASE_URL:"https://sojxbydpcdcdzfdtbypd.supabase.co",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNvanhieWRwY2RjZHpmZHRieXBkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4NTIwNTUsImV4cCI6MjA2NTQyODA1NX0.BUm9LKbNs-EdJKxwwtoY3IRyokmDtRbS0XP-WBw-5no",VITE_API_URL:"https://screenmerch.onrender.com",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1});const Ul=({sidebar:t,category:s,selectedCategory:r,setSelectedCategory:a})=>{const[n,i]=l.useState([]),[o,d]=l.useState(!0),[x,y]=l.useState("");return je(),l.useEffect(()=>{(async()=>{d(!0),y("");let v=M.from("videos2").select("*").order("created_at",{ascending:!1});s&&s!=="All"&&(v=v.eq("category",s));let{data:u,error:g}=await v;g?(y("Failed to fetch videos."),i([])):i(u||[]),d(!1)})()},[s]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:`container ${t?"":" large-container"}`,children:[e.jsx("div",{className:"user-flow-section",children:e.jsxs("div",{className:"flow-steps",children:[e.jsxs("div",{className:"flow-step",children:[e.jsx("div",{className:"step-number",children:"1"}),e.jsxs("div",{className:"step-content",children:[e.jsx("h3",{children:"Choose Video"}),e.jsx("p",{children:"Browse and select your favorite video content"})]})]}),e.jsx("div",{className:"flow-arrow",children:"→"}),e.jsxs("div",{className:"flow-step",children:[e.jsx("div",{className:"step-number",children:"2"}),e.jsxs("div",{className:"step-content",children:[e.jsx("h3",{children:"Select Screenshot"}),e.jsx("p",{children:"Select the perfect moment to capture"})]})]}),e.jsx("div",{className:"flow-arrow",children:"→"}),e.jsxs("div",{className:"flow-step",children:[e.jsx("div",{className:"step-number",children:"3"}),e.jsxs("div",{className:"step-content",children:[e.jsx("h3",{children:"Make Merchandise"}),e.jsx("p",{children:"Create custom products with your screenshot"})]})]})]})}),o&&e.jsx("div",{style:{padding:24},children:"Loading videos..."}),x&&e.jsx("div",{style:{padding:24,color:"red"},children:x}),!o&&!x&&n.length>0&&e.jsx(Al,{videos:n})]})})},$s=({isOpen:t,onClose:s,onSuccess:r})=>{const[a,n]=l.useState(!0),[i,o]=l.useState(""),[d,x]=l.useState(""),[y,m]=l.useState(!1),[v,u]=l.useState(""),g=async k=>{k.preventDefault(),m(!0),u("");try{const T=a?"/api/auth/login":"/api/auth/signup",W=`${ve.BASE_URL}${T}`;console.log("Attempting auth request to:",W),console.log("Mode:",a?"login":"signup"),console.log("Email:",i.trim());const D=await fetch(W,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({email:i.trim(),password:d})});if(console.log("Response status:",D.status),console.log("Response headers:",Object.fromEntries(D.headers.entries())),!D.ok){const E=await D.text();throw console.error("Server error response:",E),new Error(`Server error: ${D.status} - ${E}`)}const $=await D.json();console.log("Response data:",$),$.success?(localStorage.setItem("user_authenticated","true"),localStorage.setItem("user_email",i.trim()),console.log("🔐 Auth success - storing auth state"),console.log("📱 Is Mobile:",window.innerWidth<=768),u({type:"success",text:$.message}),setTimeout(()=>{console.log("🚀 Calling onSuccess callback"),r(),s()},1500)):u({type:"error",text:$.error||"Authentication failed"})}catch(T){console.error("Auth error:",T),u({type:"error",text:`Network error: ${T.message}. Please check the console for details.`})}finally{m(!1)}},_=()=>{n(!a),u("")};return t?e.jsx("div",{className:"auth-modal-overlay",onClick:s,children:e.jsxs("div",{className:"auth-modal",onClick:k=>k.stopPropagation(),children:[e.jsxs("div",{className:"auth-modal-header",children:[e.jsx("div",{className:"auth-logo",children:"🎯"}),e.jsx("h2",{children:"ScreenMerch Login"}),e.jsx("button",{className:"auth-close-btn",onClick:s,children:"×"})]}),e.jsxs("div",{className:"auth-message",children:[e.jsx("strong",{children:"Login Required"}),e.jsx("br",{}),"To create merchandise, please log in or create an account with your email address."]}),e.jsxs("form",{onSubmit:g,className:"auth-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"email",children:"Email Address"}),e.jsx("input",{type:"email",id:"email",value:i,onChange:k=>o(k.target.value),required:!0,placeholder:"Enter your email"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"password",children:"Password"}),e.jsx("input",{type:"password",id:"password",value:d,onChange:k=>x(k.target.value),required:!0,placeholder:"Enter your password"})]}),e.jsx("button",{type:"submit",className:"auth-submit-btn",disabled:y,children:y?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"loading-spinner"}),"Processing..."]}):a?"Login":"Sign Up"})]}),e.jsxs("div",{className:"auth-toggle",children:[e.jsx("span",{children:a?"Don't have an account?":"Already have an account?"}),e.jsx("button",{type:"button",onClick:_,className:"auth-toggle-btn",children:a?"Sign Up":"Login"})]}),v&&e.jsx("div",{className:`auth-message-display ${v.type}`,children:v.text})]})}):null},Ol=()=>{const[t,s]=l.useState(!1),[r,a]=l.useState(!1);return l.useEffect(()=>{const n=()=>{const i=window.innerWidth<=768,o=i&&window.innerHeight>window.innerWidth;s(i),a(o)};return n(),window.addEventListener("resize",n),window.addEventListener("orientationchange",n),()=>{window.removeEventListener("resize",n),window.removeEventListener("orientationchange",n)}},[]),{isMobile:t,isMobilePortrait:r}},Rl=({videoId:t,thumbnail:s,setThumbnail:r,screenshots:a,setScreenshots:n,videoRef:i,onVideoData:o,onScreenshotFunction:d})=>{const x=Bt(),y=t||x.videoId,{isMobile:m,isMobilePortrait:v}=Ol(),[u,g]=l.useState(null),[_,k]=l.useState(!0),[T,W]=l.useState(""),D=i||l.useRef(null),[$]=l.useState(l.useRef(null)),[E,R]=l.useState(!1),U=l.useRef(!1),[H,se]=l.useState(!1),[Q,le]=l.useState(0),[B,ae]=l.useState(!1),[w,c]=l.useState({x:0,y:0,width:200,height:200}),[j,h]=l.useState(!1),[f,C]=l.useState(!1),[p,P]=l.useState(null),[Y,b]=l.useState({x:0,y:0}),[F,q]=l.useState([]),re=l.useCallback(S=>{},[]);l.useEffect(()=>{if(D.current&&m){const S=D.current;S.setAttribute("playsinline","true"),S.setAttribute("webkit-playsinline","true"),S.setAttribute("x-webkit-airplay","allow"),S.setAttribute("preload","metadata"),S.addEventListener("webkitbeginfullscreen",V=>{V.preventDefault(),S.webkitExitFullscreen()}),S.addEventListener("webkitendfullscreen",V=>{V.preventDefault()});const O=V=>{S.webkitPresentationMode==="fullscreen"&&S.webkitSetPresentationMode("inline")};return S.addEventListener("webkitpresentationmodechanged",O),()=>{S.removeEventListener("webkitbeginfullscreen",O),S.removeEventListener("webkitendfullscreen",O),S.removeEventListener("webkitpresentationmodechanged",O)}}},[m,D.current]),l.useEffect(()=>{if(!y){W("No video selected."),k(!1);return}(async()=>{k(!0),W("");let{data:O,error:V}=await M.from("videos2").select("*").eq("id",y).single();if(V)console.error("Supabase error:",V),W("Video not found."),g(null);else{if(!O.video_url){console.error("No video URL found in data"),W("Video URL is missing."),g(null),k(!1);return}try{const z=await fetch(O.video_url,{method:"HEAD"});z.ok||console.warn("Video URL may not be accessible:",z.status)}catch(z){console.warn("Could not test video URL accessibility:",z)}if(g(O),O.thumbnail||O.poster){const z=O.thumbnail||O.poster;r(z),n&&a.length===0&&n([z])}o&&o(O)}k(!1)})()},[y,r,n]),l.useEffect(()=>{D.current&&D.current.load(),n([]),q([]),se(!1),le(0),U.current=!1},[y,n]);const Se=l.useCallback(async()=>{if(a.length>=6){re("Maximum 6 screenshots allowed. Please delete some screenshots first.");return}const O=D.current;if(!O){re("Video not loaded yet. Please wait for the video to load.");return}const V=O.currentTime||0,z=await _e();if(z)n(J=>{const oe=J.length<6?[...J,z]:J;return as(J.length),oe}),q(J=>J.length<6?[...J,V]:J);else try{const J=O.currentTime||0,oe=(u==null?void 0:u.video_url)||O.src;if(!oe)throw new Error("No video URL available");const X=new AbortController,me=setTimeout(()=>X.abort(),3e4),ne=await fetch(ve.ENDPOINTS.CAPTURE_SCREENSHOT,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({video_url:oe,timestamp:J,quality:85}),signal:X.signal});if(clearTimeout(me),!ne.ok)throw new Error(`Server responded with status: ${ne.status}`);const pe=await ne.json();if(pe.success&&pe.screenshot)n(ye=>{const Et=ye.length<6?[...ye,pe.screenshot]:ye;return as(ye.length),Et}),q(ye=>ye.length<6?[...ye,J]:ye);else throw new Error(pe.error||"Server failed to capture screenshot")}catch(J){J.name==="AbortError"&&re("Screenshot capture timed out. The video might be too large or slow to process. Using thumbnail instead.");const oe=(u==null?void 0:u.thumbnail)||(u==null?void 0:u.poster)||O.poster;if(oe)n(X=>{const me=X.length<6?[...X,oe]:X;return as(X.length),me});else{const X=document.createElement("div");X.style.cssText=`
                        position: fixed;
                        top: 20px;
                        right: 20px;
                        background: #f44336;
                        color: white;
                        padding: 12px 20px;
                        border-radius: 8px;
                        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                        z-index: 10000;
                        animation: slideIn 0.3s ease-out;
                        max-width: 300px;
                        font-size: 14px;
                        font-weight: 500;
                    `,X.textContent="Failed to capture screenshot. Please try again.",document.body.appendChild(X),setTimeout(()=>document.body.removeChild(X),3e3)}}},[u,D,n]);l.useEffect(()=>{d&&u&&!_&&!U.current&&(d(Se),U.current=!0)},[d,u,_]);const Te=async()=>{if(!(H||Date.now()-Q<100)){if(a.length>=6){re("Maximum 6 screenshots allowed. Please delete some screenshots first.");return}se(!0);try{await Se()}finally{se(!1)}}},_e=l.useCallback(async()=>{const S=D.current;if(!S)return console.error("Video element not found"),null;try{if(!(S.readyState>=2&&S.videoWidth>0&&S.videoHeight>0))return null;const O=document.createElement("canvas"),V=O.getContext("2d"),z=S.getBoundingClientRect();return O.width=z.width,O.height=z.height,V.drawImage(S,0,0,O.width,O.height),O.toDataURL("image/jpeg",.9)}catch(O){return console.error("Error capturing video frame:",O),null}},[m]),Qe=async()=>{const S=localStorage.getItem("user_authenticated");if(!S||S==="false"||S==="null"){const V={thumbnail:s,videoUrl:(u==null?void 0:u.video_url)||window.location.href,screenshots:a.slice(0,6),videoTitle:(u==null?void 0:u.title)||"Unknown Video",creatorName:(u==null?void 0:u.channelTitle)||"Unknown Creator"};localStorage.setItem("pending_merch_data",JSON.stringify(V)),R(!0);return}const O={thumbnail:s,videoUrl:(u==null?void 0:u.video_url)||window.location.href,screenshots:a.slice(0,6),videoTitle:(u==null?void 0:u.title)||"Unknown Video",creatorName:(u==null?void 0:u.channelTitle)||"Unknown Creator"};localStorage.setItem("pending_merch_data",JSON.stringify(O)),await Hs()},mt=()=>{if(ae(!B),!B){const S=D.current;if(S){const O=S.getBoundingClientRect(),V=O.width/2-100,z=O.height/2-100;c({x:V,y:z,width:200,height:200})}}},rs=S=>{if(!B)return;const O=D.current;if(!O)return;const V=O.getBoundingClientRect(),z=S.clientX-V.left,J=S.clientY-V.top;z>=w.x&&z<=w.x+w.width&&J>=w.y&&J<=w.y+w.height&&(h(!0),b({x:z-w.x,y:J-w.y}))},Kr=S=>{if(!B||!j&&!f)return;const O=D.current;if(!O)return;const V=O.getBoundingClientRect(),z=S.clientX-V.left,J=S.clientY-V.top;if(j){const oe=Math.max(0,Math.min(V.width-w.width,z-Y.x)),X=Math.max(0,Math.min(V.height-w.height,J-Y.y));c(me=>({...me,x:oe,y:X}))}else if(f){let oe=w.width,X=w.height,me=w.x,ne=w.y;if(p.includes("right")&&(oe=Math.max(50,z-w.x)),p.includes("left")){const pe=w.x+w.width-50;me=Math.min(pe,z),oe=w.x+w.width-me}if(p.includes("bottom")&&(X=Math.max(50,J-w.y)),p.includes("top")){const pe=w.y+w.height-50;ne=Math.min(pe,J),X=w.y+w.height-ne}c({x:me,y:ne,width:oe,height:X})}},Bs=()=>{h(!1),C(!1),P(null)},ea=S=>{if(!B)return;S.preventDefault(),S.stopPropagation();const O=D.current;if(!O)return;const V=S.touches[0],z=O.getBoundingClientRect(),J=V.clientX-z.left,oe=V.clientY-z.top;J>=w.x&&J<=w.x+w.width&&oe>=w.y&&oe<=w.y+w.height&&(h(!0),b({x:J-w.x,y:oe-w.y}))},ta=S=>{if(!B||!j&&!f)return;S.preventDefault(),S.stopPropagation();const O=D.current;if(!O)return;const V=S.touches[0],z=O.getBoundingClientRect(),J=V.clientX-z.left,oe=V.clientY-z.top;if(j){const X=Math.max(0,Math.min(z.width-w.width,J-Y.x)),me=Math.max(0,Math.min(z.height-w.height,oe-Y.y));c(ne=>({...ne,x:X,y:me}))}else if(f){let X=w.width,me=w.height,ne=w.x,pe=w.y;if(p.includes("right")&&(X=Math.max(50,J-w.x)),p.includes("left")){const ye=w.x+w.width-50;ne=Math.min(ye,J),X=w.x+w.width-ne}if(p.includes("bottom")&&(me=Math.max(50,oe-w.y)),p.includes("top")){const ye=w.y+w.height-50;pe=Math.min(ye,oe),me=w.y+w.height-pe}c({x:ne,y:pe,width:X,height:me})}},sa=S=>{S&&(S.preventDefault(),S.stopPropagation()),h(!1),C(!1),P(null)},kt=(S,O)=>{O.stopPropagation(),O.preventDefault(),C(!0),P(S)},Ct=(S,O)=>{O.stopPropagation(),O.preventDefault(),C(!0),P(S)},Pt=S=>{if(!f)return;S.preventDefault(),S.stopPropagation();const O=D.current;if(!O)return;const V=S.touches[0],z=O.getBoundingClientRect(),J=V.clientX-z.left,oe=V.clientY-z.top;let X=w.width,me=w.height,ne=w.x,pe=w.y;if(p.includes("right")&&(X=Math.max(50,J-w.x)),p.includes("left")){const ye=w.x+w.width-50;ne=Math.min(ye,J),X=w.x+w.width-ne}if(p.includes("bottom")&&(me=Math.max(50,oe-w.y)),p.includes("top")){const ye=w.y+w.height-50;pe=Math.min(ye,oe),me=w.y+w.height-pe}c({x:ne,y:pe,width:X,height:me})},Mt=S=>{S&&(S.preventDefault(),S.stopPropagation()),C(!1),P(null)},ra=async()=>{if(!B)return;const S=D.current;if(S)try{if(!(u!=null&&u.video_url)){alert("Video URL not available. Please try again.");return}const O=S.currentTime||0,V=u.video_url,z=await fetch(ve.ENDPOINTS.CAPTURE_SCREENSHOT,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({video_url:V,timestamp:O})});if(!z.ok)throw new Error(`Server error: ${z.status}`);const J=await z.json();if(!J.success||!J.screenshot)throw new Error(J.error||"Server failed to capture screenshot");const oe=J.screenshot,X=document.createElement("canvas"),me=X.getContext("2d"),ne=new Image;ne.onload=()=>{try{const pe=S.getBoundingClientRect(),ye=pe.width,Et=pe.height,Vs=ne.width/ye,zs=ne.height/Et,ia=Math.round(w.x*Vs),oa=Math.round(w.y*zs),Gs=Math.round(w.width*Vs),qs=Math.round(w.height*zs),Js=Math.max(0,Math.min(ne.width-Gs,ia)),Zs=Math.max(0,Math.min(ne.height-qs,oa)),ns=Math.min(Gs,ne.width-Js),is=Math.min(qs,ne.height-Zs);X.width=ns,X.height=is,me.clearRect(0,0,X.width,X.height),me.drawImage(ne,Js,Zs,ns,is,0,0,ns,is);const la=X.toDataURL("image/jpeg",.9);n(os=>os.length<6?[...os,la]:os),ae(!1)}catch(pe){console.error("Error cropping screenshot:",pe),alert("Failed to crop image. Please try again.")}},ne.onerror=()=>{console.error("Failed to load screenshot for cropping"),alert("Failed to load screenshot for cropping. Please try again.")},ne.src=oe}catch(O){console.error("Error applying crop:",O),console.error("Error details:",{videoElement:!!S,videoReadyState:S==null?void 0:S.readyState,cropArea:w}),alert("Failed to crop image. Please try again.")}},aa=()=>{ae(!1),h(!1),C(!1),P(null)},Hs=async()=>{try{const S={thumbnail:s,videoUrl:(u==null?void 0:u.video_url)||window.location.href,screenshots:a.slice(0,6),screenshot_timestamp:F[0]||0,videoTitle:(u==null?void 0:u.title)||"Unknown Video",creatorName:(u==null?void 0:u.channelTitle)||"Unknown Creator"},O=await fetch(ve.ENDPOINTS.CREATE_PRODUCT,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(S)});if(!O.ok){const z=await O.text();throw console.error("Server error response:",z),new Error(`Server error: ${O.status} - ${z}`)}const V=await O.json();V.success&&V.product_url?m?setTimeout(()=>{window.location.href=V.product_url},1e3):window.open(V.product_url,"_blank"):(console.error("Failed to create product:",V),alert(`Failed to create merch product page: ${V.error||"Unknown error"}`))}catch(S){console.error("Make Merch error:",S),alert(`Error connecting to merch server: ${S.message}. Please check the console for more details.`)}},na=()=>{R(!1),setTimeout(()=>{Hs()},1e3)},as=l.useCallback(S=>{},[]);return _?e.jsxs("div",{style:{padding:24,textAlign:"center",background:"#f8f9fa",borderRadius:"8px",border:"1px solid #dee2e6"},children:[e.jsx("div",{style:{width:"40px",height:"40px",border:"4px solid #f3f3f3",borderTop:"4px solid #007bff",borderRadius:"50%",animation:"spin 1s linear infinite",margin:"0 auto 16px auto"}}),e.jsx("p",{children:"Loading video..."}),u&&e.jsxs("p",{style:{fontSize:"14px",color:"#6c757d"},children:["URL: ",u.video_url]})]}):T||!u?e.jsxs("div",{style:{padding:24,color:"red",background:"#f8d7da",borderRadius:"8px",border:"1px solid #f5c6cb"},children:[e.jsx("h3",{children:"Video Error"}),e.jsx("p",{children:T||"Video not found."}),u&&e.jsxs("div",{style:{marginTop:"12px",fontSize:"14px"},children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Video URL:"})," ",u.video_url]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Video ID:"})," ",y]})]})]}):e.jsxs("div",{className:`play-video ${B?"crop-mode-active":""}`,children:[e.jsx("div",{className:"video-container",ref:$,style:{position:"relative",display:"inline-block",marginBottom:m?"0px":"15px"},children:e.jsxs("div",{style:{position:"relative",display:"inline-block",width:"100%",maxWidth:"100%"},children:[e.jsx("video",{ref:D,controls:!0,poster:u.thumbnail||"",width:"100%",height:m?"320":"360",style:{background:"#000",width:"100%",height:m?"320px":"360px",outline:"none"},src:u.video_url,crossOrigin:"anonymous",playsInline:!0,"webkit-playsinline":"true","x-webkit-airplay":"allow",preload:"metadata",disablePictureInPicture:!0,onCanPlay:()=>{k(!1)},onLoadedData:()=>{k(!1)}},y),e.jsx("button",{onClick:mt,style:{position:"absolute",top:"10px",left:"10px",background:B?"rgba(0, 123, 255, 0.9)":"rgba(0, 0, 0, 0.7)",border:"none",borderRadius:"50%",width:"40px",height:"40px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10,transition:"all 0.2s ease"},onMouseEnter:S=>{S.target.style.background=B?"rgba(0, 123, 255, 1)":"rgba(0, 0, 0, 0.9)",S.target.style.transform="scale(1.1)"},onMouseLeave:S=>{S.target.style.background=B?"rgba(0, 123, 255, 0.9)":"rgba(0, 0, 0, 0.7)",S.target.style.transform="scale(1)"},title:B?"Exit Crop Mode":"Crop Screenshot",children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"white",children:e.jsx("path",{d:"M6 2L8 4L10 2L12 4L14 2L16 4L18 2V6L16 8L18 10L16 12L18 14L16 16L18 18H14L12 16L10 18L8 16L6 18H2V14L4 12L2 10L4 8L2 6V2H6Z"})})}),B&&e.jsxs("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:5,cursor:j?"move":"default"},onMouseDown:rs,onMouseMove:Kr,onMouseUp:Bs,onMouseLeave:Bs,onTouchStart:ea,onTouchMove:ta,onTouchEnd:sa,children:[e.jsxs("div",{className:"crop-area",style:{position:"absolute",left:w.x,top:w.y,width:w.width,height:w.height,border:"2px dashed #007bff",backgroundColor:"rgba(0, 123, 255, 0.1)",cursor:j?"move":"default"},children:[e.jsx("div",{className:"resize-handle",style:{position:"absolute",top:m?-10:-5,left:m?-10:-5,width:m?20:10,height:m?20:10,backgroundColor:"#007bff",borderRadius:"50%",cursor:"nw-resize",border:m?"2px solid white":"none",boxShadow:m?"0 2px 4px rgba(0,0,0,0.3)":"none",zIndex:10},onMouseDown:S=>kt("top-left",S),onTouchStart:S=>Ct("top-left",S),onTouchMove:Pt,onTouchEnd:Mt}),e.jsx("div",{className:"resize-handle",style:{position:"absolute",top:m?-10:-5,right:m?-10:-5,width:m?20:10,height:m?20:10,backgroundColor:"#007bff",borderRadius:"50%",cursor:"ne-resize",border:m?"2px solid white":"none",boxShadow:m?"0 2px 4px rgba(0,0,0,0.3)":"none",zIndex:10},onMouseDown:S=>kt("top-right",S),onTouchStart:S=>Ct("top-right",S),onTouchMove:Pt,onTouchEnd:Mt}),e.jsx("div",{className:"resize-handle",style:{position:"absolute",bottom:m?-10:-5,left:m?-10:-5,width:m?20:10,height:m?20:10,backgroundColor:"#007bff",borderRadius:"50%",cursor:"sw-resize",border:m?"2px solid white":"none",boxShadow:m?"0 2px 4px rgba(0,0,0,0.3)":"none",zIndex:10},onMouseDown:S=>kt("bottom-left",S),onTouchStart:S=>Ct("bottom-left",S),onTouchMove:Pt,onTouchEnd:Mt}),e.jsx("div",{className:"resize-handle",style:{position:"absolute",bottom:m?-10:-5,right:m?-10:-5,width:m?20:10,height:m?20:10,backgroundColor:"#007bff",borderRadius:"50%",cursor:"se-resize",border:m?"2px solid white":"none",boxShadow:m?"0 2px 4px rgba(0,0,0,0.3)":"none",zIndex:10},onMouseDown:S=>kt("bottom-right",S),onTouchStart:S=>Ct("bottom-right",S),onTouchMove:Pt,onTouchEnd:Mt})]}),e.jsxs("div",{style:{position:"absolute",bottom:"20px",left:"50%",transform:"translateX(-50%)",display:"flex",gap:"10px",zIndex:6},children:[e.jsx("button",{onClick:aa,onTouchStart:S=>S.stopPropagation(),onTouchEnd:S=>S.stopPropagation(),style:{padding:m?"12px 20px":"8px 16px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:m?"16px":"14px",minHeight:m?"44px":"auto",minWidth:m?"80px":"auto",touchAction:"manipulation",zIndex:20},children:"Cancel"}),e.jsx("button",{onClick:ra,onTouchStart:S=>S.stopPropagation(),onTouchEnd:S=>S.stopPropagation(),style:{padding:m?"12px 20px":"8px 16px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:m?"16px":"14px",minHeight:m?"44px":"auto",minWidth:m?"80px":"auto",touchAction:"manipulation",zIndex:20},children:"Apply Crop"})]})]})]})}),e.jsxs("div",{className:"screenmerch-actions",style:{display:"flex",gap:"10px",marginBottom:"0px",marginTop:m?"5px":"0px",flexWrap:"wrap"},children:[e.jsx("button",{className:"screenmerch-btn",onClick:Te,disabled:H||a.length>=6,style:{padding:"14px 24px",backgroundColor:H||a.length>=6?"#6c757d":"#007bff",color:"white",border:"none",borderRadius:"5px",cursor:H||a.length>=6?"not-allowed":"pointer",fontWeight:"bold",opacity:H||a.length>=6?.7:1,textAlign:"center",lineHeight:"1.2"},children:H?"Capturing...":a.length>=6?"Max Screenshots":"Select Screenshot"}),e.jsx("button",{className:"screenmerch-btn",onClick:Qe,style:{padding:"10px 20px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"5px",cursor:"pointer",fontWeight:"bold",touchAction:"manipulation"},children:"Make Merch"})]}),e.jsx("h3",{style:{marginTop:"15px",marginBottom:m?"5px":"15px",fontWeight:"600",fontSize:"22px",textAlign:"center"},children:u.title}),e.jsx("div",{className:"publisher",children:e.jsx("div",{})}),e.jsx($s,{isOpen:E,onClose:()=>R(!1),onSuccess:na})]})},Yl=({thumbnail:t,screenshots:s,onDeleteScreenshot:r})=>e.jsx("div",{className:"screenmerch-images-grid",children:[0,1,2,3,4,5].map(a=>e.jsx("div",{className:"screenmerch-image-box",children:s[a]?e.jsxs("div",{className:"screenmerch-img-wrapper",children:[e.jsx("img",{src:s[a],alt:`Screenshot ${a+1}`,className:"screenmerch-preview",style:{maxWidth:"100%",maxHeight:"100%",width:"auto",height:"auto",objectFit:"contain"},onError:n=>console.error(`Failed to load screenshot ${a+1}:`,n.target.src),onLoad:()=>{}}),e.jsx("div",{className:"screenmerch-buttons",children:e.jsx("button",{className:"screenmerch-delete-btn",onClick:()=>r(a),title:"Delete screenshot",children:"×"})})]}):e.jsx("div",{className:"screenmerch-placeholder",children:"No screenshot"})},a))}),Ll=({sidebar:t})=>{const{videoId:s,categoryId:r}=Bt(),[a,n]=l.useState(null),[i,o]=l.useState([]),[d,x]=l.useState(!1),[y,m]=l.useState(!1),[v,u]=l.useState(!1),[g,_]=l.useState(null),k=l.useRef(null),[T,W]=l.useState(0),[D,$]=l.useState(!0),[E,R]=l.useState(!1),[U,H]=l.useState(!1);l.useEffect(()=>{const c=()=>{const j=window.innerWidth<=768,h=j&&window.innerHeight>window.innerWidth;x(j),m(h)};return c(),window.addEventListener("resize",c),window.addEventListener("orientationchange",c),()=>{window.removeEventListener("resize",c),window.removeEventListener("orientationchange",c)}},[]),l.useEffect(()=>{if(s){const c=setTimeout(()=>{if(d){const j=document.querySelector(".video-container"),h=document.querySelector("nav");if(j&&h){const f=h.offsetHeight,p=j.getBoundingClientRect().top+window.scrollY-f-10;window.scrollTo({top:p,behavior:"smooth"})}else if(j){const C=j.getBoundingClientRect().top+window.scrollY-70;window.scrollTo({top:C,behavior:"smooth"})}else window.scrollTo({top:0,behavior:"smooth"})}else{const j=document.querySelector(".video-container"),h=document.querySelector("nav");if(j&&h){const f=h.offsetHeight,p=j.getBoundingClientRect().top+window.scrollY-f;window.scrollTo({top:p,behavior:"smooth"})}else if(j){const C=j.getBoundingClientRect().top+window.scrollY-80;window.scrollTo({top:C,behavior:"smooth"})}else window.scrollTo({top:0,behavior:"smooth"})}},500);return()=>clearTimeout(c)}},[d,s]),l.useEffect(()=>{a&&i.length===0&&o([a])},[a,i.length]),l.useEffect(()=>{W(i.length),U||i.length>1?($(!1),R(!0)):($(!0),R(!1))},[i,U]),l.useEffect(()=>{s&&a&&(o([a]),H(!1))},[s,a]);const se=c=>{o(j=>j.filter((h,f)=>f!==c))},Q=(c,j)=>{o(h=>{const f=[...h];return f[c]=j,f})},le=async()=>{console.log("Step 2 clicked - attempting screenshot capture");const c=i.length,j=document.querySelector(".screenmerch-btn");j&&j.textContent.includes("Select Screenshot")?(console.log("Clicking working screenshot button..."),j.click(),H(!0),console.log("Screenshot function completed"),setTimeout(()=>{i.length>c&&console.log("Screenshot successfully added, switching pulse states")},500)):console.log("Screenshot button not found or not ready yet")},B=async()=>{const c=localStorage.getItem("user_authenticated");try{const j={thumbnail:a,videoUrl:window.location.href,screenshots:i.slice(0,6),videoTitle:(g==null?void 0:g.title)||"Unknown Video",creatorName:(g==null?void 0:g.channelTitle)||"Unknown Creator"};localStorage.setItem("pending_merch_data",JSON.stringify(j))}catch(j){console.warn("Failed saving pending_merch_data:",j)}if(!c){u(!0);return}await ae()},ae=async()=>{try{const c=localStorage.getItem("user_authenticated"),j=localStorage.getItem("user_email"),h=window.location.href,f=(g==null?void 0:g.title)||"Unknown Video",C=(g==null?void 0:g.channelTitle)||"Unknown Creator",p={thumbnail:a,videoUrl:h,videoTitle:f,creatorName:C,screenshots:i.slice(0,6),isAuthenticated:c==="true",userEmail:j||""},P=await fetch(ve.ENDPOINTS.CREATE_PRODUCT,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(p)});if(!P.ok){const b=await P.text();throw console.error("Server error response:",b),new Error(`Server error: ${P.status} - ${b}`)}const Y=await P.json();if(Y.success&&Y.product_url)if(window.innerWidth<=768)try{window.location.href=Y.product_url}catch{const F=document.createElement("div");F.style.cssText=`
             position: fixed;
             top: 20px;
             right: 20px;
             background: #4CAF50;
             color: white;
             padding: 12px 20px;
             border-radius: 8px;
             box-shadow: 0 4px 12px rgba(0,0,0,0.15);
             z-index: 10000;
             animation: slideIn 0.3s ease-out;
             max-width: 300px;
             font-size: 14px;
             font-weight: 500;
           `,F.textContent=`Your merch page is ready! Please visit: ${Y.product_url}`,document.body.appendChild(F),setTimeout(()=>document.body.removeChild(F),5e3)}else window.open(Y.product_url,"_blank");else{console.error("Failed to create product:",Y);const b=document.createElement("div");b.style.cssText=`
           position: fixed;
           top: 20px;
           right: 20px;
           background: #f44336;
           color: white;
           padding: 12px 20px;
           border-radius: 8px;
           box-shadow: 0 4px 12px rgba(0,0,0,0.15);
           z-index: 10000;
           animation: slideIn 0.3s ease-out;
           max-width: 300px;
           font-size: 14px;
           font-weight: 500;
         `,b.textContent=`Failed to create merch product page: ${Y.error||"Unknown error"}`,document.body.appendChild(b),setTimeout(()=>document.body.removeChild(b),5e3)}}catch(c){console.error("Make Merch error:",c);const j=document.createElement("div");j.style.cssText=`
         position: fixed;
         top: 20px;
         right: 20px;
         background: #f44336;
         color: white;
         padding: 12px 20px;
         border-radius: 8px;
         box-shadow: 0 4px 12px rgba(0,0,0,0.15);
         z-index: 10000;
         animation: slideIn 0.3s ease-out;
         max-width: 300px;
         font-size: 14px;
         font-weight: 500;
       `,j.textContent=`Error connecting to merch server: ${c.message}`,document.body.appendChild(j),setTimeout(()=>document.body.removeChild(j),5e3)}},w=()=>{B()};return e.jsxs("div",{className:"video-page-container",children:[e.jsx("div",{className:"user-flow-section",children:e.jsxs("div",{className:"flow-steps",children:[e.jsxs("div",{className:"flow-step clickable-step",onClick:le,style:{cursor:"pointer",userSelect:"none",WebkitTapHighlightColor:"transparent"},children:[e.jsx("div",{className:`step-number ${D?"pulse":""}`,children:"2"}),e.jsxs("div",{className:"step-content",children:[e.jsx("h3",{children:"Select Screenshot"}),e.jsx("p",{children:"Select the perfect screenshot to capture"})]})]}),e.jsx("div",{className:"flow-arrow",children:"→"}),e.jsxs("div",{className:"flow-step",onClick:w,style:{cursor:"pointer",userSelect:"none",WebkitTapHighlightColor:"transparent"},children:[e.jsx("div",{className:`step-number ${E?"pulse":""}`,children:"3"}),e.jsxs("div",{className:"step-content",children:[e.jsx("h3",{children:"Make Merchandise"}),e.jsx("p",{children:"Create custom products with your screenshot"})]})]})]})}),e.jsxs("div",{className:"main-container",children:[e.jsx("div",{className:"video-viewer",children:s?e.jsx(Rl,{videoId:s,thumbnail:a,setThumbnail:n,screenshots:i,setScreenshots:o,videoRef:k,onVideoData:_}):e.jsx("div",{style:{padding:24,color:"red"},children:"No video selected."})}),e.jsxs("div",{className:"screenshots-section",id:"screenshotsSection",style:{position:"relative"},children:[d&&s&&e.jsx("div",{id:"screenshotCounter",style:{position:"absolute",top:"10px",right:"10px",background:T>=6?"#ff4444":"#fff",border:`2px solid ${T>=6?"#ff4444":"#ddd"}`,borderRadius:"50%",width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",fontSize:"16px",color:T>=6?"#fff":"#333",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",zIndex:100},children:T}),e.jsx(Yl,{thumbnail:a,screenshots:i,onDeleteScreenshot:se,onCropScreenshot:Q})]})]}),e.jsx($s,{isOpen:v,onClose:()=>u(!1),onSuccess:ae})]})},Fl=({sidebar:t})=>{var le,B,ae;const[s,r]=l.useState(null),[a,n]=l.useState(null),[i,o]=l.useState(!0),d=je(),[x,y]=l.useState(""),[m,v]=l.useState(""),[u,g]=l.useState(null),[_,k]=l.useState(null),[T,W]=l.useState(!1),[D,$]=l.useState(""),[E,R]=l.useState(0);l.useEffect(()=>{(async()=>{var c,j,h;try{const{data:{user:f}}=await M.auth.getUser();if(!f){$("❌ Please log in to upload videos"),o(!1);return}r(f);const{data:C,error:p}=await M.from("users").select("*").eq("id",f.id).single();if(C)n(C);else if(p&&p.code==="PGRST116"){const{data:P,error:Y}=await M.from("users").upsert({id:f.id,email:f.email,username:((c=f.email)==null?void 0:c.split("@")[0])||"user",display_name:((j=f.user_metadata)==null?void 0:j.name)||((h=f.email)==null?void 0:h.split("@")[0])||"User",role:"creator",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{onConflict:"id",ignoreDuplicates:!1}).select().single();if(Y&&Y.message.includes("duplicate key")){console.log("Duplicate key detected, fetching existing user");const{data:b,error:F}=await M.from("users").select("*").eq("id",f.id).single();b&&n(b)}else P&&n(P)}}catch(f){console.error("Error fetching user:",f),$("❌ Authentication error. Please log in again.")}finally{o(!1)}})()},[]);const U=(w,c)=>{if(!w)return"No file selected";if(c==="video"){if(!w.type.startsWith("video/"))return"Please select a valid video file";if(w.size>100*1024*1024)return"Video file size must be less than 100MB"}else if(c==="image"){if(!w.type.startsWith("image/"))return"Please select a valid image file";if(w.size>10*1024*1024)return"Image file size must be less than 10MB"}return null},H=w=>{const c=w.target.files[0],j=U(c,"video");j?($(`❌ ${j}`),g(null)):(g(c),$(""))},se=w=>{const c=w.target.files[0],j=U(c,"image");j?($(`❌ ${j}`),k(null)):(k(c),$(""))},Q=async w=>{var c,j,h;if(w.preventDefault(),$(""),R(0),!x.trim()){$("❌ Please enter a video title");return}if(!m.trim()){$("❌ Please enter a video description");return}if(!u){$("❌ Please select a video file");return}if(!_){$("❌ Please select a thumbnail image");return}if(!s||!s.id){$("❌ Please log in to upload videos");return}W(!0);try{console.log("Starting upload process..."),console.log("User ID:",s.id);const f=await fetch("https://screenmerch.fly.dev/api/users/ensure-exists",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:s.id,email:s.email,display_name:(a==null?void 0:a.display_name)||((c=s.user_metadata)==null?void 0:c.name)})});if(!f.ok)throw new Error("Failed to ensure user exists in database");const C=await f.json();console.log("User ensured:",C),R(10);const p=u.name.split(".").pop(),P=`${s.id}/${Date.now()}.${p}`;console.log("Uploading video to:",P);const{error:Y,data:b}=await M.storage.from("videos2").upload(P,u,{cacheControl:"3600",upsert:!1});if(Y)throw console.error("Video upload error:",Y),new Error(`Video upload failed: ${Y.message}`);R(50);const{data:F}=M.storage.from("videos2").getPublicUrl(P);console.log("Video uploaded successfully:",F.publicUrl),R(60);const q=_.name.split(".").pop(),re=`${s.id}/${Date.now()}_thumb.${q}`;console.log("Uploading thumbnail to:",re);const{error:Se,data:Te}=await M.storage.from("thumbnails").upload(re,_,{cacheControl:"3600",upsert:!1});if(Se)throw console.error("Thumbnail upload error:",Se),new Error(`Thumbnail upload failed: ${Se.message}`);R(80);const{data:_e}=M.storage.from("thumbnails").getPublicUrl(re);console.log("Thumbnail uploaded successfully:",_e.publicUrl),R(90),console.log("Inserting video metadata into database...");const Qe={title:x.trim(),description:m.trim(),video_url:F.publicUrl,thumbnail:_e.publicUrl,channelTitle:(a==null?void 0:a.display_name)||((j=s.user_metadata)==null?void 0:j.name)||((h=s.email)==null?void 0:h.split("@")[0])||"Unknown Creator",user_id:s.id,verification_status:"verified_via_supabase_auth",created_at:new Date().toISOString()};console.log("Video metadata:",Qe);const{error:mt,data:rs}=await M.from("videos2").insert([Qe]).select();if(mt)throw console.error("Database insert error:",mt),new Error(`Database error: ${mt.message}`);R(100),console.log("Video uploaded and saved successfully:",rs),$("✅ Video uploaded successfully! Redirecting you to the homepage..."),y(""),v(""),g(null),k(null),setTimeout(()=>{d("/")},2e3)}catch(f){if(console.error("Upload error:",f),$(`❌ Upload failed: ${f.message}`),f.message.includes("Database error")&&u)try{const C=u.name.split(".").pop(),p=`${s.id}/${Date.now()}.${C}`;await M.storage.from("videos2").remove([p]),console.log("Cleaned up uploaded video file")}catch(C){console.error("Failed to cleanup video file:",C)}}finally{W(!1),R(0)}};return i?e.jsx("div",{className:`container ${t?"":" large-container"}`,children:e.jsx("h2",{children:"Loading..."})}):s?e.jsx("div",{className:`container ${t?"":" large-container"}`,children:e.jsxs("div",{style:{maxWidth:700,margin:"20px auto",background:"#fff",padding:24,borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("h2",{children:"Upload a New Video"}),e.jsxs("div",{className:"uploader-info",children:[e.jsx("img",{src:(a==null?void 0:a.profile_image_url)||((le=s.user_metadata)==null?void 0:le.picture)||"/default-avatar.jpg",alt:"Your avatar"}),e.jsxs("p",{children:["You are uploading as: ",e.jsx("strong",{children:(a==null?void 0:a.display_name)||((B=s.user_metadata)==null?void 0:B.name)||((ae=s.email)==null?void 0:ae.split("@")[0])||"Your Channel"})]})]}),e.jsxs("form",{onSubmit:Q,children:[e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("label",{children:"Title *"}),e.jsx("input",{type:"text",value:x,onChange:w=>y(w.target.value),required:!0,style:{width:"100%",padding:8,marginTop:4},placeholder:"Enter video title"})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("label",{children:"Description *"}),e.jsx("textarea",{value:m,onChange:w=>v(w.target.value),required:!0,style:{width:"100%",padding:8,marginTop:4},rows:4,placeholder:"Enter video description"})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("label",{children:"Video File * (Max 100MB)"}),e.jsx("input",{type:"file",accept:"video/*",onChange:H,required:!0,style:{display:"block",marginTop:4}}),u&&e.jsxs("small",{style:{color:"#666",marginTop:4,display:"block"},children:["Selected: ",u.name," (",(u.size/1024/1024).toFixed(2)," MB)"]})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("label",{children:"Thumbnail Image * (Max 10MB)"}),e.jsx("input",{type:"file",accept:"image/*",onChange:se,required:!0,style:{display:"block",marginTop:4}}),_&&e.jsxs("small",{style:{color:"#666",marginTop:4,display:"block"},children:["Selected: ",_.name," (",(_.size/1024/1024).toFixed(2)," MB)"]})]}),E>0&&e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("div",{style:{width:"100%",backgroundColor:"#f0f0f0",borderRadius:4,overflow:"hidden",marginTop:8},children:e.jsx("div",{style:{width:`${E}%`,height:20,backgroundColor:"#4CAF50",transition:"width 0.3s ease"}})}),e.jsxs("small",{style:{color:"#666"},children:["Upload Progress: ",E,"%"]})]}),D&&e.jsx("div",{className:`upload-message ${D.includes("✅")?"success":"error"}`,children:D}),e.jsx("button",{type:"submit",className:"upload-btn",disabled:T,children:T?"Uploading...":"Upload Video"})]})]})}):e.jsxs("div",{className:`container ${t?"":" large-container"}`,style:{textAlign:"center",paddingTop:"5rem"},children:[e.jsx("h2",{children:"Please Log In to Upload"}),e.jsx("p",{children:"You must sign in with Google to upload videos."}),e.jsx("button",{className:"sign-in-btn",onClick:async()=>{try{const w=await fetch("https://screenmerch.fly.dev/api/auth/google/login",{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!w.ok)throw new Error("Failed to initiate Google login");const c=await w.json();if(c.success&&c.auth_url)window.location.href=c.auth_url;else throw new Error(c.error||"Failed to get Google login URL")}catch(w){console.error("Google login error:",w),alert("Login failed: "+w.message)}},children:"Sign In with Google"})]})},Wl=()=>{const{username:t}=Bt(),s=je(),[r,a]=l.useState(null),[n,i]=l.useState([]),[o,d]=l.useState(!0),[x,y]=l.useState(null),[m,v]=l.useState(null);return l.useEffect(()=>{t&&(async()=>{d(!0),y(null);const{data:g,error:_}=await M.from("users").select("*").eq("username",t).single();if(_||!g){y("User not found"),d(!1);return}a(g);const{data:k}=await M.from("videos2").select("*").eq("channelTitle",g.display_name||g.username).order("created_at",{ascending:!1});i(k||[]),d(!1)})()},[t]),l.useEffect(()=>{(async()=>{const{data:{user:g}}=await M.auth.getUser();if(g){const{data:_}=await M.from("users").select("role").eq("id",g.id).single();v({...g,..._})}else v(null)})()},[]),m&&m.role!=="creator"?e.jsx(ha,{to:"/",replace:!0}):o?e.jsx("div",{className:"profile-page",children:e.jsx("div",{children:"Loading profile..."})}):x?e.jsx("div",{className:"profile-page",children:e.jsx("div",{children:x})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"channel-header",children:e.jsxs("div",{className:"channel-cover-container",children:[e.jsx("div",{className:"cover-image-container",children:e.jsx("img",{className:"channel-cover-photo",src:r.cover_image_url||"https://images.unsplash.com/photo-1557683316-973673baf926?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80",alt:"Channel Cover"})}),e.jsxs("div",{className:"channel-info-overlay",children:[e.jsx("div",{className:"channel-avatar-container",children:e.jsx("img",{className:"channel-avatar",src:r.profile_image_url||"/default-avatar.jpg",alt:"Channel Avatar"})}),e.jsxs("div",{className:"channel-details",children:[e.jsx("h1",{className:"channel-name",children:r.display_name||r.username}),e.jsxs("p",{className:"channel-username",children:["@",r.username]}),r.bio&&e.jsx("p",{className:"channel-bio",children:r.bio})]})]})]})}),e.jsxs("div",{className:"profile-page",children:[e.jsx("div",{className:"profile-tabs",children:e.jsx("span",{className:"active",children:"Videos"})}),e.jsx("div",{className:"profile-videos",children:n.length===0?e.jsx("div",{children:"No videos yet."}):e.jsx("div",{className:"profile-video-grid",children:n.map(u=>e.jsxs("div",{className:"profile-video-card",style:{cursor:"pointer"},onClick:()=>{console.log("Clicked video:",u),s(`/video/${u.categoryId||0}/${u.id}`)},children:[e.jsx("img",{src:u.thumbnail||"https://via.placeholder.com/320x180?text=No+Thumbnail",alt:u.title}),e.jsx("h3",{children:u.title}),e.jsx("p",{children:u.description})]},u.id))})})]})]})},$l=()=>{const[t]=ct(),[s,r]=l.useState("verifying"),[a,n]=l.useState("");l.useEffect(()=>{const o=t.get("email"),d=t.get("token");if(!o||!d){r("error");return}n(o),setTimeout(()=>{r("success")},2e3)},[t]);const i=()=>{switch(s){case"verifying":return e.jsxs("div",{className:"approval-content",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("h2",{children:"Verifying your subscription..."}),e.jsx("p",{children:"Please wait while we process your request."})]});case"success":return e.jsxs("div",{className:"approval-content success",children:[e.jsx("div",{className:"success-icon",children:"✓"}),e.jsx("h2",{children:"Subscription Approved!"}),e.jsxs("p",{children:["Welcome to ScreenMerch, ",e.jsx("strong",{children:a}),"!"]}),e.jsx("p",{children:"Your subscription has been successfully activated. You can now enjoy all our premium features."}),e.jsx(Pe,{to:"/",className:"home-btn",children:"Go to Home"})]});case"error":return e.jsxs("div",{className:"approval-content error",children:[e.jsx("div",{className:"error-icon",children:"✗"}),e.jsx("h2",{children:"Invalid Link"}),e.jsx("p",{children:"This approval link is invalid or has expired."}),e.jsx("p",{children:"Please try subscribing again or contact support if you continue to have issues."}),e.jsx(Pe,{to:"/",className:"home-btn",children:"Go to Home"})]});default:return null}};return e.jsx("div",{className:"approval-page",children:e.jsxs("div",{className:"approval-container",children:[e.jsx("div",{className:"logo-section",children:e.jsx("h1",{children:"ScreenMerch"})}),i()]})})};class $t{static async getCurrentUserSubscription(){try{const{data:{user:s}}=await M.auth.getUser();if(!s)return null;const{data:r,error:a}=await M.from("user_subscriptions").select("*").eq("user_id",s.id).single();if(a&&a.code!=="PGRST116")throw a;return r||{tier:"free",status:"active"}}catch(s){return console.error("Error fetching subscription:",s),{tier:"free",status:"active"}}}static async subscribeToFreeTier(){try{const{data:{user:s}}=await M.auth.getUser();if(!s)throw new Error("User not authenticated");const{data:r,error:a}=await M.from("user_subscriptions").upsert({user_id:s.id,tier:"free",status:"active",updated_at:new Date().toISOString()},{onConflict:"user_id"}).select().single();if(a)throw a;return{success:!0,subscription:r}}catch(s){return console.error("Error subscribing to free tier:",s),{success:!1,error:s.message}}}static async subscribeToProTier(){try{const{data:{user:s}}=await M.auth.getUser();return s?(window.location.href="/payment-setup",{success:!0,redirecting:!0}):(window.location.href="/payment-setup?flow=new_user",{success:!0,redirecting:!0})}catch(s){return console.error("Error starting PayPal setup flow:",s),{success:!1,error:s.message}}}static async hasMinimumTier(s){try{const r=await this.getCurrentUserSubscription(),a={free:0,pro:1},n=a[(r==null?void 0:r.tier)||"free"],i=a[s];return n>=i}catch(r){return console.error("Error checking tier requirement:",r),!1}}static getTierConfig(s){const r={free:{name:"Free Trial",price:"Free",serviceFee:.3,features:["Upload videos (up to 100MB, 10 minutes)","Basic analytics","Standard features","Community access","Grab screenshots","Preview merch","Buy merchandise","7-day free trial period"],maxUploadSize:"100MB",maxVideoLength:"10 minutes"},pro:{name:"Free Plan",price:"Free",serviceFee:.3,trialDays:0,features:["Everything in Free Trial","Priority support","Custom branding","Enhanced upload limits (2GB, 60 minutes)","Ad-free experience","Early access to new features","Monetization tools","Revenue tracking","Custom channel colors","Branded merchandise","Advanced analytics"],maxUploadSize:"2GB",maxVideoLength:"60 minutes"}};return r[s]||r.free}static async isInTrialPeriod(){try{const s=await this.getCurrentUserSubscription();if(!s||s.tier!=="pro"||!s.trial_end)return!1;const r=new Date(s.trial_end);return new Date<r}catch(s){return console.error("Error checking trial period:",s),!1}}static async getTrialDaysRemaining(){try{const s=await this.getCurrentUserSubscription();if(!s||s.tier!=="pro"||!s.trial_end)return 0;const n=new Date(s.trial_end)-new Date,i=Math.ceil(n/(1e3*60*60*24));return Math.max(0,i)}catch(s){return console.error("Error getting trial days remaining:",s),0}}static async activateProSubscription(s,r){try{const a=localStorage.getItem("user_authenticated")==="true",n=localStorage.getItem("user_email");if(!a||!n)throw new Error("User not authenticated");console.log("🔍 User authenticated via localStorage:",n),console.log("🔍 Ensuring user exists in database...");const i=await fetch("https://screenmerch.fly.dev/api/users/ensure-exists",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,display_name:n.split("@")[0]})});if(!i.ok)throw console.error("❌ Failed to ensure user exists:",await i.text()),new Error("Failed to ensure user exists in database");const o=await i.json();console.log("✅ User ensured in database:",o);const d=o.user.id;console.log("✅ Using user ID from ensure-exists response:",d);const x=new Date;x.setDate(x.getDate()+7);const y=await fetch("https://screenmerch.fly.dev/api/subscriptions/activate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:d,tier:"pro",status:"active",stripe_subscription_id:s,stripe_customer_id:r,trial_end:x.toISOString()})});if(!y.ok)throw console.error("❌ Failed to activate subscription:",await y.text()),new Error("Failed to activate subscription in database");const m=await y.json();console.log("✅ Subscription activated:",m);try{const v=n.split("@")[0].toLowerCase().replace(/[^a-z0-9]/g,""),u=`https://screenmerch.com/channel/${v}`,g=await fetch("https://screenmerch.fly.dev/api/users/update-channel",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:d,channel_slug:v,channel_url:u})});g.ok?console.log("✅ Channel URL generated:",u):console.error("Error updating channel URL:",await g.text())}catch(v){console.error("Error generating channel URL:",v)}return{success:!0,subscription:m.subscription||m}}catch(a){return console.error("Error activating pro subscription:",a),{success:!1,error:a.message}}}static async sendWelcomeEmail(s){try{return await(await fetch("https://screenmerch.fly.dev/api/send-welcome-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s})})).json()}catch(r){throw console.error("Error sending welcome email:",r),r}}}class ke{static async isAdmin(){try{const{data:{user:s}}=await M.auth.getUser();if(!s)return!1;const{data:r,error:a}=await M.from("users").select("is_admin").eq("id",s.id).single();return a?(console.error("Error checking admin status:",a),!1):(r==null?void 0:r.is_admin)||!1}catch(s){return console.error("Error in isAdmin:",s),!1}}static async getDashboardStats(){try{const{data:s,error:r}=await M.from("admin_dashboard_stats").select("*").single();if(r)throw r;return s}catch(s){return console.error("Error fetching dashboard stats:",s),{total_users:0,active_users:0,suspended_users:0,total_videos:0,pending_videos:0,approved_videos:0,total_subscriptions:0,active_subscriptions:0,premium_subscriptions:0,creator_network_subscriptions:0}}}static async getUsers(s=0,r=20,a="",n="all"){try{let i=M.from("users").select("*",{count:"exact"});a&&(i=i.or(`display_name.ilike.%${a}%,email.ilike.%${a}%`)),n!=="all"&&(i=i.eq("status",n));const{data:o,error:d,count:x}=await i.order("created_at",{ascending:!1}).range(s*r,(s+1)*r-1);if(d)throw d;return{users:o||[],total:x||0,page:s,limit:r,totalPages:Math.ceil((x||0)/r)}}catch(i){return console.error("Error fetching users:",i),{users:[],total:0,page:s,limit:r,totalPages:0}}}static async getVideos(s=0,r=20,a="",n="all"){try{let i=M.from("videos2").select("*, users(display_name, email)",{count:"exact"});a&&(i=i.or(`title.ilike.%${a}%,description.ilike.%${a}%`)),n!=="all"&&(i=i.eq("verification_status",n));const{data:o,error:d,count:x}=await i.order("created_at",{ascending:!1}).range(s*r,(s+1)*r-1);if(d)throw d;return{videos:o||[],total:x||0,page:s,limit:r,totalPages:Math.ceil((x||0)/r)}}catch(i){return console.error("Error fetching videos:",i),{videos:[],total:0,page:s,limit:r,totalPages:0}}}static async getSubscriptions(){try{const{data:s,error:r}=await M.from("user_subscriptions").select("*, users(display_name, email)").order("created_at",{ascending:!1});if(r)throw r;return s||[]}catch(s){return console.error("Error fetching subscriptions:",s),[]}}static async updateUserStatus(s,r){try{console.log(`Updating user ${s} status to ${r}`);const{data:{user:a}}=await M.auth.getUser();if(!a)return{success:!1,error:"Not authenticated"};const{data:n,error:i}=await M.from("users").update({status:r}).eq("id",s).select().single();if(i)throw console.error("Database update error:",i),i;return console.log("Database update successful:",n),await this.logAdminAction("update_user_status","user",s,{new_status:r,target_user_id:s}),{success:!0,data:n}}catch(a){return console.error("Error updating user status:",a),{success:!1,error:a.message}}}static async deleteUser(s){try{const r=await fetch(`${ve.SUBSCRIPTION_API_URL}/api/users/${s}/delete-account`,{method:"DELETE",headers:{"Content-Type":"application/json"}});return r.ok?(await this.logAdminAction("delete_user","user",s,{target_user_id:s}),{success:!0}):{success:!1,error:(await r.json()).error||"Failed to delete user"}}catch(r){return console.error("Error deleting user:",r),{success:!1,error:r.message}}}static async updateVideoStatus(s,r){try{const{data:a,error:n}=await M.from("videos2").update({verification_status:r}).eq("id",s).select().single();if(n)throw n;return await this.logAdminAction("update_video_status","video",s,{new_status:r,target_video_id:s}),{success:!0,data:a}}catch(a){return console.error("Error updating video status:",a),{success:!1,error:a.message}}}static async deleteVideo(s){try{const{data:r,error:a}=await M.from("videos2").select("*").eq("id",s).single();if(a)throw a;const{error:n}=await M.from("videos2").delete().eq("id",s);if(n)throw n;if(r&&r.video_url&&!r.video_url.includes("youtube.com"))try{const i=r.video_url.split("/storage/v1/object/public/")[1];i&&await M.storage.from("videos2").remove([i])}catch(i){console.warn("Could not delete video file from storage:",i)}if(r&&r.thumbnail&&!r.thumbnail.includes("ytimg.com"))try{const i=r.thumbnail.split("/storage/v1/object/public/")[1];i&&await M.storage.from("thumbnails").remove([i])}catch(i){console.warn("Could not delete thumbnail from storage:",i)}return await this.logAdminAction("delete_video","video",s,{target_video_id:s}),{success:!0}}catch(r){return console.error("Error deleting video:",r),{success:!1,error:r.message}}}static async getAdminSettings(){try{const{data:s,error:r}=await M.from("admin_settings").select("*").order("setting_key");if(r)throw r;const a={};return s.forEach(n=>{a[n.setting_key]=n.setting_value}),a}catch(s){return console.error("Error fetching admin settings:",s),{}}}static async updateAdminSetting(s,r){try{const{data:{user:a}}=await M.auth.getUser();if(!a)return{success:!1,error:"Not authenticated"};const{data:n,error:i}=await M.rpc("update_admin_setting",{p_setting_key:s,p_setting_value:r,p_admin_user_id:a.id});if(i)throw i;return{success:!0,data:n}}catch(a){return console.error("Error updating admin setting:",a),{success:!1,error:a.message}}}static async getAdminLogs(s=0,r=50){try{const{data:a,error:n,count:i}=await M.from("admin_logs").select("*, admin_user:users(display_name, email)",{count:"exact"}).order("created_at",{ascending:!1}).range(s*r,(s+1)*r-1);if(n)throw n;return{logs:a||[],total:i||0,page:s,limit:r,totalPages:Math.ceil((i||0)/r)}}catch(a){return console.error("Error fetching admin logs:",a),{logs:[],total:0,page:s,limit:r,totalPages:0}}}static async logAdminAction(s,r,a=null,n=null){try{const{data:{user:i}}=await M.auth.getUser();if(!i)return;await M.rpc("log_admin_action",{p_admin_user_id:i.id,p_action_type:s,p_target_type:r,p_target_id:a,p_details:n})}catch(i){console.error("Error logging admin action:",i)}}static async getRecentActivity(s=10){try{const{data:r,error:a}=await M.from("admin_logs").select("*, admin_user:users(display_name, email)").order("created_at",{ascending:!1}).limit(s);if(a)throw a;return r||[]}catch(r){return console.error("Error fetching recent activity:",r),[]}}}const Bl=({sidebar:t})=>{var h,f,C;const[s,r]=l.useState(null),[a,n]=l.useState(null),[i,o]=l.useState(null),[d,x]=l.useState([]),[y,m]=l.useState(!0),[v,u]=l.useState(!1),[g,_]=l.useState({display_name:"",bio:"",cover_image_url:"",profile_image_url:""}),[k,T]=l.useState(!1),[W,D]=l.useState({cover:null,profile:null}),[$,E]=l.useState(!1),[R,U]=l.useState(!1),[H,se]=l.useState("videos"),[Q,le]=l.useState(null),B=je();l.useEffect(()=>{(async()=>{try{const{data:{user:P},error:Y}=await M.auth.getUser();if(!P){B("/");return}r(P);const{data:b,error:F}=await M.from("users").select("*").eq("id",P.id).single();b&&(n(b),_({display_name:b.display_name||"",bio:b.bio||"",cover_image_url:b.cover_image_url||"",profile_image_url:b.profile_image_url||""}));const q=await $t.getCurrentUserSubscription();o(q);const{data:re,error:Se}=await M.from("videos2").select("*").eq("user_id",P.id).order("created_at",{ascending:!1});re&&x(re)}catch(P){console.error("Error fetching data:",P),B("/")}finally{m(!1)}})()},[B]),l.useEffect(()=>{(async()=>{const{data:{user:P}}=await M.auth.getUser();if(P){const{data:Y}=await M.from("users").select("role").eq("id",P.id).single();le({...P,...Y})}else le(null)})()},[]);const ae=async(p,P)=>{try{T(!0);const Y=p.name.split(".").pop(),b=`${s.id}/${P}-${Date.now()}.${Y}`,{data:F,error:q}=await M.storage.from("profile-images").upload(b,p,{cacheControl:"3600",upsert:!0});if(q)return console.error("Error uploading image:",q),alert("Failed to upload image. Please try again."),null;const{data:{publicUrl:re}}=M.storage.from("profile-images").getPublicUrl(b);return re}catch(Y){return console.error("Error in uploadImageToSupabase:",Y),alert("Failed to upload image. Please try again."),null}finally{T(!1)}},w=async(p,P)=>{if(!p.type.startsWith("image/")){alert("Please select a valid image file.");return}if(p.size>5*1024*1024){alert("File size must be less than 5MB.");return}const Y=new FileReader;Y.onload=F=>{D(q=>({...q,[P]:F.target.result}))},Y.readAsDataURL(p);const b=await ae(p,P);b&&_(F=>({...F,[`${P}_image_url`]:b}))},c=async()=>{try{const{data:p,error:P}=await M.from("users").update({display_name:g.display_name,bio:g.bio,cover_image_url:g.cover_image_url,profile_image_url:g.profile_image_url,updated_at:new Date().toISOString()}).eq("id",s.id);P?console.error("Error updating profile:",P):(n({...a,...g}),u(!1),D({cover:null,profile:null}))}catch(p){console.error("Error saving profile:",p)}},j=async(p,P,Y)=>{if(Y.stopPropagation(),!!window.confirm(`Are you sure you want to delete "${P}"? This action cannot be undone.`))try{const F=await ke.deleteVideo(p);F.success?(x(q=>q.filter(re=>re.id!==p)),alert("Video deleted successfully!")):alert(`Failed to delete video: ${F.error}`)}catch(F){console.error("Error deleting video:",F),alert("Failed to delete video. Please try again.")}};return Q&&(!Q.role||Q.role!=="creator")?(console.log("User role issue:",Q.role,"User:",Q),e.jsxs("div",{className:"dashboard-error",children:["Access denied. Only creators can view this page.",e.jsx("br",{}),e.jsx("button",{onClick:async()=>{var p,P,Y;try{console.log("Fixing role for user:",Q.id);const{data:b,error:F}=await M.from("users").select("*").eq("id",Q.id).single();if(F&&F.code==="PGRST116"){console.log("User not found, creating new user record");const{data:q,error:re}=await M.from("users").upsert({id:Q.id,email:Q.email,username:((p=Q.email)==null?void 0:p.split("@")[0])||"user",display_name:((P=Q.user_metadata)==null?void 0:P.name)||((Y=Q.email)==null?void 0:Y.split("@")[0])||"User",role:"creator",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{onConflict:"id",ignoreDuplicates:!1}).select();if(re)if(console.error("Error creating user:",re),re.message.includes("duplicate key")){console.log("Duplicate key detected, updating existing user");const{data:Se,error:Te}=await M.from("users").update({role:"creator",updated_at:new Date().toISOString()}).eq("id",Q.id).select();Te?(console.error("Error updating user:",Te),alert("Failed to update user: "+Te.message)):(console.log("User updated successfully:",Se),alert("User updated! Reloading page..."),window.location.reload())}else alert("Failed to create user: "+re.message);else console.log("User created successfully:",q),alert("User created! Reloading page..."),window.location.reload()}else if(b){const{data:q,error:re}=await M.from("users").update({role:"creator"}).eq("id",Q.id).select();re?(console.error("Error updating role:",re),alert("Failed to update role: "+re.message)):(console.log("Role updated successfully:",q),alert("Role updated! Reloading page..."),window.location.reload())}else console.error("Unexpected error checking user:",F),alert("Error checking user: "+F.message)}catch(b){console.error("Error in role fix:",b),alert("Error fixing role: "+b.message)}},style:{marginTop:"10px",padding:"8px 16px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Fix Role & Reload"})]})):y?e.jsx("div",{className:"dashboard-loading",children:"Loading your dashboard..."}):s?e.jsxs("div",{className:`dashboard-container ${t?"":" large-container"}`,children:[e.jsx("div",{className:"channel-header",children:e.jsxs("div",{className:"channel-cover-container",children:[$?e.jsxs("div",{className:"edit-cover-section",children:[e.jsx("div",{className:"cover-edit-backdrop",onClick:()=>{E(!1),D(p=>({...p,cover:null}))}}),e.jsx("div",{className:"cover-edit-overlay",onClick:p=>p.stopPropagation(),children:e.jsxs("div",{className:"cover-edit-controls",children:[e.jsx("button",{className:"cover-edit-close-btn",onClick:()=>{E(!1),D(p=>({...p,cover:null}))},title:"Close",children:"×"}),e.jsx("h3",{children:"📸 Update Cover Image"}),e.jsxs("div",{className:"file-upload-section",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:p=>p.target.files[0]&&w(p.target.files[0],"cover"),id:"cover-upload",className:"file-input",disabled:k}),e.jsx("label",{htmlFor:"cover-upload",className:"file-upload-btn",children:k?"⏳ Uploading...":"📁 Choose Cover Image"})]}),e.jsx("p",{className:"edit-tip",children:"💡 Tip: Max 5MB, high-quality image (1920x1080 recommended)"})]})}),(W.cover||g.cover_image_url)&&e.jsx("img",{src:W.cover||g.cover_image_url||(a==null?void 0:a.cover_image_url)||"https://images.unsplash.com/photo-1557683316-973673baf926?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80",alt:"Cover preview",className:"channel-cover-photo"})]}):e.jsxs("div",{className:"cover-image-container",children:[e.jsx("img",{className:"channel-cover-photo",src:g.cover_image_url||(a==null?void 0:a.cover_image_url)||"https://images.unsplash.com/photo-1557683316-973673baf926?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80",alt:"Channel Cover"}),e.jsx("button",{className:"corner-edit-icon cover-edit",onClick:()=>E(!0),title:"Edit cover image",children:"✏️"})]}),e.jsxs("div",{className:"channel-info-overlay",children:[e.jsx("div",{className:"channel-avatar-container",children:R?e.jsxs("div",{className:"edit-avatar-section",children:[e.jsx("img",{className:"channel-avatar editing",src:W.profile||g.profile_image_url||(a==null?void 0:a.profile_image_url)||((h=s.user_metadata)==null?void 0:h.picture)||"/default-avatar.jpg",alt:"Channel Avatar"}),e.jsxs("div",{className:"avatar-upload-section",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:p=>p.target.files[0]&&w(p.target.files[0],"profile"),id:"avatar-upload",className:"file-input",disabled:k}),e.jsx("label",{htmlFor:"avatar-upload",className:"avatar-upload-btn",children:k?"⏳ Uploading...":"📷 Change Avatar"})]})]}):e.jsxs("div",{className:"avatar-with-edit",children:[e.jsx("img",{className:"channel-avatar",src:(a==null?void 0:a.profile_image_url)||((f=s.user_metadata)==null?void 0:f.picture)||"/default-avatar.jpg",alt:"Channel Avatar"}),e.jsx("button",{className:"corner-edit-icon avatar-edit",onClick:()=>U(!0),title:"Edit avatar",children:"✏️"})]})}),e.jsx("div",{className:"channel-details",children:v?e.jsxs("div",{className:"edit-details-section",children:[e.jsx("input",{type:"text",placeholder:"Display name",value:g.display_name,onChange:p=>_({...g,display_name:p.target.value}),className:"edit-input edit-title"}),e.jsx("textarea",{placeholder:"Bio/Description",value:g.bio,onChange:p=>_({...g,bio:p.target.value}),className:"edit-textarea",rows:"2"})]}):e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"channel-name",children:(a==null?void 0:a.display_name)||((C=s.user_metadata)==null?void 0:C.name)||"Your Channel"}),e.jsxs("p",{className:"channel-username",children:["@",(a==null?void 0:a.username)||"username"]}),(a==null?void 0:a.bio)&&e.jsx("p",{className:"channel-bio",children:a.bio})]})}),e.jsx("div",{className:"edit-controls",children:v?e.jsxs("div",{className:"edit-buttons",children:[e.jsx("button",{onClick:c,className:"save-btn",children:"Save Changes"}),e.jsx("button",{onClick:()=>u(!1),className:"cancel-btn",children:"Cancel"})]}):null})]})]})}),e.jsx("div",{className:"dashboard-tabs",children:e.jsxs("button",{className:`tab-button ${H==="videos"?"active":""}`,onClick:()=>se("videos"),children:["📹 Videos (",d.length,")"]})}),e.jsxs("div",{className:"tab-content",children:[H==="videos"&&e.jsxs("div",{className:"videos-tab",children:[e.jsxs("div",{className:"getting-started-section",children:[e.jsx("h2",{children:"Getting Started"}),e.jsxs("div",{className:"tips-grid",children:[e.jsxs("div",{className:"tip-card",children:[e.jsx("h4",{children:"🎨 Customize Your Channel"}),e.jsx("p",{children:"Add a cover image, profile picture, and bio to make your channel unique."})]}),e.jsxs("div",{className:"tip-card clickable",onClick:()=>B("/upload"),children:[e.jsx("h4",{children:"📹 Upload Content"}),e.jsx("p",{children:"Start sharing your videos and build your audience."}),e.jsx("div",{className:"card-action",children:"Click to upload →"})]}),e.jsxs("div",{className:"tip-card",children:[e.jsx("h4",{children:"📊 Check Your Analytics"}),e.jsx("p",{children:"Monitor your sales and track your performance."})]})]})]}),e.jsxs("div",{className:"user-videos-section",children:[e.jsx("div",{className:"section-header",children:e.jsxs("h2",{children:["Your Videos (",d.length,")"]})}),d.length>0?e.jsx("div",{className:"dashboard-video-grid",children:d.map(p=>e.jsxs("div",{className:"dashboard-video-card",onClick:()=>B(`/video/${p.categoryId||0}/${p.id}`),children:[e.jsx("img",{src:p.thumbnail,alt:p.title,className:"dashboard-video-thumbnail"}),e.jsxs("div",{className:"dashboard-video-info",children:[e.jsx("h4",{children:p.title}),e.jsx("p",{children:new Date(p.created_at).toLocaleDateString()}),e.jsx("span",{className:"video-views",children:"0 views"})]}),e.jsx("button",{className:"delete-video-btn",onClick:P=>j(p.id,p.title,P),title:"Delete Video",children:"🗑️"})]},p.id))}):e.jsx("div",{className:"no-videos-placeholder",children:e.jsxs("div",{className:"placeholder-content",children:[e.jsx("h3",{children:"No videos yet"}),e.jsx("p",{children:"Start building your content library by uploading your first video!"})]})})]})]}),!1]})]}):e.jsx("div",{className:"dashboard-error",children:"Please log in to see your dashboard."})},Hl=()=>{const t=je();wt();const s={totalRevenue:56388,monthlyRevenue:4699,totalProductsSold:2600,monthlyProductsSold:217,averageProductPrice:21.69,productOverheadCost:11.69,houseCommission:3,yourProfitPerItem:7},a=(()=>{const k=s.totalProductsSold*(s.averageProductPrice-s.productOverheadCost),T=s.totalProductsSold*s.houseCommission,W=k-T;return{grossEarnings:Math.round(k),netEarnings:Math.round(W)}})(),[n,i]=l.useState(null),[o,d]=l.useState(null),[x,y]=l.useState(!0),[m,v]=l.useState(!1),[u,g]=l.useState("");l.useEffect(()=>{(async()=>{try{const{data:{user:T}}=await M.auth.getUser();if(i(T),T){const W=await $t.getCurrentUserSubscription();d(W)}}catch(T){console.error("Error fetching user data:",T)}finally{y(!1)}})()},[]);const _=async()=>{v(!0),g("");try{if(!n){g("Redirecting to PayPal setup..."),setTimeout(()=>{t("/payment-setup?flow=new_user")},1500);return}const k=await $t.subscribeToProTier();k.success?g("Redirecting to PayPal setup..."):g(k.error||"An error occurred. Please try again.")}catch(k){console.error("Error starting PayPal setup:",k),g("An error occurred. Please try again.")}finally{v(!1)}};return x?e.jsx("div",{className:"subscription-tiers",children:e.jsx("div",{className:"loading",children:"Loading..."})}):e.jsxs("div",{className:"subscription-tiers",children:[e.jsxs("div",{className:"tiers-header",children:[e.jsx("h1",{children:"💰 Creator Earnings Calculator"}),e.jsx("p",{children:"See how much you could earn with ScreenMerch's completely free merch system - No monthly fees!"})]}),u&&e.jsx("div",{className:`message ${u.includes("error")||u.includes("Failed")?"error":"success"}`,children:u}),e.jsxs("div",{className:"performance-metrics",children:[e.jsxs("div",{className:"metrics-header",children:[e.jsx("h3",{children:"📊 Example Creator Performance"}),e.jsx("p",{children:"Based on successful creators with engaged audiences"})]}),e.jsxs("div",{className:"metrics-grid",children:[e.jsxs("div",{className:"metric-card",children:[e.jsxs("div",{className:"metric-value",children:["$",s.totalRevenue.toLocaleString()]}),e.jsx("div",{className:"metric-label",children:"Total Revenue (Annual)"})]}),e.jsxs("div",{className:"metric-card",children:[e.jsxs("div",{className:"metric-value",children:["$",s.monthlyRevenue.toLocaleString()]}),e.jsx("div",{className:"metric-label",children:"Monthly Revenue"})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-value",children:s.totalProductsSold.toLocaleString()}),e.jsx("div",{className:"metric-label",children:"Products Sold (Annual)"})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-value",children:s.monthlyProductsSold}),e.jsx("div",{className:"metric-label",children:"Monthly Products Sold"})]})]})]}),e.jsxs("div",{className:"tier-calculator-section",children:[e.jsxs("div",{className:"calculator-header",children:[e.jsx("h4",{children:"🎯 ScreenMerch Free Plan"}),e.jsx("p",{children:"It's completely free to use ScreenMerch! No monthly fees, no recurring charges. You earn 70% of all sales, 30% house commission."}),e.jsx("div",{className:"pricing-note",children:e.jsx("small",{children:"💡 Based on actual product overhead costs and 30% house commission structure"})})]}),e.jsxs("div",{className:"tier-comparison-grid",children:[e.jsxs("div",{className:"tier-card current",children:[e.jsxs("div",{className:"tier-header",children:[e.jsx("h5",{children:"🎯 Free Plan"}),e.jsx("span",{className:"tier-fee",children:"30% House Commission"})]}),e.jsxs("div",{className:"tier-revenue",children:[e.jsxs("span",{className:"revenue-amount",children:["$",a.netEarnings.toLocaleString()]}),e.jsx("span",{className:"revenue-label",children:"You Keep (70% of Sales)"})]}),e.jsxs("div",{className:"tier-cost",children:[e.jsx("span",{className:"cost-amount",children:"Free"}),e.jsx("span",{className:"cost-label",children:"Always Free"})]}),e.jsxs("div",{className:"tier-savings",children:[e.jsxs("span",{className:"savings-amount",children:["$",a.netEarnings.toLocaleString()]}),e.jsx("span",{className:"savings-label",children:"Net Annual Earnings 💰"})]})]}),e.jsxs("div",{className:"tier-card breakdown-card",children:[e.jsxs("div",{className:"tier-header",children:[e.jsx("h5",{children:"💰 Per Item Example"}),e.jsx("span",{className:"tier-fee",children:"$21.69 T-Shirt"})]}),e.jsxs("div",{className:"item-breakdown-container",children:[e.jsxs("div",{className:"product-visual",children:[e.jsx("img",{src:"/calculatorimage.png",alt:"Calculator Example",className:"product-image"}),e.jsx("p",{className:"product-caption",children:"Just one T-Shirt 50 sales a week!"})]}),e.jsxs("div",{className:"item-breakdown",children:[e.jsxs("div",{className:"breakdown-row",children:[e.jsx("span",{className:"breakdown-label",children:"Your Selling Price:"}),e.jsxs("span",{className:"breakdown-value",children:["$",s.averageProductPrice]})]}),e.jsxs("div",{className:"breakdown-row",children:[e.jsx("span",{className:"breakdown-label",children:"Product Overhead:"}),e.jsxs("span",{className:"breakdown-value cost",children:["-$",s.productOverheadCost]})]}),e.jsxs("div",{className:"breakdown-row",children:[e.jsx("span",{className:"breakdown-label",children:"House Commission (30%):"}),e.jsxs("span",{className:"breakdown-value cost",children:["-$",s.houseCommission]})]}),e.jsxs("div",{className:"breakdown-row final-profit",children:[e.jsx("span",{className:"breakdown-label",children:"Your Profit:"}),e.jsxs("span",{className:"breakdown-value profit",children:["$",s.yourProfitPerItem]})]})]})]})]})]}),e.jsx("div",{className:"calculator-footer",children:e.jsx("button",{className:"upgrade-btn",onClick:()=>_(),disabled:m,children:m?"Processing...":n?"🚀 Set Up PayPal & Start Earning":"🚀 Sign Up & Set Up PayPal"})}),e.jsxs("div",{className:"calculation-breakdown",children:[e.jsx("h5",{children:"📊 How We Calculate Your Earnings"}),e.jsxs("div",{className:"breakdown-grid",children:[e.jsxs("div",{className:"breakdown-item",children:[e.jsx("strong",{children:"Total Revenue:"})," $",s.totalRevenue.toLocaleString()]}),e.jsxs("div",{className:"breakdown-item",children:[e.jsx("strong",{children:"Product Overhead Costs:"})," $",(s.totalProductsSold*s.productOverheadCost).toLocaleString()]}),e.jsxs("div",{className:"breakdown-item",children:[e.jsx("strong",{children:"House Commission (30% of Gross Profit):"})," $",(s.totalProductsSold*s.houseCommission).toLocaleString()]}),e.jsxs("div",{className:"breakdown-item highlight creator-earnings",children:[e.jsx("strong",{children:"🎯 Your Total Net Earnings:"})," $",(s.totalProductsSold*s.yourProfitPerItem).toLocaleString()]})]}),e.jsx("div",{style:{textAlign:"center",marginTop:"20px",fontSize:"1.1rem",fontWeight:"600",color:"#1565c0"},children:"Just One T-Shirt 50 Sales a Week!"})]})]}),e.jsxs("div",{className:"value-proposition",children:[e.jsx("h3",{children:"🎯 Why Choose ScreenMerch?"}),e.jsxs("div",{className:"value-grid",children:[e.jsxs("div",{className:"value-item",children:[e.jsx("div",{className:"value-icon",children:"💰"}),e.jsx("h4",{children:"Great Rates"}),e.jsx("p",{children:"Keep 70% of your earnings with our competitive 30% service fee"})]}),e.jsxs("div",{className:"value-item",children:[e.jsx("div",{className:"value-icon",children:"📈"}),e.jsx("h4",{children:"Analytics"}),e.jsx("p",{children:"Track your sales, understand your audience, and optimize for growth"})]}),e.jsxs("div",{className:"value-item",children:[e.jsx("div",{className:"value-icon",children:"🎨"}),e.jsx("h4",{children:"Easy Setup"}),e.jsx("p",{children:"Simple and intuitive platform to create and sell your merchandise"})]}),e.jsxs("div",{className:"value-item",children:[e.jsx("div",{className:"value-icon",children:"🚀"}),e.jsx("h4",{children:"Completely Free"}),e.jsx("p",{children:"No monthly fees, no recurring charges, no hidden costs - just start earning immediately"})]})]})]})]})},Vl=()=>{const[t]=ct(),s=je(),[r,a]=l.useState(!0),[n,i]=l.useState(!1),[o,d]=l.useState(null),[x,y]=l.useState(!1),[m,v]=l.useState(null);return l.useEffect(()=>{window.scrollTo(0,0),(()=>{try{const _=JSON.parse(localStorage.getItem("processedSessions")||"[]");if(_.length>10){const k=_.slice(-10);localStorage.setItem("processedSessions",JSON.stringify(k)),console.log("🧹 Cleaned up old processed sessions")}}catch(_){console.error("Error cleaning up sessions:",_)}})(),(async()=>{const _=t.get("session_id"),k=localStorage.getItem("pendingSubscriptionSession"),T=JSON.parse(localStorage.getItem("processedSessions")||"[]"),W=parseInt(localStorage.getItem("loginAttempts")||"0");console.log("🔍 Session ID Debug:",{sessionIdFromURL:_,pendingSessionFromStorage:k,processedSessions:T,loginAttempts:W,searchParams:Object.fromEntries(t.entries())});const D=_||k;if(console.log("🎯 Session to use:",D),!D){console.log("📋 No session ID - checking if user is logged in for instructions");const{data:{user:E}}=await M.auth.getUser();if(E){console.log("✅ User is logged in, showing instructions"),v(E.email),i(!0),a(!1);return}else{console.error("❌ No session ID and user not logged in"),d("Please sign in to view your instructions and personal link"),a(!1);return}}if(T.includes(D)){console.log("⚠️ Session already processed, redirecting to dashboard"),i(!0);return}if(W>=3){console.error("❌ Too many login attempts, showing error"),d("Unable to verify subscription. Please contact support."),localStorage.removeItem("loginAttempts"),a(!1);return}_&&!k&&(localStorage.setItem("pendingSubscriptionSession",_),console.log("💾 Stored session ID from URL:",_)),localStorage.getItem("justLoggedIn")&&(console.log("🔄 User just logged in, waiting for auth state to settle..."),localStorage.removeItem("justLoggedIn"),await new Promise(E=>setTimeout(E,3e3)));try{let E=null,R=null,U=0;const H=3;for(;U<H;)try{const le=localStorage.getItem("user_authenticated")==="true",B=localStorage.getItem("user_email");if(le&&B)try{const ae=await fetch("https://screenmerch.fly.dev/api/users/ensure-exists",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:B,display_name:B.split("@")[0]})});if(ae.ok){const w=await ae.json();E={id:w.user.id,email:w.user.email},v(w.user.email),R=null,console.log("✅ User authenticated via localStorage:",B);break}else console.error("Error ensuring user exists:",await ae.text()),R="Failed to ensure user exists in database"}catch(ae){console.error("Error calling ensure-exists API:",ae),R="Failed to verify user in database"}else E=null,R="Not authenticated in localStorage",console.log(`❌ Auth attempt ${U+1} failed:`,R);U<H-1&&(console.log(`⏳ Auth not ready, retrying in ${1e3/1e3} seconds... (${U+1}/${H})`),await new Promise(w=>setTimeout(w,1e3))),U++}catch(le){console.error(`❌ Auth check error on attempt ${U+1}:`,le),U++,U<H&&await new Promise(B=>setTimeout(B,1e3))}if(R||!E){console.log("⚠️ User not authenticated after retries, redirecting to login...");const le=W+1;localStorage.setItem("loginAttempts",le.toString()),y(!0),a(!1),setTimeout(()=>{s("/login?returnTo=/subscription-success")},3e3);return}console.log("✅ User authenticated successfully:",E.email),localStorage.removeItem("loginAttempts"),k&&(localStorage.removeItem("pendingSubscriptionSession"),console.log("🧹 Cleared pending session from localStorage")),console.log("🔍 Verifying subscription with session:",D);const Q=await(await fetch(`${ve.ENDPOINTS.VERIFY_SUBSCRIPTION}/${D}`)).json();if(console.log("📡 Verification response:",Q),Q.success){const le=await $t.activateProSubscription(Q.subscription_id,Q.customer_id);if(le.success){const B=[...T,D];localStorage.setItem("processedSessions",JSON.stringify(B)),i(!0),localStorage.removeItem("pendingSubscriptionSession")}else d(le.error||"Failed to activate subscription")}else d(Q.message||"Payment verification failed")}catch(E){console.error("❌ Error verifying subscription:",E),d("Failed to verify payment")}finally{a(!1)}})()},[t,s]),r?e.jsx("div",{className:"subscription-success-page",children:e.jsxs("div",{className:"success-container",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("h2",{children:"Verifying your subscription..."}),e.jsx("p",{children:"Please wait while we confirm your payment."})]})}):x?e.jsx("div",{className:"subscription-success-page",children:e.jsxs("div",{className:"success-container",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("h2",{children:"Payment Successful! 🎉"}),e.jsx("p",{children:"Your payment has been processed successfully."}),e.jsx("p",{children:e.jsx("strong",{children:"Please sign in to complete your subscription activation."})}),e.jsx("p",{children:"You will be redirected to the login page in a few seconds..."}),e.jsx("button",{onClick:()=>s("/login?returnTo=/subscription-success"),className:"retry-btn",style:{marginTop:"20px"},children:"Sign In Now"})]})}):o?e.jsx("div",{className:"subscription-success-page",children:e.jsxs("div",{className:"success-container error",children:[e.jsx("div",{className:"error-icon",children:"❌"}),e.jsx("h2",{children:"Access Required"}),e.jsx("p",{children:o}),o.includes("sign in")?e.jsx("button",{onClick:()=>s("/login"),className:"retry-btn",children:"Sign In"}):e.jsx("button",{onClick:()=>s("/subscription-tiers"),className:"retry-btn",children:"Get Started"})]})}):e.jsx("div",{className:"subscription-success-page",children:e.jsxs("div",{className:"success-container",children:[e.jsx("div",{className:"success-icon",children:"🎉"}),e.jsxs("p",{className:"welcome-message",children:["🎉 ",e.jsx("strong",{children:"Welcome to ScreenMerch!"})," You're all set to start sharing amazing content and earning from your merchandise.",e.jsx("div",{className:"trial-notice-simple",children:"✅ Your account is ready to start earning!"})]}),e.jsxs("div",{className:"next-steps",children:[e.jsx("h3",{children:"🚀 Your Next Steps:"}),e.jsxs("ol",{children:[e.jsx("li",{children:e.jsx("strong",{children:"Go to dashboard"})}),e.jsx("li",{children:e.jsx("strong",{children:"Personalize your page and post content"})}),e.jsx("li",{children:e.jsx("strong",{children:"Promote with your personal link"})}),e.jsx("li",{children:e.jsx("strong",{children:"Track your sales in Analytics"})}),e.jsx("li",{children:e.jsx("strong",{children:"Start earning from your merch sales!"})})]}),e.jsx("p",{className:"monthly-payouts",children:"Monthly Payouts"})]}),e.jsxs("div",{className:"channel-link-section",children:[e.jsx("h3",{children:"🛍️ Your ScreenMerch Channel"}),e.jsx("p",{children:e.jsx("strong",{children:"Share this link with your audience to sell merch:"})}),e.jsxs("div",{className:"channel-link-container",children:[e.jsx("code",{className:"channel-link",children:m?`https://screenmerch.com/channel/${m.split("@")[0]}`:"https://screenmerch.com/channel/your-name"}),e.jsx("button",{onClick:()=>{const u=m?`https://screenmerch.com/channel/${m.split("@")[0]}`:"https://screenmerch.com/channel/your-name";navigator.clipboard.writeText(u),alert("Channel link copied to clipboard!")},className:"copy-link-btn",children:"📋 Copy Link"})]}),e.jsxs("p",{className:"channel-tip",children:["💡 ",e.jsx("strong",{children:"Pro Tip:"})," Add this link to your YouTube descriptions, social media bios, and website to start selling merch to your audience!"]})]}),e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{onClick:()=>s("/dashboard"),className:"dashboard-btn primary",children:"🚀 Go to Dashboard"}),e.jsx("button",{onClick:()=>s("/"),className:"dashboard-btn secondary",children:"🏠 Go to Homepage"})]})]})})},zl=()=>{const t=je(),[s,r]=l.useState(null);return l.useEffect(()=>{const a=localStorage.getItem("order_tracking");if(a)try{const i=JSON.parse(a);r(i),localStorage.removeItem("order_tracking")}catch(i){console.error("Error parsing tracking data:",i)}localStorage.removeItem("cart"),localStorage.removeItem("cart_items"),localStorage.removeItem("screenshots"),localStorage.removeItem("screenshot_timestamps"),localStorage.removeItem("pending_merch_data");const n=document.querySelector(".order-success-container");n&&(n.style.opacity="0",n.style.transform="translateY(20px)",setTimeout(()=>{n.style.transition="all 0.5s ease",n.style.opacity="1",n.style.transform="translateY(0)"},100))},[]),e.jsx("div",{className:"order-success-page",children:e.jsxs("div",{className:"order-success-container",children:[e.jsx("div",{className:"success-icon",children:"✅"}),e.jsx("h1",{className:"success-title",children:"Order Successful!"}),e.jsx("div",{className:"thank-you-message",children:e.jsx("p",{children:"Thank you for your order! Your custom merchandise is being created."})}),e.jsxs("div",{className:"next-steps",children:[e.jsx("h3",{children:"What happens next:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"✅ Your order is being processed automatically"}),e.jsx("li",{children:"✅ Products will be created and fulfilled by Printful"}),e.jsx("li",{children:"✅ You'll receive email updates with tracking information"}),e.jsx("li",{children:"✅ Your order will ship within 3-5 business days"})]})]}),s&&e.jsxs("div",{className:"order-details",children:[e.jsx("h3",{children:"📦 Order Details"}),e.jsxs("div",{className:"order-info",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Order ID:"})," ",s.order_id]}),s.tracking_url&&e.jsxs("p",{children:[e.jsx("strong",{children:"Track your order:"})," ",e.jsx("a",{href:s.tracking_url,target:"_blank",rel:"noopener noreferrer",children:"View Order Status →"})]})]})]}),e.jsx("div",{className:"support-info",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Need help?"})," Contact us at"," ",e.jsx("a",{href:"mailto:support@screenmerch.com",children:"support@screenmerch.com"})]})}),e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{onClick:()=>t("/"),className:"home-button",children:"Return to Home"}),e.jsx("button",{onClick:()=>t("/dashboard"),className:"dashboard-button",children:"Go to Dashboard"})]})]})})},Gl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA10lEQVR4nO3QPQrCQBQE4NVCbAVrsbEUC72Cnaews02TmRB4XsE72HkIQbG0tdFKRGuxE2ElkJCwaGJ+wCJ5MLDF7veSUao0Y9t2B8Dei3cuGu8DOJPUXgBcAQwLwUmOAdwDPLLkAWCS98unJJ8mHsmL5CyLXSM5j4HNLESk/pMsIg2SyxS49itbiUgzFgfQIrlOizNcsrMsq/2t7y7JQ1acYY6u6/ZMfADgUgCu/dwcxxlFqzkViOvgTz5WlRdWSfO3BSrjvWqBLmdFW/MRgE3We9WopHkDXTJU7bkaB10AAAAASUVORK5CYII=",ql=({sidebar:t,category:s,setCategory:r})=>{const[a,n]=l.useState(!0),[i,o]=l.useState([]),[d,x]=l.useState(!0);return l.useState("platform"),wt(),l.useEffect(()=>{(async()=>{x(!0);try{const{data:m,error:v}=await M.from("users").select(`
            id,
            username,
            display_name,
            profile_image_url,
            created_at
          `).not("username","is",null).order("created_at",{ascending:!1}).limit(10);if(v)console.error("Error fetching platform creators:",v),o([]);else{const u=m.filter(g=>g.username).map(g=>({id:g.id,username:g.username,name:g.display_name||g.username,avatar:g.profile_image_url,joinedAt:g.created_at,type:"platform"}));o(u)}}catch(m){console.error("Error fetching subscribers:",m),o([])}x(!1)})()},[]),e.jsxs("div",{className:`sidebar ${t?"":"small-sidebar"}`,children:[e.jsxs("div",{className:"shortcut-links",children:[e.jsxs(Pe,{to:"/",className:`side-link ${s===0?"active":""}`,onClick:()=>r(0),children:[e.jsx("img",{src:Gl,alt:""}),e.jsx("p",{children:"Home"})]}),e.jsx("hr",{})]}),e.jsxs("div",{className:"subscribed-list",children:[e.jsxs("h3",{style:{cursor:"pointer"},onClick:()=>n(y=>!y),children:["CREATORS ",a?"▲":"▼"]}),a&&e.jsx("div",{children:d?e.jsx("div",{className:"loading-subs",children:"Loading creators..."}):i.length===0?e.jsx("div",{className:"no-subs",children:"No creators yet."}):e.jsx("div",{className:"subscribers-list",children:i.map(y=>e.jsx("div",{className:"subscriber-item-container",children:e.jsxs(Pe,{to:`/profile/${y.username}`,className:"side-link subscriber-item",children:[e.jsx("img",{src:y.avatar||"/default-avatar.jpg",alt:y.name,className:"subscriber-avatar"}),e.jsx("div",{className:"subscriber-info",children:e.jsx("p",{className:"subscriber-name",children:y.name})})]})},y.id))})})]})]})},Jl=()=>{const t=je();return e.jsxs("div",{style:{minHeight:"60vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[e.jsx("h1",{style:{fontSize:"3rem",marginBottom:16},children:"🚧 Coming Soon!"}),e.jsx("p",{style:{fontSize:"1.2rem",color:"#555",marginBottom:32},children:"This category or feature is not available yet. Check back soon for updates!"}),e.jsx("button",{onClick:()=>t("/"),style:{padding:"12px 32px",fontSize:"1rem",borderRadius:8,background:"#222",color:"#fff",border:"none",cursor:"pointer"},children:"Back to Home"})]})},Zl=()=>{var j;const[t,s]=l.useState(null),[r,a]=l.useState(!0),[n,i]=l.useState(!1),[o,d]=l.useState("dashboard"),[x,y]=l.useState([]),[m,v]=l.useState([]),[u,g]=l.useState([]),[_,k]=l.useState({}),[T,W]=l.useState(""),[D,$]=l.useState("all"),E=je();l.useEffect(()=>{R()},[]);const R=async()=>{try{const{data:{user:h}}=await M.auth.getUser();if(!h){E("/");return}if(s(h),!await ke.isAdmin()){alert("Access denied. Admin privileges required."),E("/");return}i(!0),U()}catch(h){console.error("Error checking admin status:",h),E("/")}finally{a(!1)}},U=async()=>{await Promise.all([H(),se(),Q(),le()])},H=async()=>{try{const h=await ke.getUsers(0,100,T,D);console.log("Loaded users:",h.users),y(h.users)}catch(h){console.error("Error loading users:",h)}},se=async()=>{try{const h=await ke.getVideos(0,100,T,D);v(h.videos)}catch(h){console.error("Error loading videos:",h)}},Q=async()=>{try{const h=await ke.getSubscriptions();g(h)}catch(h){console.error("Error loading subscriptions:",h)}},le=async()=>{try{const h=await ke.getDashboardStats();k({totalUsers:h.total_users||0,totalVideos:h.total_videos||0,totalSubscriptions:h.total_subscriptions||0,pendingVideos:h.pending_videos||0,activeUsers:h.active_users||0,suspendedUsers:h.suspended_users||0})}catch(h){console.error("Error loading stats:",h)}},B=async(h,f)=>{if(confirm(`Are you sure you want to ${f} this user?`))try{let C;f==="delete"?C=await ke.deleteUser(h):f==="suspend"?(console.log(`Suspending user ${h}...`),C=await ke.updateUserStatus(h,"suspended"),console.log("Suspend result:",C)):f==="activate"&&(console.log(`Activating user ${h}...`),C=await ke.updateUserStatus(h,"active"),console.log("Activate result:",C)),C.success?(alert(`User ${f}d successfully`),console.log("Reloading users..."),await H(),console.log("Users reloaded")):alert(`Failed to ${f} user: ${C.error}`)}catch(C){console.error(`Error ${f}ing user:`,C),alert(`Failed to ${f} user`)}},ae=async(h,f)=>{if(confirm(`Are you sure you want to ${f} this video?`))try{let C;f==="delete"?C=await ke.deleteVideo(h):f==="approve"?C=await ke.updateVideoStatus(h,"approved"):f==="reject"&&(C=await ke.updateVideoStatus(h,"rejected")),C.success?(alert(`Video ${f}d successfully`),se()):alert(`Failed to ${f} video: ${C.error}`)}catch(C){console.error(`Error ${f}ing video:`,C),alert(`Failed to ${f} video`)}},w=x.filter(h=>{var p,P;const f=((p=h.display_name)==null?void 0:p.toLowerCase().includes(T.toLowerCase()))||((P=h.email)==null?void 0:P.toLowerCase().includes(T.toLowerCase())),C=D==="all"||h.status===D;return f&&C}),c=m.filter(h=>{var p,P;const f=((p=h.title)==null?void 0:p.toLowerCase().includes(T.toLowerCase()))||((P=h.description)==null?void 0:P.toLowerCase().includes(T.toLowerCase())),C=D==="all"||h.verification_status===D;return f&&C});return r?e.jsxs("div",{className:"admin-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Loading admin panel..."})]}):n?e.jsxs("div",{className:"admin-container",children:[e.jsxs("div",{className:"admin-header",children:[e.jsx("h1",{children:"Admin Portal"}),e.jsxs("div",{className:"admin-user-info",children:[e.jsxs("span",{children:["Welcome, ",((j=t==null?void 0:t.user_metadata)==null?void 0:j.name)||(t==null?void 0:t.email)]}),e.jsx("button",{onClick:()=>E("/"),className:"admin-logout-btn",children:"Back to Site"})]})]}),e.jsxs("div",{className:"admin-content",children:[e.jsxs("div",{className:"admin-sidebar",children:[e.jsx("button",{className:`admin-tab ${o==="dashboard"?"active":""}`,onClick:()=>d("dashboard"),children:"Dashboard"}),e.jsx("button",{className:`admin-tab ${o==="users"?"active":""}`,onClick:()=>d("users"),children:"User Management"}),e.jsx("button",{className:`admin-tab ${o==="videos"?"active":""}`,onClick:()=>d("videos"),children:"Content Moderation"}),e.jsx("button",{className:`admin-tab ${o==="subscriptions"?"active":""}`,onClick:()=>d("subscriptions"),children:"Subscriptions"}),e.jsx("button",{className:`admin-tab ${o==="settings"?"active":""}`,onClick:()=>d("settings"),children:"System Settings"})]}),e.jsxs("div",{className:"admin-main",children:[o==="dashboard"&&e.jsxs("div",{className:"admin-dashboard",children:[e.jsxs("div",{className:"stats-grid",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("h3",{children:"Total Users"}),e.jsx("p",{className:"stat-number",children:_.totalUsers})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("h3",{children:"Active Users"}),e.jsx("p",{className:"stat-number",children:_.activeUsers})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("h3",{children:"Suspended Users"}),e.jsx("p",{className:"stat-number",children:_.suspendedUsers})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("h3",{children:"Total Videos"}),e.jsx("p",{className:"stat-number",children:_.totalVideos})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("h3",{children:"Pending Approvals"}),e.jsx("p",{className:"stat-number",children:_.pendingVideos})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("h3",{children:"Active Subscriptions"}),e.jsx("p",{className:"stat-number",children:_.totalSubscriptions})]})]}),e.jsxs("div",{className:"recent-activity",children:[e.jsx("h3",{children:"Recent Activity"}),e.jsx("div",{className:"activity-list",children:x.slice(0,5).map(h=>e.jsxs("div",{className:"activity-item",children:[e.jsxs("span",{children:["New user: ",h.display_name||h.email]}),e.jsx("span",{children:new Date(h.created_at).toLocaleDateString()})]},h.id))})]})]}),o==="users"&&e.jsxs("div",{className:"admin-users",children:[e.jsxs("div",{className:"admin-filters",children:[e.jsx("input",{type:"text",placeholder:"Search users...",value:T,onChange:h=>W(h.target.value),className:"admin-search"}),e.jsxs("select",{value:D,onChange:h=>$(h.target.value),className:"admin-filter",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"suspended",children:"Suspended"})]})]}),e.jsx("div",{className:"users-table",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"User"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Joined"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:w.map(h=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:"user-info",children:[e.jsx("img",{src:h.profile_image_url||"/default-avatar.jpg",alt:h.display_name,className:"user-avatar"}),e.jsx("span",{children:h.display_name||"No name"})]})}),e.jsx("td",{children:h.email}),e.jsx("td",{children:new Date(h.created_at).toLocaleDateString()}),e.jsx("td",{children:e.jsx("span",{className:`status-badge ${h.status||"active"}`,children:h.status?h.status.toUpperCase():"ACTIVE"})}),e.jsx("td",{children:e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{onClick:()=>B(h.id,"suspend"),className:"action-btn suspend",disabled:h.status==="suspended",children:"Suspend"}),e.jsx("button",{onClick:()=>B(h.id,"activate"),className:"action-btn activate",disabled:h.status==="active",children:"Activate"}),e.jsx("button",{onClick:()=>B(h.id,"delete"),className:"action-btn delete",children:"Delete"})]})})]},h.id))})]})})]}),o==="videos"&&e.jsxs("div",{className:"admin-videos",children:[e.jsxs("div",{className:"admin-filters",children:[e.jsx("input",{type:"text",placeholder:"Search videos...",value:T,onChange:h=>W(h.target.value),className:"admin-search"}),e.jsxs("select",{value:D,onChange:h=>$(h.target.value),className:"admin-filter",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})]}),e.jsx("div",{className:"videos-table",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Video"}),e.jsx("th",{children:"Creator"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Uploaded"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:c.map(h=>{var f,C,p;return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:"video-info",children:[e.jsx("img",{src:h.thumbnail||"/default-thumbnail.jpg",alt:h.title,className:"video-thumbnail"}),e.jsxs("div",{children:[e.jsx("h4",{children:h.title}),e.jsxs("p",{children:[(f=h.description)==null?void 0:f.substring(0,100),"..."]})]})]})}),e.jsx("td",{children:((C=h.users)==null?void 0:C.display_name)||((p=h.users)==null?void 0:p.email)}),e.jsx("td",{children:e.jsx("span",{className:`status-badge ${h.verification_status}`,children:h.verification_status})}),e.jsx("td",{children:new Date(h.created_at).toLocaleDateString()}),e.jsx("td",{children:e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{onClick:()=>ae(h.id,"approve"),className:"action-btn approve",disabled:h.verification_status==="approved",children:"Approve"}),e.jsx("button",{onClick:()=>ae(h.id,"reject"),className:"action-btn reject",disabled:h.verification_status==="rejected",children:"Reject"}),e.jsx("button",{onClick:()=>ae(h.id,"delete"),className:"action-btn delete",children:"Delete"})]})})]},h.id)})})]})})]}),o==="subscriptions"&&e.jsxs("div",{className:"admin-subscriptions",children:[e.jsx("h3",{children:"Subscription Management"}),e.jsx("div",{className:"subscriptions-table",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"User"}),e.jsx("th",{children:"Tier"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Start Date"}),e.jsx("th",{children:"End Date"})]})}),e.jsx("tbody",{children:u.map(h=>{var f,C;return e.jsxs("tr",{children:[e.jsx("td",{children:((f=h.users)==null?void 0:f.display_name)||((C=h.users)==null?void 0:C.email)}),e.jsx("td",{children:e.jsx("span",{className:`tier-badge ${h.tier}`,children:h.tier})}),e.jsx("td",{children:e.jsx("span",{className:`status-badge ${h.status}`,children:h.status})}),e.jsx("td",{children:new Date(h.current_period_start).toLocaleDateString()}),e.jsx("td",{children:new Date(h.current_period_end).toLocaleDateString()})]},h.id)})})]})})]}),o==="settings"&&e.jsxs("div",{className:"admin-settings",children:[e.jsx("h3",{children:"System Settings"}),e.jsxs("div",{className:"settings-section",children:[e.jsx("h4",{children:"Admin Configuration"}),e.jsx("p",{children:"Configure admin emails and system settings here."}),e.jsxs("div",{className:"setting-item",children:[e.jsx("label",{children:"Admin Emails (comma-separated):"}),e.jsx("input",{type:"text",placeholder:"admin@example.com, admin2@example.com",className:"setting-input"})]}),e.jsx("button",{className:"save-settings-btn",children:"Save Settings"})]})]})]})]})]}):null},Xl=()=>{const[t,s]=l.useState(""),[r,a]=l.useState(""),[n,i]=l.useState(!0),[o,d]=l.useState(""),x=je(),[y]=ct(),m=y.get("returnTo")||"/",v=async u=>{if(u.preventDefault(),d(""),n){const{error:g}=await M.auth.signInWithPassword({email:t,password:r});g?d(g.message):(d("Logged in! Redirecting..."),setTimeout(()=>{x(m)},1e3))}else{const{error:g}=await M.auth.signUp({email:t,password:r});d(g?g.message:"Signup successful! Check your email for a confirmation link.")}};return e.jsxs("div",{style:{maxWidth:400,margin:"2rem auto",padding:20,border:"1px solid #ccc",borderRadius:8},children:[e.jsx("h2",{children:n?"Login":"Sign Up"}),e.jsxs("form",{onSubmit:v,children:[e.jsx("input",{type:"email",placeholder:"Email",value:t,required:!0,onChange:u=>s(u.target.value),style:{width:"100%",marginBottom:10,padding:8}}),e.jsx("input",{type:"password",placeholder:"Password",value:r,required:!0,onChange:u=>a(u.target.value),style:{width:"100%",marginBottom:10,padding:8}}),e.jsx("button",{type:"submit",style:{width:"100%",padding:10},children:n?"Login":"Sign Up"})]}),e.jsx("button",{onClick:()=>{i(!n),d("")},style:{marginTop:10,width:"100%",background:"none",border:"none",color:"#007bff",cursor:"pointer"},children:n?"Don't have an account? Sign Up":"Already have an account? Login"}),o&&e.jsx("div",{style:{marginTop:15,color:"red"},children:o})]})},ar=()=>{const[t,s]=l.useState(""),[r,a]=l.useState(""),[n,i]=l.useState(!0),o=wt();l.useEffect(()=>{o.pathname==="/signup"&&i(!1)},[o.pathname]);const[d,x]=l.useState(!1),[y,m]=l.useState(""),v=je(),[u]=ct(),g=u.get("returnTo")||"/",_=async T=>{var W;T.preventDefault(),x(!0),m("");try{const D=n?"/api/auth/login":"/api/auth/signup",$=`${ve.BASE_URL}${D}`;console.log("Attempting auth request to:",$),console.log("Mode:",n?"login":"signup"),console.log("Email:",t.trim());const E=await fetch($,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({email:t.trim(),password:r})});if(console.log("Response status:",E.status),console.log("Response headers:",Object.fromEntries(E.headers.entries())),!E.ok){const U=await E.text();console.error("Server error response:",U);try{const H=JSON.parse(U);throw E.status===409&&((W=H.error)!=null&&W.includes("already exists"))?new Error("This email is already registered. Please sign in instead."):H.error?new Error(H.error):new Error(`Server error: ${E.status} - ${U}`)}catch{throw new Error(`Server error: ${E.status} - ${U}`)}}const R=await E.json();if(console.log("Response data:",R),R.success)if(localStorage.setItem("user_authenticated","true"),localStorage.setItem("user_email",t.trim()),g.includes("/subscription-success")&&(localStorage.setItem("justLoggedIn","true"),console.log("🏷️ Set justLoggedIn flag for subscription success page")),console.log("🔐 Auth success - storing auth state"),m({type:"success",text:R.message||"Login successful! Redirecting..."}),n)setTimeout(()=>{v(g)},1500);else{const U=localStorage.getItem("pending_paypal_email"),H=localStorage.getItem("pending_tax_id");setTimeout(U||H?()=>{v("/subscription-success")}:()=>{v("/payment-setup?flow=new_user")},1500)}else m({type:"error",text:R.error||"Authentication failed"})}catch(D){console.error("Auth error:",D),m({type:"error",text:`Authentication error: ${D.message}`})}finally{x(!1)}},k=()=>{i(!n),m("")};return e.jsx("div",{className:"login-page",children:e.jsx("div",{className:"login-container",children:e.jsxs("div",{className:"login-card",children:[e.jsxs("div",{className:"login-header",children:[e.jsx("div",{className:"login-logo",children:"🎯"}),e.jsxs("h2",{children:["ScreenMerch ",n?"Login":"Sign Up"]})]}),e.jsxs("div",{className:"login-message",children:[e.jsx("strong",{children:n?"Welcome Back!":"Join ScreenMerch"}),e.jsx("br",{}),n?"Sign in to access your account and continue creating amazing merchandise.":"Create your free account to start selling merchandise with our 30% transaction fee model."]}),e.jsxs("form",{onSubmit:_,className:"login-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"email",children:"Email Address"}),e.jsx("input",{type:"email",id:"email",value:t,onChange:T=>s(T.target.value),required:!0,placeholder:"Enter your email"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"password",children:"Password"}),e.jsx("input",{type:"password",id:"password",value:r,onChange:T=>a(T.target.value),required:!0,placeholder:"Enter your password"})]}),e.jsx("button",{type:"submit",className:"login-submit-btn",disabled:d,children:d?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"loading-spinner"}),"Processing..."]}):n?"Sign In":"Create Account"})]}),e.jsxs("div",{className:"login-toggle",children:[e.jsx("span",{children:n?"Don't have an account?":"Already have an account?"}),e.jsx("button",{type:"button",onClick:k,className:"login-toggle-btn",children:n?"Sign Up":"Sign In"})]}),y&&e.jsx("div",{className:`login-message-display ${y.type}`,children:y.text}),e.jsx("div",{className:"login-footer",children:e.jsx("button",{onClick:()=>v("/"),className:"back-home-btn",children:"← Back to Home"})})]})})})},Ql=()=>e.jsx("div",{className:"privacy-policy-container",children:e.jsxs("div",{className:"privacy-policy-content",children:[e.jsx("div",{className:"logo",children:e.jsx("img",{src:Vt,alt:"ScreenMerch Logo",className:"logo-img"})}),e.jsx("h1",{children:"Privacy Policy"}),e.jsx("div",{className:"last-updated",children:"Last Updated: January 2025"}),e.jsxs("section",{children:[e.jsx("h2",{children:"Company Information"}),e.jsxs("p",{children:[e.jsx("strong",{children:"ScreenMerch"})," is committed to protecting your privacy and ensuring the security of your personal information. This Privacy Policy explains how we collect, use, protect, and handle your information when you use our custom merchandise platform and services."]}),e.jsxs("div",{className:"highlight-box",children:[e.jsx("strong",{children:"Contact Information:"}),e.jsx("br",{}),"Company: ScreenMerch",e.jsx("br",{}),"Website: screenmerch.com",e.jsx("br",{}),"Email: support@screenmerch.com",e.jsx("br",{}),"Privacy Officer: support@screenmerch.com"]})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"Information We Collect"}),e.jsx("h3",{children:"Personal Information"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Account Information:"})," Name, email address, username, password (encrypted)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Contact Details:"})," Phone number (for order notifications), mailing address"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Billing Information:"})," Shipping and billing addresses, payment method details (processed securely through Stripe)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Profile Data:"})," Profile pictures, preferences, customization settings"]})]}),e.jsx("h3",{children:"Content and Usage Information"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Video Content:"})," Video files, screenshots, thumbnails, and images you upload"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Custom Designs:"})," Product customizations, text overlays, design modifications"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Order History:"})," Products ordered, preferences, purchase patterns"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Platform Usage:"})," Navigation patterns, feature usage, time spent on platform"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Technical Data:"})," IP address, browser type, device information, operating system"]})]})]}),e.jsxs("section",{className:"security-box",children:[e.jsx("h2",{children:"Content Processing and Protection"}),e.jsx("h3",{children:"Video Content Handling"}),e.jsx("p",{children:e.jsx("strong",{children:"How We Process Your Content:"})}),e.jsxs("ul",{children:[e.jsx("li",{children:"Video content is processed through secure, encrypted servers"}),e.jsx("li",{children:"We extract screenshots and thumbnails for merchandise creation"}),e.jsx("li",{children:"All processing occurs within our protected infrastructure"}),e.jsx("li",{children:"Content is never shared with unauthorized third parties"}),e.jsx("li",{children:"We maintain strict access controls for all uploaded content"})]}),e.jsx("h3",{children:"Content Rights and Usage"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Your Content Ownership:"})," You retain ownership of your original content"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Platform License:"})," You grant us limited rights to process content for merchandise creation"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Exclusivity Protection:"})," We ensure your processed content remains exclusive to ScreenMerch"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"No Unauthorized Sharing:"})," Your content is never provided to competing platforms"]})]}),e.jsx("h3",{children:"Data Retention"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Active account content: Retained while account is active"}),e.jsx("li",{children:"Order-related content: Retained for 7 years for legal/tax purposes"}),e.jsx("li",{children:"Backup content: Securely destroyed after 90 days in backups"}),e.jsx("li",{children:"Deleted account content: Permanently removed within 30 days"})]})]}),e.jsxs("section",{className:"sms-section",children:[e.jsx("h2",{children:"SMS Messaging and Communications"}),e.jsx("h3",{children:"SMS Consent and Usage"}),e.jsx("p",{children:"By providing your phone number and checking the SMS consent box during checkout, you explicitly consent to receive SMS text messages from ScreenMerch for the following purposes:"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Order Notifications:"})," Updates about your order status, processing, and shipping"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Customer Service:"})," Support communications and order assistance"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Account Security:"})," Two-factor authentication and security alerts"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Important Updates:"})," Critical account or service notifications"]})]}),e.jsxs("div",{className:"highlight-box",children:[e.jsx("strong",{children:"Program Name:"})," ScreenMerch Notifications",e.jsx("br",{}),e.jsx("strong",{children:"Provider:"})," ScreenMerch",e.jsx("br",{}),e.jsx("strong",{children:"Purpose:"})," Order notifications and customer service communications",e.jsx("br",{}),e.jsx("strong",{children:"Frequency:"})," 1-3 messages per order, occasional service messages",e.jsx("br",{}),e.jsx("strong",{children:"Opt-Out:"})," Reply STOP to any SMS to unsubscribe immediately",e.jsx("br",{}),e.jsx("strong",{children:"Help:"})," Reply HELP to any SMS for assistance or contact support@screenmerch.com",e.jsx("br",{}),e.jsx("strong",{children:"Cost:"})," Message and data rates may apply based on your mobile carrier plan"]})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"How We Use Your Information"}),e.jsx("h3",{children:"Primary Uses"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Service Delivery:"})," Process and fulfill your custom merchandise orders"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Content Processing:"})," Transform your video content into printable merchandise designs"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Communication:"})," Send order notifications via SMS and email (with consent)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Customer Support:"})," Provide assistance and resolve issues"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Platform Improvement:"})," Enhance our services and user experience"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Security:"})," Protect against fraud and unauthorized access"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Legal Compliance:"})," Meet regulatory and legal obligations"]})]}),e.jsx("h3",{children:"Platform Exclusivity Protection"}),e.jsxs("ul",{children:[e.jsx("li",{children:"We ensure your content remains exclusive to ScreenMerch platform"}),e.jsx("li",{children:"We monitor and prevent unauthorized use of your processed content"}),e.jsx("li",{children:"We maintain audit trails for content usage and access"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"Data Security and Protection"}),e.jsx("h3",{children:"Technical Safeguards"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Encryption:"})," End-to-end encryption for data transmission and storage"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Access Controls:"})," Multi-factor authentication and role-based access"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Monitoring:"})," 24/7 security monitoring and intrusion detection"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Backups:"})," Secure, encrypted backups with restricted access"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Infrastructure:"})," SOC 2 compliant cloud infrastructure"]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"Your Privacy Rights"}),e.jsx("p",{children:"You have the right to:"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Access:"})," Request a copy of your personal information"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Correction:"})," Update or correct inaccurate information"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Deletion:"})," Request deletion of your information (subject to legal requirements)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Portability:"})," Receive your data in a structured, machine-readable format"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Opt-Out:"})," Withdraw consent for SMS communications"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Restriction:"})," Request limitations on how we process your data"]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"Contact Us"}),e.jsx("p",{children:"For privacy-related questions, concerns, or requests, please contact us:"}),e.jsxs("div",{className:"highlight-box",children:[e.jsx("strong",{children:"Privacy Officer:"})," support@screenmerch.com",e.jsx("br",{}),e.jsx("strong",{children:"General Support:"})," support@screenmerch.com",e.jsx("br",{}),e.jsx("strong",{children:"Website:"})," screenmerch.com",e.jsx("br",{}),e.jsx("strong",{children:"SMS Opt-Out:"})," Reply STOP to any message",e.jsx("br",{}),e.jsx("strong",{children:"Data Requests:"})," support@screenmerch.com"]})]}),e.jsxs("div",{className:"navigation-links",children:[e.jsx(Pe,{to:"/",className:"nav-link",children:"← Back to ScreenMerch"})," |",e.jsx(Pe,{to:"/terms-of-service",className:"nav-link",children:"Terms of Service →"})]})]})}),Kl=()=>e.jsx("div",{className:"terms-container",children:e.jsxs("div",{className:"terms-content",children:[e.jsx("div",{className:"logo",children:e.jsx("img",{src:Vt,alt:"ScreenMerch Logo",className:"logo-img"})}),e.jsx("h1",{children:"Terms of Service"}),e.jsx("div",{className:"last-updated",children:"Last Updated: January 2025"}),e.jsxs("section",{children:[e.jsx("h2",{children:"1. Acceptance of Terms"}),e.jsx("p",{children:'By accessing and using ScreenMerch ("the Service"), you accept and agree to be bound by the terms and provision of this agreement. These Terms of Service ("Terms") govern your use of the ScreenMerch website and services. If you do not agree to these terms, you must not use the Service.'})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"2. Description of Service"}),e.jsx("p",{children:"ScreenMerch is a platform that allows users to create custom merchandise from video content, including screenshots and thumbnails. We facilitate the creation and ordering of custom products through third-party providers. Our platform is designed exclusively for creating merchandise through ScreenMerch services."})]}),e.jsxs("section",{className:"critical-box",children:[e.jsx("h2",{children:"3. CRITICAL: Intellectual Property Protection & Platform Exclusivity"}),e.jsx("h3",{children:"3.1 Reverse Engineering Prohibition"}),e.jsx("p",{children:e.jsx("strong",{children:"YOU EXPRESSLY AGREE AND ACKNOWLEDGE THAT:"})}),e.jsxs("ul",{children:[e.jsx("li",{children:"You will NOT reverse engineer, decompile, disassemble, or attempt to derive the source code of ScreenMerch platform"}),e.jsx("li",{children:"You will NOT attempt to discover underlying algorithms, methods, or processes used by ScreenMerch"}),e.jsx("li",{children:"You will NOT use any automated tools, bots, or scrapers to extract data or functionality from ScreenMerch"}),e.jsx("li",{children:"You will NOT create competing services based on ScreenMerch's functionality or design"}),e.jsx("li",{children:"You will NOT copy, reproduce, or replicate ScreenMerch's user interface, workflows, or business processes"})]}),e.jsx("h3",{children:"3.2 Platform Exclusivity Agreement"}),e.jsx("p",{children:e.jsx("strong",{children:"EXCLUSIVE USE COMMITMENT:"})}),e.jsxs("ul",{children:[e.jsx("li",{children:e.jsx("strong",{children:"You agree that any video images, screenshots, thumbnails, or content processed through ScreenMerch may ONLY be used to create products through ScreenMerch platform"})}),e.jsx("li",{children:"You will NOT use video content processed on ScreenMerch to create merchandise on any other platform (including but not limited to Printful, Teespring, Redbubble, Etsy, Amazon Merch, etc.)"}),e.jsx("li",{children:"You will NOT download, export, or transfer video images from ScreenMerch to create products elsewhere"}),e.jsx("li",{children:"You will NOT share, distribute, or provide ScreenMerch-processed content to third parties for merchandise creation"}),e.jsx("li",{children:"Any custom designs, layouts, or modifications created through ScreenMerch remain exclusive to ScreenMerch platform"})]}),e.jsx("h3",{children:"3.3 Enforcement and Penalties"}),e.jsx("p",{children:"Violation of these exclusivity and protection terms will result in:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Immediate account termination without refund"}),e.jsx("li",{children:"Legal action for breach of contract and intellectual property infringement"}),e.jsx("li",{children:"Monetary damages including lost profits and legal fees"}),e.jsx("li",{children:"Permanent ban from all ScreenMerch services"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"4. User Accounts"}),e.jsx("h3",{children:"Account Creation"}),e.jsxs("ul",{children:[e.jsx("li",{children:"You may be required to create an account to access certain features"}),e.jsx("li",{children:"You are responsible for maintaining the confidentiality of your account"}),e.jsx("li",{children:"You are responsible for all activities that occur under your account"}),e.jsx("li",{children:"You must provide accurate and complete information when creating an account"}),e.jsx("li",{children:"Each user may only maintain one active account"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"5. Content and Intellectual Property Rights"}),e.jsx("h3",{children:"5.1 User Content Ownership"}),e.jsxs("ul",{children:[e.jsx("li",{children:"You retain ownership of original content you upload to ScreenMerch"}),e.jsx("li",{children:"You grant ScreenMerch a limited, non-exclusive license to process your content for merchandise creation"}),e.jsx("li",{children:"You are responsible for ensuring you have rights to any content you upload"}),e.jsx("li",{children:"You must not upload copyrighted content without proper authorization"})]}),e.jsx("h3",{children:"5.2 ScreenMerch Intellectual Property"}),e.jsxs("ul",{children:[e.jsx("li",{children:"ScreenMerch platform, technology, algorithms, and processes are proprietary and protected"}),e.jsx("li",{children:"All ScreenMerch branding, logos, and design elements are owned by ScreenMerch"}),e.jsx("li",{children:"Product templates, layouts, and customization tools are ScreenMerch intellectual property"}),e.jsx("li",{children:"You may not use ScreenMerch IP for any purpose outside the intended service"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"6. Platform Usage Restrictions"}),e.jsx("h3",{children:"6.1 Prohibited Content"}),e.jsx("p",{children:"You may not upload or create products containing:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Copyrighted material without authorization"}),e.jsx("li",{children:"Illegal, harmful, threatening, or offensive content"}),e.jsx("li",{children:"Content that violates privacy or publicity rights"}),e.jsx("li",{children:"Trademarked material without permission"}),e.jsx("li",{children:"Adult or explicit content"}),e.jsx("li",{children:"Content promoting violence, hate, or discrimination"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"7. Orders and Payment"}),e.jsx("h3",{children:"7.1 Product Orders"}),e.jsxs("ul",{children:[e.jsx("li",{children:"All orders are subject to acceptance and product availability"}),e.jsx("li",{children:"Prices are displayed in USD and may change without notice"}),e.jsx("li",{children:"Payment is processed securely through Stripe"}),e.jsx("li",{children:"You agree to provide accurate billing information"}),e.jsx("li",{children:"Orders cannot be transferred to other platforms"})]}),e.jsx("h3",{children:"7.2 Refunds and Returns"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Custom merchandise is typically non-refundable due to personalized nature"}),e.jsx("li",{children:"Defective or damaged products may be eligible for replacement"}),e.jsx("li",{children:"Refund requests must be submitted within 30 days of delivery"}),e.jsx("li",{children:"No refunds for violation of exclusivity terms"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"8. Prohibited Uses"}),e.jsx("p",{children:"You may not use ScreenMerch to:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Upload illegal, harmful, or offensive content"}),e.jsx("li",{children:"Infringe on intellectual property rights"}),e.jsx("li",{children:"Engage in fraudulent or deceptive practices"}),e.jsx("li",{children:"Attempt to circumvent security measures"}),e.jsx("li",{children:"Use automated systems to access the service"}),e.jsx("li",{children:"Reverse engineer or replicate our platform"}),e.jsx("li",{children:"Export content for use on competing platforms"}),e.jsx("li",{children:"Violate platform exclusivity agreements"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"9. Termination"}),e.jsx("h3",{children:"9.1 Termination by ScreenMerch"}),e.jsxs("ul",{children:[e.jsx("li",{children:"We may terminate accounts for violation of these terms"}),e.jsx("li",{children:"Immediate termination for reverse engineering or exclusivity violations"}),e.jsx("li",{children:"We reserve the right to refuse service to anyone"})]}),e.jsx("h3",{children:"9.2 Effect of Termination"}),e.jsxs("ul",{children:[e.jsx("li",{children:"All licenses granted to you terminate immediately"}),e.jsx("li",{children:"You must cease all use of ScreenMerch services"}),e.jsx("li",{children:"Outstanding orders may be cancelled"}),e.jsx("li",{children:"Exclusivity obligations survive termination"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"10. Contact Information"}),e.jsxs("div",{className:"highlight-box",children:[e.jsx("strong",{children:"ScreenMerch Support"}),e.jsx("br",{}),"Email: support@screenmerch.com",e.jsx("br",{}),"Website: screenmerch.com",e.jsx("br",{}),"Legal Issues: support@screenmerch.com"]})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"11. Entire Agreement"}),e.jsx("p",{children:"These Terms of Service, together with our Privacy Policy, constitute the entire agreement between you and ScreenMerch regarding the use of our services."})]}),e.jsxs("div",{className:"navigation-links",children:[e.jsx(Pe,{to:"/",className:"nav-link",children:"← Back to ScreenMerch"})," |",e.jsx(Pe,{to:"/privacy-policy",className:"nav-link",children:"← Privacy Policy"})]})]})}),ec=()=>{const[t]=ct(),s=je(),[r,a]=l.useState([]),[n,i]=l.useState(!1),[o,d]=l.useState(""),[x,y]=l.useState("");l.useEffect(()=>{const g=t.get("q");g&&(y(g),m(g))},[t]);const m=async g=>{if(!g||g.trim().length<2){d("Please enter at least 2 characters to search");return}i(!0),d(""),a([]);try{const _=await fetch(`${ve.ENDPOINTS.BASE_URL}/api/search/creators?q=${encodeURIComponent(g.trim())}`);if(!_.ok)throw new Error(`Search failed: ${_.status}`);const k=await _.json();k.success?a(k.results||[]):d(k.error||"Search failed")}catch(_){console.error("Search error:",_),d("Unable to search at this time. Please try again.")}finally{i(!1)}},v=g=>{s(`/creator/${g}`)},u=g=>g?new Date(g).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"Unknown";return e.jsx("div",{className:"search-page",children:e.jsxs("div",{className:"search-container",children:[e.jsxs("div",{className:"search-header",children:[e.jsx("h1",{children:"Search Results"}),x&&e.jsxs("p",{className:"search-query",children:["Results for: ",e.jsxs("span",{className:"query-text",children:['"',x,'"']})]})]}),n&&e.jsxs("div",{className:"search-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Searching creators..."})]}),o&&e.jsx("div",{className:"search-error",children:e.jsx("p",{children:o})}),!n&&!o&&r.length===0&&x&&e.jsxs("div",{className:"search-no-results",children:[e.jsx("h3",{children:"No creators found"}),e.jsx("p",{children:"Try searching with different keywords or check the spelling."}),e.jsxs("div",{className:"search-suggestions",children:[e.jsx("p",{children:e.jsx("strong",{children:"Tips:"})}),e.jsxs("ul",{children:[e.jsx("li",{children:"Use shorter keywords"}),e.jsx("li",{children:"Try searching by username or display name"}),e.jsx("li",{children:"Check for typos"})]})]})]}),!n&&r.length>0&&e.jsxs("div",{className:"search-results",children:[e.jsx("div",{className:"results-header",children:e.jsxs("p",{className:"results-count",children:["Found ",r.length," creator",r.length!==1?"s":""]})}),e.jsx("div",{className:"creators-grid",children:r.map(g=>{var _,k;return e.jsxs("div",{className:"creator-card",onClick:()=>v(g.id),children:[e.jsxs("div",{className:"creator-avatar",children:[g.profile_image_url?e.jsx("img",{src:g.profile_image_url,alt:g.display_name,onError:T=>{T.target.style.display="none",T.target.nextSibling.style.display="flex"}}):null,e.jsx("div",{className:"avatar-placeholder",style:{display:g.profile_image_url?"none":"flex"},children:((k=(_=g.display_name)==null?void 0:_.charAt(0))==null?void 0:k.toUpperCase())||"?"})]}),e.jsxs("div",{className:"creator-info",children:[e.jsx("h3",{className:"creator-name",children:g.display_name}),e.jsxs("p",{className:"creator-username",children:["@",g.username]}),g.bio&&e.jsx("p",{className:"creator-bio",children:g.bio}),e.jsxs("div",{className:"creator-stats",children:[e.jsxs("span",{className:"video-count",children:[g.video_count||0," video",(g.video_count||0)!==1?"s":""]}),e.jsxs("span",{className:"joined-date",children:["Joined ",u(g.created_at)]})]})]}),e.jsx("div",{className:"creator-action",children:e.jsx("button",{className:"view-profile-btn",children:"View Profile"})})]},g.id)})})]})]})})},tc=({sidebar:t})=>{console.log("🎯 MerchandiseCategories component rendering - sidebar prop:",t);const[s,r]=l.useState(!1),[a,n]=l.useState(!1),[i,o]=l.useState(null),d=(()=>{try{const k=localStorage.getItem("pending_merch_data");return k?JSON.parse(k):{}}catch{return console.warn("Invalid merch data in localStorage, clearing..."),localStorage.removeItem("pending_merch_data"),{}}})(),x=d.screenshots||[],y=d.thumbnail||"",m={title:d.videoTitle||"Unknown Video",channelTitle:d.creatorName||"Unknown Creator",url:d.videoUrl||""};console.log("📸 Loaded from localStorage - Screenshots count:",x.length),console.log("📸 Thumbnail present:",!!y);const v=[{name:"Women's",emoji:"👩",category:"womens"},{name:"Men's",emoji:"👨",category:"mens"},{name:"Kids",emoji:"👶",category:"kids"},{name:"Mugs",emoji:"☕",category:"mugs"},{name:"Hats",emoji:"🧢",category:"hats"},{name:"Bags",emoji:"👜",category:"bags"},{name:"Pets",emoji:"🐕",category:"pets"},{name:"Stickers",emoji:"🌟",category:"stickers"},{name:"Miscellaneous",emoji:"📦",category:"misc"},{name:"Thumbnails",emoji:"🖼️",category:"thumbnails"}],u=async k=>{if(console.log("🎯 Category selected:",k),!(localStorage.getItem("user_authenticated")==="true")){o(k),n(!0);return}await g(k)},g=async k=>{r(!0);try{const T=localStorage.getItem("user_authenticated"),W=localStorage.getItem("user_email"),D=document.referrer||window.location.origin,$=(m==null?void 0:m.title)||"Unknown Video",E=(m==null?void 0:m.channelTitle)||"Unknown Creator";console.log("🔍 Creating product with category:",k),console.log("🔍 Video data:",{videoTitle:$,creatorName:E,videoUrl:D});const R={thumbnail:y,videoUrl:D,videoTitle:$,creatorName:E,screenshots:x.slice(0,6),isAuthenticated:T==="true",userEmail:W||"",category:k};console.log("Request data:",R),console.log("🔍 Making API call to:",`${ve.BASE_URL}/api/create-product`),console.log("🔍 Request data:",R);const U=await fetch(`${ve.BASE_URL}/api/create-product`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)});if(console.log("🔍 Response status:",U.status),console.log("🔍 Response ok:",U.ok),console.log("🔍 Response headers:",U.headers),!U.ok){const se=await U.text();throw console.error("❌ Response not ok:",se),new Error(`HTTP error! status: ${U.status}, text: ${se}`)}const H=await U.json();console.log("✅ Product creation result:",H),H.success?window.location.href=H.product_url:(console.error("❌ Product creation failed:",H.error),alert("Failed to create product. Please try again."))}catch(T){console.error("❌ Error creating product:",T),alert("Error creating product. Please try again.")}finally{r(!1)}},_=async()=>{i&&(await g(i),o(null))};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:`container ${t?"":" large-container"}`,children:[e.jsx("div",{className:"user-flow-section",children:e.jsx("div",{className:"flow-steps",children:e.jsxs("div",{className:"flow-step",children:[e.jsx("div",{className:"step-number",children:"3"}),e.jsxs("div",{className:"step-content",children:[e.jsx("h3",{children:"Make Merchandise"}),e.jsx("p",{children:"Create custom products with your screenshot"})]})]})})}),e.jsxs("div",{className:"merchandise-categories",children:[e.jsxs("div",{className:"categories-container",children:[e.jsx("h1",{className:"categories-title",children:"Choose a Product Category"}),e.jsx("p",{className:"categories-subtitle",children:"Select a category to browse products for your custom merchandise"}),e.jsx("div",{className:"categories-grid",children:v.map((k,T)=>e.jsxs("div",{className:`category-box ${s?"disabled":""}`,onClick:W=>{console.log("🖱️ Category clicked:",k.name,k.category),console.log("🖱️ Event:",W),console.log("🖱️ isCreating:",s),s?console.log("🖱️ Click ignored - isCreating is true"):(console.log("🖱️ Calling handleCategoryClick"),u(k.category))},onMouseDown:()=>console.log("🖱️ MOUSE DOWN on:",k.name),onMouseUp:()=>console.log("🖱️ MOUSE UP on:",k.name),style:{cursor:"pointer"},children:[e.jsx("div",{className:"category-emoji",children:k.emoji}),e.jsx("div",{className:"category-name",children:k.name}),s&&e.jsx("div",{className:"loading-overlay",children:"Creating..."})]},T))}),e.jsx("div",{className:"back-button-container",children:e.jsx("button",{className:"back-button",onClick:()=>window.history.back(),children:"← Back to Video"})})]}),e.jsx($s,{isOpen:a,onClose:()=>{n(!1),o(null)},onSuccess:_})]})]})})},sc=({sidebar:t})=>{const{productId:s}=Bt(),[r]=ct(),a=je(),[n,i]=l.useState(null),[o,d]=l.useState(!0),[x,y]=l.useState(null),[m,v]=l.useState(null),[u,g]=l.useState({}),[_,k]=l.useState({}),[T,W]=l.useState(()=>{try{const c=localStorage.getItem("cart_items");return c?JSON.parse(c):[]}catch{return[]}}),[D,$]=l.useState(!1),[E,R]=l.useState({screenshots:[],thumbnail:""}),U=r.get("category")||"all",H=r.get("authenticated")==="true",se=r.get("email")||"",Q=[{name:"All Products",emoji:"🛍️",category:"all"},{name:"Women's",emoji:"👩",category:"womens"},{name:"Men's",emoji:"👨",category:"mens"},{name:"Kids",emoji:"👶",category:"kids"},{name:"Mugs",emoji:"☕",category:"mugs"},{name:"Hats",emoji:"🧢",category:"hats"},{name:"Bags",emoji:"👜",category:"bags"},{name:"Pets",emoji:"🐕",category:"pets"},{name:"Misc",emoji:"📦",category:"misc"},{name:"Thumbnails",emoji:"🖼️",category:"thumbnails"}],le=c=>{const j=`/product/${s}?category=${c}&authenticated=${H}&email=${se}`;a(j)},B=()=>{var j,h;const c=(j=n==null?void 0:n.product)!=null&&j.screenshots&&n.product.screenshots.length>0?n.product.screenshots:E.screenshots;return m==="thumbnail"?((h=n==null?void 0:n.product)==null?void 0:h.thumbnail_url)||E.thumbnail||"":typeof m=="number"&&c&&c[m]?c[m]:""},ae=c=>{W(c);try{localStorage.setItem("cart_items",JSON.stringify(c))}catch{}},w=(c,j)=>{var Y,b,F,q;const h=u[j]||((b=(Y=c==null?void 0:c.options)==null?void 0:Y.color)==null?void 0:b[0])||"Default",f=_[j]||((q=(F=c==null?void 0:c.options)==null?void 0:F.size)==null?void 0:q[0])||"One Size",C=B(),p={name:(c==null?void 0:c.name)||"Product",price:(c==null?void 0:c.price)||0,image:c!=null&&c.preview_image?`https://screenmerch.fly.dev/static/images/${c.preview_image}`:c!=null&&c.main_image?`https://screenmerch.fly.dev/static/images/${c.main_image}`:"",color:h,size:f,screenshot:C,qty:1},P=[...T,p];ae(P),alert("Added to cart!")};return l.useEffect(()=>{try{const c=localStorage.getItem("pending_merch_data");if(c){const j=JSON.parse(c);R({screenshots:Array.isArray(j==null?void 0:j.screenshots)?j.screenshots.slice(0,6):[],thumbnail:(j==null?void 0:j.thumbnail)||""})}}catch{console.warn("Invalid pending_merch_data in localStorage, ignoring")}},[s]),l.useEffect(()=>{s&&(async()=>{var j,h,f,C;try{d(!0);const p=await fetch(`https://screenmerch.fly.dev/api/product/${s}?category=${U}&authenticated=${H}&email=${se}`);if(!p.ok)throw new Error(`Failed to fetch product data: ${p.status}`);const P=await p.json();console.log("📦 Product Data Received:",P),console.log("📸 Thumbnail URL:",(j=P.product)==null?void 0:j.thumbnail_url),console.log("📸 Screenshots:",(h=P.product)==null?void 0:h.screenshots),console.log("📸 Screenshots Length:",((C=(f=P.product)==null?void 0:f.screenshots)==null?void 0:C.length)||0),i(P)}catch(p){console.error("Error fetching product data:",p),y(p.message)}finally{d(!1)}})()},[s,U,H,se]),o?e.jsx("div",{className:`container ${t?"":" large-container"}`,children:e.jsxs("div",{style:{padding:"2rem",textAlign:"center"},children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Loading product..."})]})}):x?e.jsx("div",{className:`container ${t?"":" large-container"}`,children:e.jsxs("div",{style:{padding:"2rem",textAlign:"center",color:"red"},children:[e.jsx("h2",{children:"Error Loading Product"}),e.jsx("p",{children:x}),e.jsx("button",{onClick:()=>window.location.reload(),children:"Retry"})]})}):n?e.jsxs("div",{className:`container ${t?"":" large-container"}`,children:[e.jsx("div",{className:"user-flow-section",children:e.jsx("div",{className:"flow-steps",children:e.jsxs("div",{className:"flow-step",children:[e.jsx("div",{className:"step-number",children:"3"}),e.jsxs("div",{className:"step-content",children:[e.jsx("h3",{children:"Make Merchandise"}),e.jsx("p",{children:"Create custom products with your screenshot"})]})]})})}),(U==="all"||!n.products||n.products.length===0)&&e.jsx("div",{className:"merchandise-categories",children:e.jsxs("div",{className:"categories-container",children:[e.jsx("h1",{className:"categories-title",children:"Choose a Product Category"}),e.jsx("div",{className:"categories-grid",children:Q.map((c,j)=>e.jsxs("div",{className:`category-box ${c.category===U?"active":""}`,onClick:()=>le(c.category),style:{cursor:"pointer"},children:[e.jsx("div",{className:"category-emoji",children:c.emoji}),e.jsx("div",{className:"category-name",children:c.name})]},j))})]})}),U!=="all"&&n.products&&n.products.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"screenshots-section",children:[e.jsx("h2",{className:"screenshots-title",children:"Select Your Screenshot"}),e.jsx("p",{className:"screenshots-subtitle",children:"Choose which screenshot to use for your custom merchandise"}),e.jsx("div",{className:"screenshots-preview",children:e.jsxs("div",{className:"screenshot-grid",children:[(()=>{var j;const c=((j=n==null?void 0:n.product)==null?void 0:j.thumbnail_url)||E.thumbnail;return c?e.jsxs("div",{className:`screenshot-item ${m==="thumbnail"?"selected":""}`,onClick:()=>v("thumbnail"),children:[e.jsx("img",{src:c,alt:"Thumbnail",className:"screenshot-image"}),e.jsx("div",{className:"screenshot-label",children:"Thumbnail"})]}):null})(),(()=>{var f,C;const c=((f=n==null?void 0:n.product)==null?void 0:f.thumbnail_url)||E.thumbnail,h=(((C=n==null?void 0:n.product)!=null&&C.screenshots&&n.product.screenshots.length>0?n.product.screenshots:E.screenshots)||[]).filter(p=>p&&p!==c);return h&&h.length>0?h.map((p,P)=>e.jsxs("div",{className:`screenshot-item ${m===P?"selected":""}`,onClick:()=>v(P),children:[e.jsx("img",{src:p,alt:`Screenshot ${P+1}`,className:"screenshot-image"}),e.jsxs("div",{className:"screenshot-label",children:["Screenshot ",P+1]})]},P)):null})()]})})]}),e.jsx("div",{className:"product-page-container",children:e.jsxs("div",{className:"product-main",children:[e.jsx("div",{className:"product-image-section",children:n.img_url&&e.jsx("img",{src:n.img_url,alt:"Product Preview",className:"product-preview-image"})}),e.jsxs("div",{className:"product-options-section",children:[e.jsxs("div",{className:"cart-section",children:[e.jsx("button",{className:"view-cart-btn",onClick:()=>$(!0),children:"View Cart"}),e.jsx("button",{className:"checkout-btn",onClick:()=>a("/checkout"),children:"Checkout"})]}),e.jsx("div",{className:"products-grid",children:n.products&&n.products.map((c,j)=>e.jsxs("div",{className:"product-card",children:[c.preview_image&&e.jsx("div",{className:"product-image",children:e.jsx("img",{src:`https://screenmerch.fly.dev/static/images/${c.preview_image}`,alt:c.name,onError:h=>{h.target.src=`https://screenmerch.fly.dev/static/images/${c.main_image}`}})}),e.jsx("h3",{children:c.name}),e.jsxs("p",{className:"product-price",children:["$",c.price.toFixed(2)]}),e.jsxs("div",{className:"product-options",children:[c.options&&c.options.color&&c.options.color.length>0&&e.jsxs("div",{className:"option-group",children:[e.jsx("label",{children:"Color:"}),e.jsx("select",{className:"color-select",children:c.options.color.map((h,f)=>e.jsx("option",{value:h,children:h},f))})]}),c.options&&c.options.size&&c.options.size.length>0&&e.jsxs("div",{className:"option-group",children:[e.jsx("label",{children:"Size:"}),e.jsx("select",{className:"size-select",children:c.options.size.map((h,f)=>e.jsx("option",{value:h,children:h},f))})]})]}),e.jsx("button",{className:"add-to-cart-btn",onClick:()=>w(c,j),children:"Add to Cart"})]},j))}),e.jsxs("div",{className:"cart-section cart-section-bottom",children:[e.jsx("button",{className:"view-cart-btn",onClick:()=>$(!0),children:"View Cart"}),e.jsx("button",{className:"checkout-btn",onClick:()=>a("/checkout"),children:"Checkout"})]})]})]})}),D&&e.jsx("div",{className:"cart-modal",onClick:()=>$(!1),children:e.jsxs("div",{className:"cart-modal-content",onClick:c=>c.stopPropagation(),children:[e.jsx("h3",{children:"Your Cart"}),T.length===0?e.jsx("p",{children:"Your cart is empty."}):e.jsxs("div",{className:"cart-items",children:[T.map((c,j)=>e.jsxs("div",{className:"cart-item",children:[c.image&&e.jsx("img",{src:c.image,alt:c.name}),e.jsxs("div",{className:"cart-item-info",children:[e.jsx("div",{className:"cart-item-name",children:c.name}),e.jsxs("div",{className:"cart-item-meta",children:[c.color," • ",c.size]}),e.jsxs("div",{className:"cart-item-price",children:["$",(c.price||0).toFixed(2)]})]}),c.screenshot&&e.jsx("img",{className:"cart-item-shot",src:c.screenshot,alt:"screenshot"})]},j)),e.jsxs("div",{className:"cart-actions",children:[e.jsx("button",{className:"view-cart-btn",onClick:()=>$(!1),children:"Continue Shopping"}),e.jsx("button",{className:"checkout-btn",onClick:()=>a("/checkout"),children:"Checkout"})]})]})]})})]})]}):e.jsx("div",{className:`container ${t?"":" large-container"}`,children:e.jsxs("div",{style:{padding:"2rem",textAlign:"center"},children:[e.jsx("h2",{children:"Product Not Found"}),e.jsx("p",{children:"The requested product could not be found."})]})})},rc=({isOpen:t,image:s,onCrop:r,onCancel:a})=>{const[n,i]=l.useState({x:100,y:100,width:200,height:200}),[o,d]=l.useState(!1),[x,y]=l.useState(!1),[m,v]=l.useState(null),[u,g]=l.useState({x:0,y:0}),[_,k]=l.useState({width:0,height:0}),[T,W]=l.useState({width:0,height:0}),D=l.useRef(null),$={"4x6":{width:1200,height:1800,name:'4" x 6" Photo'},"5x7":{width:1500,height:2100,name:'5" x 7" Photo'},"8x10":{width:2400,height:3e3,name:'8" x 10" Photo'},"11x14":{width:3300,height:4200,name:'11" x 14" Photo'},Mug:{width:800,height:800,name:"Coffee Mug"},"T-Shirt":{width:1200,height:1200,name:"T-Shirt Print"},"Phone Case":{width:600,height:1200,name:"Phone Case"}};l.useEffect(()=>{if(t&&s){const c=new Image;c.crossOrigin="anonymous",c.onload=()=>{const j=c.width,h=c.height;k({width:j,height:h}),setTimeout(()=>{const f=document.querySelector(".crop-image");if(f){const C=f.getBoundingClientRect();console.log("Display image size detected:",C),console.log("Image natural size:",{width:f.naturalWidth,height:f.naturalHeight}),console.log("Image CSS size:",{width:f.offsetWidth,height:f.offsetHeight});const p=C.width,P=C.height;W({width:p,height:P});const Y=p/2-150,b=P/2-150,F=Math.min(300,Math.min(p,P)*.8);i({x:Math.max(0,Y),y:Math.max(0,b),width:F,height:F})}else console.log("Display image not found, using fallback sizes"),W({width:400,height:300}),i({x:100,y:100,width:200,height:200})},300)},c.src=s}},[t,s]);const E=c=>{var C;const j=(C=document.querySelector(".crop-image"))==null?void 0:C.getBoundingClientRect();if(!j)return;const h=c.clientX-j.left,f=c.clientY-j.top;console.log("Mouse down:",{clientX:c.clientX,clientY:c.clientY,imageRect:j,x:h,y:f,cropArea:n}),h>=n.x&&h<=n.x+n.width&&f>=n.y&&f<=n.y+n.height&&(d(!0),g({x:h-n.x,y:f-n.y}))},R=c=>{var C;if(!o&&!x)return;const j=(C=document.querySelector(".crop-image"))==null?void 0:C.getBoundingClientRect();if(!j)return;const h=c.clientX-j.left,f=c.clientY-j.top;if(o){const p=Math.max(0,Math.min(h-u.x,_.width-n.width)),P=Math.max(0,Math.min(f-u.y,_.height-n.height));i(Y=>({...Y,x:p,y:P}))}else if(x){let p={...n};switch(m){case"bottom-right":p.width=Math.max(50,h-n.x),p.height=Math.max(50,f-n.y);break;case"bottom-left":p.x=Math.min(h,n.x+n.width-50),p.width=n.x+n.width-p.x,p.height=Math.max(50,f-n.y);break;case"top-right":p.y=Math.min(f,n.y+n.height-50),p.width=Math.max(50,h-n.x),p.height=n.y+n.height-p.y;break;case"top-left":p.x=Math.min(h,n.x+n.width-50),p.y=Math.min(f,n.y+n.height-50),p.width=n.x+n.width-p.x,p.height=n.y+n.height-p.y;break}p.x=Math.max(0,Math.min(p.x,_.width-p.width)),p.y=Math.max(0,Math.min(p.y,_.height-p.height)),p.width=Math.min(p.width,_.width-p.x),p.height=Math.min(p.height,_.height-p.y),i(p)}},U=()=>{d(!1),y(!1),v(null)},H=(c,j)=>{j.stopPropagation(),y(!0),v(c)},se=c=>{if(!T.width||!T.height||!_.width||!_.height)return console.log("Missing size data:",{displaySize:T,imageSize:_}),c;const j=document.querySelector(".crop-image");let h=T.width,f=T.height;if(j){const b=j.getBoundingClientRect();h=b.width,f=b.height,console.log("Current display size:",{width:h,height:f})}const C=_.width/h,p=_.height/f,P=8,Y={x:Math.round((c.x-P)*C),y:Math.round(c.y*p),width:Math.round(c.width*C),height:Math.round(c.height*p)};return Y.x=Math.max(0,Math.min(Y.x,_.width-Y.width)),Y.y=Math.max(0,Math.min(Y.y,_.height-Y.height)),console.log("Coordinate conversion:",{displayCrop:c,originalCrop:Y,scaleX:C,scaleY:p,offsetAdjustment:P,imageSize:_,actualDisplaySize:{width:h,height:f}}),Y},Q=()=>{try{const c=document.createElement("canvas"),j=c.getContext("2d"),h=new Image,f=se(n);console.log("Final crop coordinates:",{display:n,original:f,imageSize:_,displaySize:T}),h.onload=()=>{c.width=f.width,c.height=f.height,console.log("Drawing crop:",{sourceX:f.x,sourceY:f.y,sourceWidth:f.width,sourceHeight:f.height,destX:0,destY:0,destWidth:f.width,destHeight:f.height}),j.clearRect(0,0,c.width,c.height),j.drawImage(h,f.x,f.y,f.width,f.height,0,0,f.width,f.height);const C=c.toDataURL("image/png");r(C)},h.src=s}catch(c){console.error("Error during crop operation:",c),alert("Error cropping image. Please try again.")}},le=async()=>{try{const c=document.createElement("canvas"),j=c.getContext("2d"),h=new Image,f=se(n);h.onload=async()=>{c.width=f.width,c.height=f.height,j.clearRect(0,0,c.width,c.height),j.drawImage(h,f.x,f.y,f.width,f.height,0,0,f.width,f.height);const p={image_data:c.toDataURL("image/png"),feather_radius:12},P=await fetch("https://screenmerch.fly.dev/api/process-shirt-image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(P.ok){const Y=await P.json(),b={thumbnail_data:Y.processed_image,print_dpi:300,soft_corners:!1,edge_feather:!0},F=await fetch("https://screenmerch.fly.dev/api/process-thumbnail-print-quality",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(F.ok){const q=await F.json();r(q.screenshot),alert("✨ Feather effect applied and print quality image generated!")}else r(Y.processed_image),alert("✨ Feather effect applied!")}else{const Y=await P.json();alert("Error applying feather effect: "+(Y.error||"Unknown error"))}},h.src=s}catch(c){console.error("Error during feather effect:",c),alert("Error applying feather effect. Please try again.")}},B=()=>{const c={},j=se(n);return Object.entries($).forEach(([h,f])=>{const C=j.width>=f.width,p=j.height>=f.height,P=C&&p;c[h]={meetsWidth:C,meetsHeight:p,isSuitable:P,requirements:f,currentWidth:j.width,currentHeight:j.height}}),c},ae=()=>{const c=B(),j=Object.entries(c).filter(([h,f])=>f.isSuitable).sort((h,f)=>{const C=h[1].currentWidth*h[1].currentHeight;return f[1].currentWidth*f[1].currentHeight-C});return j.length>0?j[0]:null};B();const w=ae();return t?e.jsx("div",{className:"simple-crop-overlay",children:e.jsxs("div",{className:"simple-crop-modal",children:[e.jsxs("div",{className:"simple-crop-header",children:[e.jsx("h3",{children:"Simple Print Crop Tool"}),e.jsx("button",{className:"simple-crop-close",onClick:a,children:"×"})]}),e.jsxs("div",{className:"simple-crop-content",children:[e.jsx("div",{className:"simple-print-status",children:w?e.jsxs("div",{className:"status-ok",children:[e.jsx("span",{className:"status-icon",children:"✓"}),e.jsx("span",{className:"status-text",children:"OK for Print"})]}):e.jsxs("div",{className:"status-warning",children:[e.jsx("span",{className:"status-icon",children:"⚠"}),e.jsx("span",{className:"status-text",children:"Too Small for Print"})]})}),e.jsxs("div",{className:"crop-instructions",children:[e.jsx("p",{children:"• Click and drag inside the blue box to move it"}),e.jsx("p",{children:"• Drag the corner handles to resize"}),e.jsxs("div",{className:"crop-coordinates",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Display:"})," ",Math.round(n.x),", ",Math.round(n.y)," - ",Math.round(n.width),"×",Math.round(n.height)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Original:"})," ",Math.round(se(n).x),", ",Math.round(se(n).y)," - ",Math.round(se(n).width),"×",Math.round(se(n).height)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Scale:"})," ",T.width&&_.width?(_.width/T.width).toFixed(2):"N/A","x"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Image Size:"})," ",_.width,"×",_.height,"px"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Offset Adjustment:"})," 8px left"]})]})]}),e.jsxs("div",{className:"crop-container",ref:D,onMouseDown:E,onMouseMove:R,onMouseUp:U,onMouseLeave:U,children:[e.jsx("img",{src:s,alt:"Crop",className:"crop-image"}),e.jsxs("div",{className:"crop-box",style:{left:n.x,top:n.y,width:n.width,height:n.height},children:[e.jsx("div",{className:"resize-handle top-left",onMouseDown:c=>H("top-left",c)}),e.jsx("div",{className:"resize-handle top-right",onMouseDown:c=>H("top-right",c)}),e.jsx("div",{className:"resize-handle bottom-left",onMouseDown:c=>H("bottom-left",c)}),e.jsx("div",{className:"resize-handle bottom-right",onMouseDown:c=>H("bottom-right",c)})]})]})]}),e.jsxs("div",{className:"simple-crop-footer",children:[e.jsx("button",{className:"crop-btn cancel",onClick:a,children:"Cancel"}),e.jsx("button",{className:"crop-btn apply",onClick:Q,children:"Apply Crop"}),e.jsx("button",{className:"crop-btn feather",onClick:le,children:"✨ Apply Feather & Generate Print Quality"})]})]})}):null},ac=()=>{const[t,s]=l.useState(!1),[r,a]=l.useState(null),[n,i]=l.useState(null),o=y=>{const m=y.target.files[0];if(m){const v=new FileReader;v.onload=u=>{a(u.target.result)},v.readAsDataURL(m)}},d=y=>{i(y),s(!1)},x=()=>{s(!1)};return e.jsxs("div",{className:"print-crop-demo",children:[e.jsxs("div",{className:"demo-header",children:[e.jsx("h2",{children:"Print Crop Tool Demo"}),e.jsx("p",{children:"This is a standalone crop tool designed for print-ready screenshots"})]}),e.jsxs("div",{className:"demo-controls",children:[e.jsxs("div",{className:"file-upload",children:[e.jsx("label",{htmlFor:"image-upload",className:"upload-btn",children:"Choose Screenshot Image"}),e.jsx("input",{id:"image-upload",type:"file",accept:"image/*",onChange:o,style:{display:"none"}})]}),r&&e.jsx("button",{className:"crop-btn",onClick:()=>s(!0),children:"Open Crop Tool"})]}),e.jsxs("div",{className:"demo-images",children:[r&&e.jsxs("div",{className:"image-container",children:[e.jsx("h3",{children:"Original Image"}),e.jsx("img",{src:r,alt:"Original"})]}),n&&e.jsxs("div",{className:"image-container",children:[e.jsx("h3",{children:"Cropped Image"}),e.jsx("img",{src:n,alt:"Cropped"}),e.jsxs("div",{className:"image-info",children:[e.jsx("p",{children:"Preview (scaled down for display)"}),e.jsx("p",{children:"Full size available for download"})]}),e.jsx("a",{href:n,download:"cropped-screenshot.png",className:"download-btn",children:"Download Cropped Image"})]})]}),e.jsx(rc,{isOpen:t,image:r,onCrop:d,onCancel:x})]})},nc=()=>e.jsxs("div",{className:"test-crop-page",children:[e.jsxs("div",{className:"test-header",children:[e.jsx("h1",{children:"🧪 Print Crop Tool Test"}),e.jsx("p",{children:"Testing the new standalone crop tool for print-ready screenshots"}),e.jsxs("div",{className:"test-info",children:[e.jsx("h3",{children:"What to test:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"✅ Upload a screenshot image"}),e.jsx("li",{children:"✅ Drag the crop box to move it"}),e.jsx("li",{children:"✅ Use corner handles (crosshair cursor) to resize"}),e.jsx("li",{children:"✅ Check print size validation (green checkmarks)"}),e.jsx("li",{children:"✅ Apply crop and download result"})]})]})]}),e.jsx(ac,{}),e.jsx("div",{className:"test-footer",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Note:"})," This is a test page. Remove the route and import when done testing."]})})]});class ic{static async getCreatorEarnings(){try{const{data:{user:s}}=await M.auth.getUser();if(!s)throw new Error("User not authenticated");const{data:r,error:a}=await M.from("users").select(`
          total_earnings,
          pending_payout,
          payout_enabled,
          paypal_email,
          last_payout_date,
          payout_threshold
        `).eq("id",s.id).single();if(a)throw a;const{data:n,error:i}=await M.from("creator_earnings").select("*").eq("user_id",s.id).order("created_at",{ascending:!1}).limit(10);if(i)throw i;const{data:o,error:d}=await M.from("payouts").select("*").eq("user_id",s.id).order("payout_date",{ascending:!1}).limit(5);if(d)throw d;return{success:!0,data:{user:r,recentEarnings:n||[],recentPayouts:o||[]}}}catch(s){return console.error("Error getting creator earnings:",s),{success:!1,error:s.message}}}static async updatePaypalEmail(s){try{const{data:{user:r}}=await M.auth.getUser();if(!r)throw new Error("User not authenticated");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s))throw new Error("Please enter a valid PayPal email address");const{error:n}=await M.from("users").update({paypal_email:s,payout_enabled:!0,updated_at:new Date().toISOString()}).eq("id",r.id);if(n)throw n;return{success:!0,message:"PayPal email updated successfully"}}catch(r){return console.error("Error updating PayPal email:",r),{success:!1,error:r.message}}}static async updateTaxInfo(s){try{const{data:{user:r}}=await M.auth.getUser();if(!r)throw new Error("User not authenticated");const{error:a}=await M.from("users").update({tax_id:s,tax_info_verified:!0,updated_at:new Date().toISOString()}).eq("id",r.id);if(a)throw a;return{success:!0,message:"Tax information updated successfully"}}catch(r){return console.error("Error updating tax info:",r),{success:!1,error:r.message}}}static getPayoutSchedule(){return{frequency:"monthly",day:1,minimumAmount:50,processingDays:3,fees:{paypal:.029,platform:.3}}}static getNextPayoutDate(){const s=new Date;return new Date(s.getFullYear(),s.getMonth()+1,1)}static isEligibleForPayout(s){const r=this.getPayoutSchedule();return s>=r.minimumAmount}static formatCurrency(s){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(s)}static async getEarningsSummary(){try{const{data:{user:s}}=await M.auth.getUser();if(!s)throw new Error("User not authenticated");const r=new Date;r.setDate(1),r.setHours(0,0,0,0);const{data:a,error:n}=await M.from("creator_earnings").select("creator_share").eq("user_id",s.id).gte("created_at",r.toISOString());if(n)throw n;const i=a.reduce((x,y)=>x+y.creator_share,0),{data:o,error:d}=await M.from("users").select("total_earnings, pending_payout, payout_enabled").eq("id",s.id).single();if(d)throw d;return{success:!0,data:{monthlyEarnings:i,totalEarnings:o.total_earnings||0,pendingPayout:o.pending_payout||0,payoutEnabled:o.payout_enabled||!1,nextPayoutDate:this.getNextPayoutDate(),isEligible:this.isEligibleForPayout(o.pending_payout||0)}}}catch(s){return console.error("Error getting earnings summary:",s),{success:!1,error:s.message}}}}const Qr=({onComplete:t,onSkip:s,onClose:r})=>{const[a,n]=l.useState("paypal"),[i,o]=l.useState(""),[d,x]=l.useState(""),[y,m]=l.useState(!1),[v,u]=l.useState(null),[g,_]=l.useState(1),[k,T]=l.useState(""),[W,D]=l.useState(""),[$,E]=l.useState("checking"),[R,U]=l.useState(""),[H,se]=l.useState(""),[Q,le]=l.useState("US"),[B,ae]=l.useState([{method_name:"paypal",display_name:"PayPal Business",description:"Fast, secure PayPal Business payments with low fees",fees_percentage:2.9,fees_fixed:.3,processing_time_days:1,min_payout:50,is_available:!0},{method_name:"ach",display_name:"Direct Bank Transfer",description:"Direct deposit to your bank account with minimal fees",fees_percentage:.5,fees_fixed:.25,processing_time_days:3,min_payout:50,is_available:!0},{method_name:"stripe",display_name:"Stripe Connect",description:"Professional payment processing with advanced features",fees_percentage:2.9,fees_fixed:.3,processing_time_days:2,min_payout:25,is_available:!0}]);l.useEffect(()=>{c(),w()},[]);const w=async()=>{console.log("🔄 Loading available payment methods...");const b=[{method_name:"paypal",display_name:"PayPal Business",description:"Fast, secure PayPal Business payments with low fees",fees_percentage:2.9,fees_fixed:.3,processing_time_days:1,min_payout:50,is_available:!0},{method_name:"ach",display_name:"Direct Bank Transfer",description:"Direct deposit to your bank account with minimal fees",fees_percentage:.5,fees_fixed:.25,processing_time_days:3,min_payout:50,is_available:!0},{method_name:"stripe",display_name:"Stripe Connect",description:"Professional payment processing with advanced features",fees_percentage:2.9,fees_fixed:.3,processing_time_days:2,min_payout:25,is_available:!0}];console.log("✅ Setting fallback payment methods:",b),ae(b),setTimeout(()=>{console.log("🔍 State after setting methods:",B)},100);try{const{data:F,error:q}=await M.rpc("get_user_payment_methods",{user_country:"US"});!q&&F&&F.length>0?(console.log("✅ Database payment methods loaded:",F),ae(F)):console.log("ℹ️ Database function not available, using fallback methods")}catch(F){console.log("ℹ️ Database error, using fallback methods:",F.message)}},c=async()=>{try{const b=localStorage.getItem("user_authenticated")==="true",F=localStorage.getItem("user_email");if(!b||!F){console.log("❌ User not authenticated in localStorage");return}const{data:q,error:re}=await M.from("users").select("id, paypal_email, tax_id, payout_enabled, preferred_payment_method, ach_routing_number, ach_account_type, stripe_connect_account_id").eq("email",F).single();q&&(o(q.paypal_email||""),x(q.tax_id||""),n(q.preferred_payment_method||"paypal"),T(q.ach_routing_number||""),E(q.ach_account_type||"checking"),se(q.stripe_connect_account_id||""))}catch(b){console.error("Error loading payment info:",b)}},j=b=>{n(b),u(null)},h=()=>{if(a==="paypal"){if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i))throw new Error("Please enter a valid PayPal email address")}else if(a==="ach"){if(!k||k.length!==9)throw new Error("Please enter a valid 9-digit routing number");if(!W||W.length<4)throw new Error("Please enter a valid account number");if(!R.trim())throw new Error("Please enter the account holder name")}else if(a==="stripe"&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(H))throw new Error("Please enter a valid email for Stripe Connect")},f=async b=>{b.preventDefault(),m(!0),u(null);try{if(new URLSearchParams(window.location.search).get("flow")==="new_user"){localStorage.setItem("pending_payment_method",a),a==="paypal"?localStorage.setItem("pending_paypal_email",i):a==="ach"?localStorage.setItem("pending_ach_info",JSON.stringify({routing:k,account:W,type:$,name:R})):a==="stripe"&&localStorage.setItem("pending_stripe_email",H),_(2);return}const q=localStorage.getItem("user_authenticated")==="true",re=localStorage.getItem("user_email");if(!q||!re)throw new Error("User not authenticated");const{data:Se,error:Te}=await M.from("users").select("id").eq("email",re).single();if(Te||!Se)throw new Error("User not found in database");h();const _e={preferred_payment_method:a,payout_enabled:!0,updated_at:new Date().toISOString()};a==="paypal"?_e.paypal_email=i:a==="ach"?(_e.ach_routing_number=k,_e.ach_account_type=$,_e.ach_account_number_encrypted=btoa(W),_e.bank_account_verified=!1):a==="stripe"&&(_e.stripe_connect_account_id=H,_e.stripe_connect_status="pending");const{error:Qe}=await M.from("users").update(_e).eq("id",Se.id);if(Qe)throw Qe;_(2)}catch(F){u(F.message)}finally{m(!1)}},C=async b=>{b.preventDefault(),m(!0),u(null);try{const F=localStorage.getItem("user_authenticated")==="true",q=localStorage.getItem("user_email");if(!F||!q)throw new Error("User not authenticated");const{data:re,error:Se}=await M.from("users").select("id").eq("email",q).single();if(Se||!re)throw new Error("User not found in database");const{error:Te}=await M.from("users").update({tax_id:d,tax_info_verified:!1,updated_at:new Date().toISOString()}).eq("id",re.id);if(Te)throw Te;t&&t()}catch(F){u(F.message)}finally{m(!1)}},p=()=>{s&&s()},P=()=>{switch(a){case"paypal":return e.jsx("div",{className:"payment-form",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"paypal-email",children:"PayPal Business Email"}),e.jsx("input",{type:"email",id:"paypal-email",value:i,onChange:b=>o(b.target.value),placeholder:"your-business@paypal.com",required:!0}),e.jsx("small",{children:"Make sure this is a PayPal Business account"})]})});case"ach":return e.jsxs("div",{className:"payment-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"ach-account-name",children:"Account Holder Name"}),e.jsx("input",{type:"text",id:"ach-account-name",value:R,onChange:b=>U(b.target.value),placeholder:"John Doe",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"ach-routing",children:"Routing Number"}),e.jsx("input",{type:"text",id:"ach-routing",value:k,onChange:b=>T(b.target.value),placeholder:"123456789",maxLength:"9",required:!0}),e.jsx("small",{children:"9-digit routing number from your bank"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"ach-account",children:"Account Number"}),e.jsx("input",{type:"text",id:"ach-account",value:W,onChange:b=>D(b.target.value),placeholder:"1234567890",required:!0}),e.jsx("small",{children:"Your bank account number"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"ach-type",children:"Account Type"}),e.jsxs("select",{id:"ach-type",value:$,onChange:b=>E(b.target.value),required:!0,children:[e.jsx("option",{value:"checking",children:"Checking"}),e.jsx("option",{value:"savings",children:"Savings"})]})]})]});case"stripe":return e.jsxs("div",{className:"payment-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"stripe-email",children:"Email for Stripe Connect"}),e.jsx("input",{type:"email",id:"stripe-email",value:H,onChange:b=>se(b.target.value),placeholder:"your-email@example.com",required:!0}),e.jsx("small",{children:"This email will be used to set up your Stripe Connect account"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"stripe-country",children:"Country"}),e.jsxs("select",{id:"stripe-country",value:Q,onChange:b=>le(b.target.value),required:!0,children:[e.jsx("option",{value:"US",children:"United States"}),e.jsx("option",{value:"CA",children:"Canada"}),e.jsx("option",{value:"GB",children:"United Kingdom"}),e.jsx("option",{value:"AU",children:"Australia"}),e.jsx("option",{value:"DE",children:"Germany"}),e.jsx("option",{value:"FR",children:"France"})]})]})]});default:return null}},Y=()=>{const b=B.find(F=>F.method_name===a);return b?e.jsxs("div",{className:"payment-benefits",children:[e.jsxs("h4",{children:["Why ",b.display_name,"?"]}),e.jsxs("ul",{children:[e.jsxs("li",{children:["✅ ",b.description]}),e.jsxs("li",{children:["✅ Processing time: ",b.processing_time_days," business day(s)"]}),e.jsxs("li",{children:["✅ Minimum payout: $",b.min_payout]}),e.jsxs("li",{children:["✅ Fees: ",b.fees_percentage,"% + $",b.fees_fixed]})]})]}):null};return console.log("🎯 RENDERING PaymentSetup. availableMethods:",B,"length:",B.length),e.jsx("div",{className:"payment-setup-container",children:e.jsxs("div",{className:"payment-setup-card",children:[e.jsxs("div",{className:"payment-setup-header",children:[e.jsxs("div",{className:"header-content",children:[e.jsx("h2",{children:"💰 Connect Payment Method"}),e.jsx("p",{children:"Please connect your payment method to receive payouts"})]}),r&&e.jsx("button",{className:"payment-setup-close-btn",onClick:r,"aria-label":"Close payment setup",children:"✕"})]}),g===1&&e.jsxs("div",{className:"payment-step",children:[e.jsxs("div",{className:"step-indicator",children:[e.jsx("span",{className:"step active",children:"1"}),e.jsx("span",{className:"step",children:"2"})]}),e.jsx("h3",{children:"Connect Payment Method"}),e.jsx("p",{children:"Please connect your payment method to receive payouts"}),e.jsxs("div",{className:"payment-method-selection",children:[console.log("🔍 Rendering payment methods. availableMethods:",B),B.length===0?e.jsx("div",{className:"loading-methods",children:e.jsx("p",{children:"Loading payment methods..."})}):B.map(b=>e.jsxs("div",{className:`payment-method-option ${a===b.method_name?"selected":""} ${b.is_available?"":"unavailable"}`,onClick:()=>b.is_available&&j(b.method_name),children:[e.jsxs("div",{className:"method-header",children:[e.jsx("input",{type:"radio",name:"payment-method",id:b.method_name,value:b.method_name,checked:a===b.method_name,onChange:()=>b.is_available&&j(b.method_name),disabled:!b.is_available}),e.jsxs("label",{htmlFor:b.method_name,children:[e.jsx("span",{className:"method-name",children:b.display_name}),!b.is_available&&e.jsx("span",{className:"unavailable-badge",children:"Not Available"})]})]}),e.jsxs("div",{className:"method-details",children:[e.jsxs("span",{className:"fees",children:[b.fees_percentage,"% + $",b.fees_fixed]}),e.jsxs("span",{className:"processing-time",children:[b.processing_time_days," day(s)"]})]})]},b.method_name))]}),P(),Y(),e.jsx("div",{className:"form-actions",children:e.jsx("button",{type:"submit",className:"submit-btn",onClick:f,disabled:y,children:y?"Processing...":"Connect Payment Method"})}),v&&e.jsx("div",{className:"error-message",children:v})]}),g===2&&e.jsxs("div",{className:"payment-step",children:[e.jsxs("div",{className:"step-indicator",children:[e.jsx("span",{className:"step completed",children:"1"}),e.jsx("span",{className:"step active",children:"2"})]}),e.jsx("h3",{children:"Connect Payment Method"}),e.jsx("p",{children:"Please connect your payment method to receive payouts"}),e.jsxs("form",{onSubmit:C,className:"payment-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"payment-email",children:"Payment Email"}),e.jsx("input",{type:"email",id:"payment-email",value:d,onChange:b=>x(b.target.value),placeholder:"your-email@example.com",required:!0}),e.jsx("small",{children:"Enter the email associated with your payment method (PayPal, Stripe, etc.)"}),e.jsxs("div",{className:"security-notice",children:[e.jsx("div",{className:"security-icon",children:"🔒"}),e.jsxs("div",{className:"security-text",children:[e.jsx("strong",{children:"Security Notice:"})," Your payment information is securely handled through trusted third-party processors. We never store sensitive payment details."]})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"submit",className:"submit-btn",disabled:y,children:y?"Processing...":"Connect Payment Method"}),e.jsx("button",{type:"button",className:"skip-btn",onClick:p,disabled:y,children:"Skip for Now"})]}),v&&e.jsx("div",{className:"error-message",children:v})]})]})]})})},oc=()=>{var m,v,u,g,_,k,T,W,D,$;const[t,s]=l.useState(null),[r,a]=l.useState(null),[n,i]=l.useState(!0),[o,d]=l.useState(!1),x=je();l.useEffect(()=>{(async()=>{try{const{data:{user:R},error:U}=await M.auth.getUser();if(!R){x("/");return}s(R),await y()}catch(R){console.error("Error fetching user data:",R),x("/")}finally{i(!1)}})()},[x]);const y=async()=>{try{console.log("💰 Starting payment data fetch...");const E=await ic.getCreatorEarnings();E.success?(console.log("💰 Payment data received:",E.data),a(E.data)):console.error("❌ Failed to fetch payment data:",E.error)}catch(E){console.error("❌ Error fetching payment data:",E)}};return n?e.jsx("div",{className:"payment-portal-container",children:e.jsxs("div",{className:"loading-container",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Loading payment portal..."})]})}):t?e.jsxs("div",{className:"payment-portal-container",children:[e.jsxs("div",{className:"payment-portal-header",children:[e.jsx("button",{className:"back-button",onClick:()=>x(-1),children:"← Back"}),e.jsx("h1",{children:"💰 Connect Payment Method"}),e.jsx("p",{children:"Please connect your payment method to receive payouts"})]}),e.jsx("div",{className:"payment-status-section",children:e.jsxs("div",{className:"payment-status-cards",children:[e.jsxs("div",{className:"status-card",children:[e.jsx("h4",{children:"📋 Payment Method"}),e.jsx("div",{className:"status-indicator",children:(m=r==null?void 0:r.user)!=null&&m.payout_enabled?e.jsx("span",{className:"status-success",children:"✅ Complete"}):e.jsx("span",{className:"status-warning",children:"⚠️ Not Set Up"})}),((v=r==null?void 0:r.user)==null?void 0:v.paypal_email)&&e.jsxs("p",{className:"status-detail",children:["PayPal: ",r.user.paypal_email]})]}),e.jsxs("div",{className:"status-card",children:[e.jsx("h4",{children:"💰 Total Earnings"}),e.jsxs("div",{className:"earnings-amount",children:["$",((g=(u=r==null?void 0:r.user)==null?void 0:u.total_earnings)==null?void 0:g.toFixed(2))||"0.00"]}),e.jsx("p",{className:"status-detail",children:"Lifetime earnings"})]}),e.jsxs("div",{className:"status-card",children:[e.jsx("h4",{children:"💸 Pending Payout"}),e.jsxs("div",{className:"pending-amount",children:["$",((k=(_=r==null?void 0:r.user)==null?void 0:_.pending_payout)==null?void 0:k.toFixed(2))||"0.00"]}),e.jsx("p",{className:"status-detail",children:((T=r==null?void 0:r.user)==null?void 0:T.pending_payout)>=50?"Ready for payout":"Min $50 required"})]}),e.jsxs("div",{className:"status-card",children:[e.jsx("h4",{children:"📅 Next Payout"}),e.jsx("div",{className:"payout-date",children:(W=r==null?void 0:r.user)!=null&&W.last_payout_date?new Date(r.user.last_payout_date).toLocaleDateString():"Not scheduled"}),e.jsx("p",{className:"status-detail",children:"Monthly on the 1st"})]})]})}),e.jsxs("div",{className:"payment-setup-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h3",{children:"🔧 Payment Method Required"}),!((D=r==null?void 0:r.user)!=null&&D.payout_enabled)&&e.jsx("button",{className:"setup-payment-btn",onClick:()=>d(!0),children:"Connect Payment Method"})]}),o?e.jsx("div",{className:"payment-setup-modal",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h4",{children:"Connect Payment Method"}),e.jsx("button",{className:"close-btn",onClick:()=>d(!1),children:"×"})]}),e.jsx(Qr,{onComplete:()=>{d(!1),y()},onSkip:()=>d(!1),onClose:()=>d(!1)})]})}):e.jsx("div",{className:"setup-info",children:($=r==null?void 0:r.user)!=null&&$.payout_enabled?e.jsxs("div",{className:"setup-complete",children:[e.jsx("p",{children:"✅ Your payment method is connected and ready to receive payouts."}),e.jsx("button",{className:"edit-payment-btn",onClick:()=>d(!0),children:"Edit Payment Method"})]}):e.jsxs("div",{className:"setup-required",children:[e.jsx("p",{children:"⚠️ Complete your tax information to receive payouts"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Connect your payment method"}),e.jsx("li",{children:"Complete payment setup"}),e.jsx("li",{children:"Set up automatic monthly payouts"})]})]})})]}),(r==null?void 0:r.recentEarnings)&&r.recentEarnings.length>0&&e.jsxs("div",{className:"recent-earnings-section",children:[e.jsx("h3",{children:"📈 Recent Earnings"}),e.jsx("div",{className:"earnings-list",children:r.recentEarnings.map((E,R)=>{var U;return e.jsxs("div",{className:"earning-item",children:[e.jsxs("div",{className:"earning-info",children:[e.jsxs("span",{className:"earning-amount",children:["$",(U=E.amount)==null?void 0:U.toFixed(2)]}),e.jsx("span",{className:"earning-date",children:new Date(E.created_at).toLocaleDateString()})]}),e.jsx("div",{className:"earning-source",children:E.source||"Product Sale"})]},R)})})]}),(r==null?void 0:r.recentPayouts)&&r.recentPayouts.length>0&&e.jsxs("div",{className:"recent-payouts-section",children:[e.jsx("h3",{children:"💸 Recent Payouts"}),e.jsx("div",{className:"payouts-list",children:r.recentPayouts.map((E,R)=>{var U;return e.jsxs("div",{className:"payout-item",children:[e.jsxs("div",{className:"payout-info",children:[e.jsxs("span",{className:"payout-amount",children:["$",(U=E.amount)==null?void 0:U.toFixed(2)]}),e.jsx("span",{className:"payout-date",children:new Date(E.payout_date).toLocaleDateString()})]}),e.jsx("div",{className:"payout-status",children:e.jsx("span",{className:`status-badge ${E.status}`,children:E.status})})]},R)})})]}),e.jsxs("div",{className:"payment-info-section",children:[e.jsx("h3",{children:"ℹ️ Payment Method"}),e.jsxs("div",{className:"info-grid",children:[e.jsxs("div",{className:"info-card",children:[e.jsx("h4",{children:"💰 Payment Method"}),e.jsx("p",{children:"Connect payment method to receive payouts"})]}),e.jsxs("div",{className:"info-card",children:[e.jsx("h4",{children:"📅 Payout Schedule"}),e.jsx("p",{children:"Payouts are processed monthly on the 1st of each month for earnings above $50.00."})]}),e.jsxs("div",{className:"info-card",children:[e.jsx("h4",{children:"📊 Tax Reporting"}),e.jsx("p",{children:"Complete tax forms to receive payouts"})]}),e.jsxs("div",{className:"info-card",children:[e.jsx("h4",{children:"🔒 Security"}),e.jsx("p",{children:"Connect payment method to receive payouts"})]})]})]})]}):e.jsx("div",{className:"payment-portal-container",children:e.jsxs("div",{className:"error-container",children:[e.jsx("p",{children:"Please log in to access the payment portal."}),e.jsx("button",{onClick:()=>x("/"),children:"Go Home"})]})})},lc=()=>{const t=je(),[s,r]=l.useState([]),[a,n]=l.useState(0),[i,o]=l.useState({cost:0,method:"Standard Shipping",loading:!1,error:""}),[d,x]=l.useState({country_code:"US",zip:""});l.useEffect(()=>{try{const m=localStorage.getItem("cart_items"),v=m?JSON.parse(m):[];r(v),n(v.reduce((u,g)=>u+(g.price||0)*(g.qty||1),0))}catch{r([]),n(0)}},[]);const y=async()=>{if(s.length!==0){o(m=>({...m,loading:!0,error:""}));try{const m={shipping_address:d,cart:s.map(g=>({variant_id:g.printify_variant_id||g.printful_variant_id||1,quantity:g.qty||1}))},u=await(await fetch(ve.ENDPOINTS.CALCULATE_SHIPPING,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)})).json();u&&u.success?o({cost:u.shipping_cost||0,method:u.shipping_method||"Standard Shipping",loading:!1,error:""}):o({cost:5.99,method:"Standard Shipping",loading:!1,error:(u==null?void 0:u.error)||"Unable to fetch shipping"})}catch{o({cost:5.99,method:"Standard Shipping",loading:!1,error:"Network error"})}}};return e.jsxs("div",{className:"checkout-container",children:[e.jsxs("div",{className:"checkout-header",children:[e.jsx("h1",{children:"Checkout"}),e.jsxs("div",{className:"checkout-progress",children:[e.jsx("div",{className:"progress-step active",children:"1. Review"}),e.jsx("div",{className:"progress-step",children:"2. Payment"}),e.jsx("div",{className:"progress-step",children:"3. Complete"})]})]}),s.length===0?e.jsxs("div",{className:"empty-cart",children:[e.jsx("div",{className:"empty-cart-icon",children:"🛒"}),e.jsx("h2",{children:"Your cart is empty"}),e.jsx("p",{children:"Add some items to your cart to continue"}),e.jsx("button",{className:"btn-primary",onClick:()=>t(-1),children:"Continue Shopping"})]}):e.jsxs("div",{className:"checkout-content",children:[e.jsxs("div",{className:"checkout-main",children:[e.jsxs("div",{className:"order-section",children:[e.jsx("h2",{children:"Order Items"}),e.jsx("div",{className:"items-list",children:s.map((m,v)=>e.jsxs("div",{className:"item-card",children:[m.image&&e.jsx("div",{className:"item-image",children:e.jsx("img",{src:m.image,alt:m.name})}),e.jsxs("div",{className:"item-details",children:[e.jsx("h3",{className:"item-name",children:m.name}),e.jsxs("div",{className:"item-variants",children:[m.color," • ",m.size]})]}),e.jsxs("div",{className:"item-price",children:["$",(m.price||0).toFixed(2)]})]},v))})]}),e.jsxs("div",{className:"order-section",children:[e.jsx("h2",{children:"Shipping Information"}),e.jsxs("div",{className:"shipping-form",children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ZIP / Postal Code"}),e.jsx("input",{type:"text",placeholder:"Enter ZIP code",value:d.zip,onChange:m=>x(v=>({...v,zip:m.target.value})),className:"form-input","aria-label":"ZIP or Postal Code","aria-describedby":"zip-help"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Country"}),e.jsxs("select",{value:d.country_code,onChange:m=>x(v=>({...v,country_code:m.target.value})),className:"form-select","aria-label":"Country",children:[e.jsx("option",{value:"US",children:"United States"}),e.jsx("option",{value:"CA",children:"Canada"}),e.jsx("option",{value:"GB",children:"United Kingdom"}),e.jsx("option",{value:"AU",children:"Australia"}),e.jsx("option",{value:"DE",children:"Germany"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:" "}),e.jsx("button",{className:"btn-secondary",onClick:y,disabled:i.loading,children:i.loading?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"loading-spinner"}),"Calculating…"]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"🚚"}),"Calculate Shipping"]})})]})]}),i.error&&e.jsx("div",{className:"error-message",children:i.error}),e.jsxs("div",{className:"shipping-result",children:[e.jsx("div",{className:"shipping-method",children:i.method}),e.jsxs("div",{className:"shipping-cost",children:["$",i.cost.toFixed(2)]})]})]})]})]}),e.jsxs("div",{className:"order-summary",children:[e.jsx("h2",{children:"Order Summary"}),e.jsxs("div",{className:"summary-line",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{children:["$",a.toFixed(2)]})]}),e.jsxs("div",{className:"summary-line",children:[e.jsx("span",{children:"Shipping"}),e.jsxs("span",{children:["$",i.cost.toFixed(2)]})]}),e.jsxs("div",{className:"summary-line total",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["$",(a+(i.cost||0)).toFixed(2)]})]}),e.jsxs("div",{className:"checkout-actions",children:[e.jsx("button",{className:"btn-outline",onClick:()=>t(-1),children:"Continue Shopping"}),e.jsxs("button",{className:"btn-primary btn-large",onClick:async m=>{var g,_,k,T,W;const v=m.target,u=v.innerHTML;v.innerHTML='<span className="loading-spinner"></span>Processing Order...',v.disabled=!0;try{const D={cart:s.map(R=>({product:R.product||R.name,variants:{color:R.color,size:R.size},img:R.image,price:R.price})),product_id:((g=s[0])==null?void 0:g.product_id)||((_=s[0])==null?void 0:_.id)||"",sms_consent:!1,shipping_cost:i.cost||0,videoUrl:(k=s[0])==null?void 0:k.video_url,videoTitle:(T=s[0])==null?void 0:T.video_title,creatorName:(W=s[0])==null?void 0:W.creator_name},E=await(await fetch(ve.ENDPOINTS.CREATE_CHECKOUT_SESSION,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(D)})).json();if(E!=null&&E.url)window.location.href=E.url;else try{const U=await(await fetch(ve.ENDPOINTS.PLACE_ORDER,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(D)})).json();U!=null&&U.next_url?window.location.href=U.next_url:(v.innerHTML=u,v.disabled=!1,alert((E==null?void 0:E.error)||(U==null?void 0:U.error)||"Failed to start checkout"))}catch{v.innerHTML=u,v.disabled=!1,alert("Network error starting checkout")}}catch{v.innerHTML=u,v.disabled=!1,alert("Network error starting checkout")}},children:[e.jsx("span",{children:"Place Order"}),e.jsx("span",{className:"btn-icon",children:"→"})]})]})]})]})]})},cc=()=>{const t=je(),s=wt(),[r,a]=l.useState(null),[n,i]=l.useState(!0);l.useEffect(()=>{(async()=>{try{const{data:{user:y},error:m}=await M.auth.getUser(),v=new URLSearchParams(window.location.search).get("flow")==="new_user";if(!y&&!v){t("/signup",{state:{from:s.pathname,message:"Please sign up to set up your payment information and start earning."}});return}a(y)}catch(y){console.error("Error checking authentication:",y),new URLSearchParams(window.location.search).get("flow")==="new_user"||t("/signup")}finally{i(!1)}})()},[t,s]);const o=()=>{new URLSearchParams(window.location.search).get("flow")==="new_user"?t("/signup",{state:{message:"Great! Your PayPal is set up. Now create your account to start earning!"}}):t("/dashboard",{state:{message:"Payment information set up successfully! You can now start earning with ScreenMerch - completely free!"}})},d=()=>{new URLSearchParams(window.location.search).get("flow")==="new_user"?t("/signup",{state:{message:"No problem! You can set up PayPal later. Let's create your account!"}}):t("/dashboard",{state:{message:"Welcome to ScreenMerch! You can set up payment information later in your dashboard to start earning."}})};return n?e.jsx("div",{className:"payment-setup-page",children:e.jsxs("div",{className:"loading-container",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Loading..."})]})}):e.jsxs("div",{className:"payment-setup-page",children:[e.jsxs("div",{className:"payment-setup-header",children:[e.jsx("h1",{children:"💰 Welcome to ScreenMerch!"}),e.jsx("p",{children:"Set up your payment information to start earning from your merchandise sales - It's completely free!"})]}),e.jsx(Qr,{onComplete:o,onSkip:d})]})},dc=()=>{const[t,s]=l.useState(!1),[r,a]=l.useState(0),[n,i]=l.useState(null),[o,d]=l.useState("All"),x=()=>d("All"),y=wt();l.useEffect(()=>{(async()=>{const u=y.pathname.match(/^\/profile\/(.+)$/);if(u){const g=u[1];try{const _=await fetch(`${ve.ENDPOINTS.USER_SUBSCRIPTION}/${g}/subscription`);if(_.ok){const k=await _.json();i(k)}else i({isThirdTier:!1})}catch(_){console.error("Error fetching subscription data:",_),i({isThirdTier:!1})}}else i(null)})()},[y.pathname]);const m=t&&!(n!=null&&n.isThirdTier);return console.log("🚀 App.jsx rendering - current path:",y.pathname),e.jsxs("div",{style:{display:"flex",flexDirection:"column",minHeight:"100vh"},children:[e.jsx(Ca,{setSidebar:s,resetCategory:x}),e.jsxs("div",{style:{display:"flex",flex:1},children:[m&&e.jsx(ql,{sidebar:t,category:r,setCategory:a}),e.jsxs("div",{className:"main-content-area",style:{flex:1,display:"flex",flexDirection:"column"},children:[e.jsx("div",{style:{flex:1},children:e.jsxs(ua,{children:[e.jsx(ue,{path:"/",element:e.jsx(Ul,{sidebar:t,category:r,selectedCategory:o,setSelectedCategory:d})}),e.jsx(ue,{path:"/video/:categoryId/:videoId",element:e.jsx(Ll,{sidebar:t})}),e.jsx(ue,{path:"/upload",element:e.jsx(Fl,{sidebar:t})}),e.jsx(ue,{path:"/profile/:username",element:e.jsx(Wl,{sidebar:t})}),e.jsx(ue,{path:"/approve-subscription",element:e.jsx($l,{})}),e.jsx(ue,{path:"/dashboard",element:e.jsx(Bl,{sidebar:t})}),e.jsx(ue,{path:"/subscription-tiers",element:e.jsx(Hl,{})}),e.jsx(ue,{path:"/subscription-success",element:e.jsx(Vl,{})}),e.jsx(ue,{path:"/success",element:e.jsx(zl,{})}),e.jsx(ue,{path:"/coming-soon",element:e.jsx(Jl,{})}),e.jsx(ue,{path:"/admin",element:e.jsx(Zl,{})}),e.jsx(ue,{path:"/auth",element:e.jsx(Xl,{})}),e.jsx(ue,{path:"/login",element:e.jsx(ar,{})}),e.jsx(ue,{path:"/signup",element:e.jsx(ar,{})}),e.jsx(ue,{path:"/privacy-policy",element:e.jsx(Ql,{})}),e.jsx(ue,{path:"/terms-of-service",element:e.jsx(Kl,{})}),e.jsx(ue,{path:"/search",element:e.jsx(ec,{})}),e.jsx(ue,{path:"/merchandise",element:e.jsx(tc,{sidebar:t})}),e.jsx(ue,{path:"/product/:productId",element:e.jsx(sc,{sidebar:t})}),e.jsx(ue,{path:"/test-crop-tool",element:e.jsx(nc,{})}),e.jsx(ue,{path:"/payment-portal",element:e.jsx(oc,{})}),e.jsx(ue,{path:"/checkout",element:e.jsx(lc,{})}),e.jsx(ue,{path:"/payment-setup",element:e.jsx(cc,{})})]})}),e.jsx(Pa,{})]})]})]})};console.log("Cache busted - FORCING API CONFIG OVERRIDE");console.log("Timestamp:",new Date().toISOString());console.log("Build ID:",Math.random().toString(36).substring(7));console.log("🔧 FORCING BACKEND URL TO: https://screenmerch.fly.dev");us.createRoot(document.getElementById("root")).render(e.jsx(ma.StrictMode,{children:e.jsx(pa,{children:e.jsx(dc,{})})}))});export default hc();
