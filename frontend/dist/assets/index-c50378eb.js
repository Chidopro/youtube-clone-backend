var Lr=(e,s)=>()=>(s||e((s={exports:{}}).exports,s),s.exports);import{r as l,a as Fr,u as ge,L as pe,b as hs,N as Wr,d as us,e as ms,R as Vr,f as de,h as $r,B as Br}from"./vendor-86b923c5.js";import{c as Hr}from"./supabase-b5a349d0.js";var Rl=Lr((Hl,At)=>{(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var Hs={exports:{}},Ot={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zr=l,Gr=Symbol.for("react.element"),qr=Symbol.for("react.fragment"),Jr=Object.prototype.hasOwnProperty,Zr=zr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Xr={key:!0,ref:!0,__self:!0,__source:!0};function zs(e,s,r){var a,n={},i=null,o=null;r!==void 0&&(i=""+r),s.key!==void 0&&(i=""+s.key),s.ref!==void 0&&(o=s.ref);for(a in s)Jr.call(s,a)&&!Xr.hasOwnProperty(a)&&(n[a]=s[a]);if(e&&e.defaultProps)for(a in s=e.defaultProps,s)n[a]===void 0&&(n[a]=s[a]);return{$$typeof:Gr,type:e,key:i,ref:o,props:n,_owner:Zr.current}}Ot.Fragment=qr;Ot.jsx=zs;Ot.jsxs=zs;Hs.exports=Ot;var t=Hs.exports,rs={},Is=Fr;rs.createRoot=Is.createRoot,rs.hydrateRoot=Is.hydrateRoot;const Qr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAhCAYAAABN2CLhAAAAAXNSR0IArs4c6QAAARhJREFUWAntWNENgjAQpYYBdAM3EDZgA9lAnMC4ARs4AnWDuoEbqBt0BNjA9z5M+kNaI8WS3CWXUO64vr42uUdV0zRVlmUXeAFP2SzAGa31WQH0A4PUAbtkliuMNu6bBTwXBG0WANSFaBRHOCI8HrUbSfDZAhPPdJ8gNoEkDAgDwoAwsHQGKJi2WMQJzq74L+uVUqbrumsIAII2SNyHJM+QU6JNP33zUDBVvqQZ43XIXKmpPO6613JktHBuSdAqkRfDLIpSwRGHmDAgDAgDwoAwMD8Dn3sPdsPdBNP3qHFDZ7MT1BotkUPlaUQPoxnfB1p8EvWqjYJpas2xBhEV6kYzgr5HqB5V+BB0C+cfwwD/1V4ocIx93/YG6YM08g0WFTYAAAAASUVORK5CYII=",Rt="/assets/screenmerch_logo.png-13fa081f.png",Kr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAYCAYAAAARfGZ1AAAAAXNSR0IArs4c6QAAAh5JREFUSA2tlDFP60AMx0m6doCJkZGxfRIDEwoDAxNlKSuv6ohE+QCIdGOEiaGVyjcARrYgsTd8kac3MLf8fLWPS0hRW9WSY5/v778dXy7RxhwZjUYtthpogjZRkRzNptNp3ul0Xlzkl0dU3oNUiEaoEZYhtpZCfxGxlRKHUYhT1mO0SXcf2D56iG6pit/XPSk+JucGWym+cyU24D0d9SozCILdxKToJSpyBf5u5n4/HTlg14WGTwE+f0Pme+S12H1SxJ/yiNxYeM1HBUjHCxELXrH3mivnVJBYqkdR1JA5Au4VdhdbpHYG+iY+SzpvyooCC3fss3Fo6H+Q67hsP6ZqoovMgitYlxtwOQrfOat8BVJLcbkyXguILXzn4cYqPp37T9vIrePCvJYkt1zjcukxr5IpUaJ2FeNyAy7HIWOxaid8SpvLMmvOieYZ14xcLoJ9p0RSBS1jJMf9i/RS+Vx3oLzOuUYuyxfBIyscxbr/S8Dhkf50AaZE7cd1h9+XC+KRgaOjEGxPw1dgJacgnlyipQI5IRlZRlfy+93Ab+AnuC20iYrcEt+bTCZn3W733yw0exbIJUQBmd8jJIULESaJD+ZDR/HAcp/1uF6vH7Tb7U/D/iC3DYq47khKiFmXOYQZ69wObzgc7sRx/EZ8B+w7BY6twFxyCBYWLfBKgd2wwFrIpYvBYLBdq9XkDVwB7NHayCsKXK+VPChwwezTL5f411qp3J6CAAAAAElFTkSuQmCC",Ys="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAAAidJREFUaAXtmN1NwzAQx++SSuWNVPAOGxBASOWJbAAjdISyAWzABu0mLU8UISAjtO9IgQFic1fJUWi+HLBaB9kPdXK+2P79a+cuBnDFKeAUcAo4BZwCToH/owAqlCQMg7TvTxBkBIiBsm+zlgBzP01vBy9x3HZcTz1AEFNEuNkVBM+DVI2E581YVDWvqpp9kmF4rNozEIK4Vsad1rwa9iCsmwNDiL4/I59j5ZeBKIPtdQaBP2E7BVIFweL3TPwDB4vX7KWh+vsYns0R8Erd/7Wug+C+O/GPNEF0AkQHwnoQXQirQdpAMIiRzc4dmSyp8APsw4wiZG08yY9pJQiinLTNMDRB5IryoGVegaZrlBBL+ikrZA5ooidlbWvbL3I9TRCYHi7e7ioHLmk4eH4bl5jXJsqRIgE+pxjGSifiiA6tA9FRaZs+unvkKLk8rcybBk/vj5uTTi7CEHq4v2nneyG8E/74MFk0QXAkJI5qBi5MK/W9B5QVSWPBu6ZnzSY794iUtyDhS5Nh7WYliIci9kQatYGxEoQl5gOINjDWgrSFsRqkDYz1ILowmq9f7q66fAzPC3kTSmk0VvCeodhE517+nGJQIT4ZAaGwEBUw6aDMdKmD6cTSygtS9TbLgchV/oEdXy/rxs9gUvhUftnSkgLHtBqmZetPOW+nlveDRbxsGoth8j4/FjJ/8Dedu+YfNn5NCm9O0PgYrkOngFPAKeAUcAr8ZwW+ASU7qyTOpG88AAAAAElFTkSuQmCC",ea={development:{API_BASE_URL:"http://127.0.0.1:5000",EMAIL_API_URL:"http://localhost:3001",SUBSCRIPTION_API_URL:"http://localhost:3002",SUPABASE_URL:"https://sojxbydpcdcdzfdtbypd.supabase.co",SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNvanhieWRwY2RjZHpmZHRieXBkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4NTIwNTUsImV4cCI6MjA2NTQyODA1NX0.BUm9LKbNs-EdJKxwwtoY3IRyokmDtRbS0XP-WBw-5no"},production:{API_BASE_URL:"https://backend-hidden-firefly-7865.fly.dev",EMAIL_API_URL:"https://backend-hidden-firefly-7865.fly.dev",SUBSCRIPTION_API_URL:"https://backend-hidden-firefly-7865.fly.dev",SUPABASE_URL:"https://sojxbydpcdcdzfdtbypd.supabase.co",SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNvanhieWRwY2RjZHpmZHRieXBkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4NTIwNTUsImV4cCI6MjA2NTQyODA1NX0.BUm9LKbNs-EdJKxwwtoY3IRyokmDtRbS0XP-WBw-5no"}},ve={...ea.production,API_BASE_URL:"https://backend-hidden-firefly-7865.fly.dev",EMAIL_API_URL:"https://backend-hidden-firefly-7865.fly.dev",SUBSCRIPTION_API_URL:"https://backend-hidden-firefly-7865.fly.dev"},he={BASE_URL:ve.API_BASE_URL,EMAIL_API_URL:ve.EMAIL_API_URL,SUBSCRIPTION_API_URL:ve.SUBSCRIPTION_API_URL,SUPABASE_URL:ve.SUPABASE_URL,SUPABASE_ANON_KEY:ve.SUPABASE_ANON_KEY,ENDPOINTS:{CREATE_PRODUCT:`${ve.API_BASE_URL}/api/create-product`,SEND_SUBSCRIPTION_EMAIL:`${ve.EMAIL_API_URL}/api/send-subscription-email`,VERIFY_SUBSCRIPTION:`${ve.SUBSCRIPTION_API_URL}/api/verify-subscription`,USER_SUBSCRIPTION:`${ve.SUBSCRIPTION_API_URL}/api/users`,CAPTURE_SCREENSHOT:`${ve.API_BASE_URL}/api/capture-screenshot`,CAPTURE_MULTIPLE_SCREENSHOTS:`${ve.API_BASE_URL}/api/capture-multiple-screenshots`,VIDEO_INFO:`${ve.API_BASE_URL}/api/video-info`}},ta=({isOpen:e,onClose:s})=>{const[r,a]=l.useState(""),[n,i]=l.useState(!1),[o,c]=l.useState(""),[u,f]=l.useState(""),j=async M=>{if(M.preventDefault(),!r){c("Please enter a valid email address"),f("error");return}i(!0),c("");try{const v=await fetch(he.ENDPOINTS.SEND_SUBSCRIPTION_EMAIL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r})}),d=await v.json();if(v.ok)c(`Subscription email sent to ${r}! Please check your inbox for approval link.`),f("success"),a(""),setTimeout(()=>{s(),c("")},3e3);else throw new Error(d.error||"Failed to send email")}catch(v){console.error("Error:",v),v.message.includes("fetch")?c("Backend server is not running. Please start the backend server first."):c(`Failed to send email: ${v.message}`),f("error")}finally{i(!1)}};return e?t.jsx("div",{className:"modal-overlay",onClick:s,children:t.jsxs("div",{className:"modal-content",onClick:M=>M.stopPropagation(),children:[t.jsxs("div",{className:"modal-header",children:[t.jsx("h2",{children:"Subscribe to ScreenMerch"}),t.jsx("button",{className:"close-btn",onClick:s,children:"×"})]}),t.jsxs("div",{className:"modal-body",children:[t.jsx("p",{children:"Enter your email to receive a subscription approval link:"}),t.jsxs("form",{onSubmit:j,children:[t.jsx("div",{className:"email-input-group",children:t.jsx("input",{type:"email",value:r,onChange:M=>a(M.target.value),placeholder:"Enter your email address",required:!0,disabled:n})}),o&&t.jsx("div",{className:`message ${u}`,children:o}),t.jsxs("div",{className:"modal-actions",children:[t.jsx("button",{type:"button",className:"cancel-btn",onClick:s,disabled:n,children:"Cancel"}),t.jsx("button",{type:"submit",className:"subscribe-modal-btn",disabled:n,children:n?"Sending...":"Send Approval Link"})]})]})]})]})}):null},sa=he.SUPABASE_URL,ra=he.SUPABASE_ANON_KEY,_=Hr(sa,ra,{auth:{redirectTo:window.location.origin}});typeof window<"u"&&(window.supabase=_,window.__SUPABASE__=_);console.log("VITE ENV:",{VITE_API_BASE_URL:"https://screenmerch.onrender.com",VITE_SUPABASE_URL:"https://sojxbydpcdcdzfdtbypd.supabase.co",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNvanhieWRwY2RjZHpmZHRieXBkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4NTIwNTUsImV4cCI6MjA2NTQyODA1NX0.BUm9LKbNs-EdJKxwwtoY3IRyokmDtRbS0XP-WBw-5no",VITE_API_URL:"https://screenmerch.onrender.com",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1});class aa{static async getCurrentUserProfile(){try{const{data:{user:s}}=await _.auth.getUser();if(!s)return null;const{data:r,error:a}=await _.from("users").select("*").eq("id",s.id).single();return a?(console.error("Error fetching user profile:",a),null):r}catch(s){return console.error("Error in getCurrentUserProfile:",s),null}}static async upsertUserProfile(s){try{const{data:{user:r}}=await _.auth.getUser();if(!r)throw new Error("No authenticated user");const a={id:r.id,email:r.email,role:"creator",...s,updated_at:new Date().toISOString()},{data:n,error:i}=await _.from("users").upsert(a,{onConflict:"id",ignoreDuplicates:!1}).select().single();return i?(console.error("Error upserting user profile:",i),null):n}catch(r){return console.error("Error in upsertUserProfile:",r),null}}static async updateUserProfile(s){try{const{data:{user:r}}=await _.auth.getUser();if(!r)throw new Error("No authenticated user");const{data:a,error:n}=await _.from("users").update(s).eq("id",r.id).select().single();return n?(console.error("Error updating user profile:",n),null):a}catch(r){return console.error("Error in updateUserProfile:",r),null}}static async getUserProfileById(s){try{const{data:r,error:a}=await _.from("users").select("id, display_name, profile_image_url, cover_image_url, bio, created_at").eq("id",s).single();return a?(console.error("Error fetching user profile by ID:",a),null):r}catch(r){return console.error("Error in getUserProfileById:",r),null}}static async uploadProfileImage(s,r="profile-images"){try{const{data:{user:a}}=await _.auth.getUser();if(!a)throw new Error("No authenticated user");const n=s.name.split(".").pop(),i=`${a.id}-${Date.now()}.${n}`,o=`${r}/${i}`,{data:c,error:u}=await _.storage.from("profile-images").upload(o,s);if(u)return console.error("Error uploading profile image:",u),null;const{data:{publicUrl:f}}=_.storage.from("profile-images").getPublicUrl(o);return f}catch(a){return console.error("Error in uploadProfileImage:",a),null}}static async deleteProfileImage(s){try{const r=s.split("/"),n=`profile-images/${r[r.length-1]}`,{error:i}=await _.storage.from("profile-images").remove([n]);return i?(console.error("Error deleting profile image:",i),!1):!0}catch(r){return console.error("Error in deleteProfileImage:",r),!1}}static async deleteUserAccount(){try{const{data:{user:s}}=await _.auth.getUser();if(!s)return{success:!1,error:"No authenticated user found"};const r=await fetch(`https://backend-hidden-firefly-7865.fly.dev/api/users/${s.id}/delete-account`,{method:"DELETE",headers:{"Content-Type":"application/json"}});return r.ok?await r.json():{success:!1,error:(await r.json()).error||"Failed to delete account"}}catch(s){return console.error("Error in deleteUserAccount:",s),{success:!1,error:s.message}}}}const{getCurrentUserProfile:Fl,upsertUserProfile:na,updateUserProfile:Wl,getUserProfileById:Vl,uploadProfileImage:$l,deleteProfileImage:Bl,deleteUserAccount:ia}=aa,oa=({setSidebar:e,resetCategory:s})=>{var X,W,z;const[r,a]=l.useState(!1),[n,i]=l.useState(null),[o,c]=l.useState(!0),[u,f]=l.useState(!1),[j,M]=l.useState(""),v=ge();l.useEffect(()=>{const R=async()=>{var b,P,g;const{data:{user:J}}=await _.auth.getUser();if(i(J),c(!1),J){const A={id:J.id,username:((P=(b=J.user_metadata)==null?void 0:b.name)==null?void 0:P.replace(/\s+/g,"").toLowerCase())||J.email,display_name:((g=J.user_metadata)==null?void 0:g.name)||J.email,email:J.email,role:"creator"};console.log("Upserting user profile with:",A);const p=await na(A);console.log("Upsert result:",p)}};R();const{data:{subscription:L}}=_.auth.onAuthStateChange(()=>{R()});return()=>L.unsubscribe()},[]),l.useEffect(()=>{const R=L=>{u&&!L.target.closest(".user-profile-container")&&f(!1)};return document.addEventListener("click",R),()=>document.removeEventListener("click",R)},[u]);const d=async()=>{const{error:R}=await _.auth.signInWithOAuth({provider:"google",options:{queryParams:{prompt:"select_account"}}});R&&alert("Login failed: "+R.message)},T=async()=>{await _.auth.signOut(),i(null),v("/")},w=async()=>{if(window.confirm("Are you sure you want to delete your account? This action cannot be undone."))try{const R=await ia();R.success?(await _.auth.signOut(),i(null),v("/"),alert("Your account has been successfully deleted."),window.location.reload()):alert(`Failed to delete account: ${R.error||"Unknown error"}`)}catch(R){console.error("Error deleting account:",R),alert("There was an error deleting your account. Please try again or contact support.")}},x=()=>{v("/subscription")},F=()=>{a(!1)},h=R=>{M(R.target.value)},N=()=>{j.trim()&&v(`/search?q=${encodeURIComponent(j.trim())}`)},H=R=>{R.key==="Enter"&&N()};return t.jsxs(t.Fragment,{children:[t.jsxs("nav",{className:"flex-div",children:[t.jsxs("div",{className:"nav-left flex-div",children:[t.jsx("img",{src:Qr,alt:"",className:"menu-icon",onClick:()=>e(R=>!R)}),t.jsxs(pe,{to:"/",onClick:s,children:[" ",t.jsx("img",{src:Rt,alt:"",className:"logo"})]})]}),t.jsx("div",{className:"nav-middle flex-div",children:t.jsxs("div",{className:"search-box flex-div",children:[t.jsx("input",{type:"text",placeholder:"Search creators...",value:j,onChange:h,onKeyPress:H}),t.jsx("img",{src:Kr,alt:"Search",onClick:N,style:{cursor:"pointer"},title:"Search creators"})]})}),t.jsxs("div",{className:"nav-right flex-div",children:[n?t.jsx(pe,{to:"/upload",children:t.jsx("img",{src:Ys,alt:"Upload"})}):t.jsx("img",{src:Ys,alt:"Upload",style:{cursor:"pointer"},onClick:d,title:"Sign in to upload videos"}),t.jsx("button",{className:"subscribe-btn",onClick:x,children:"Subscribe"}),o?t.jsx("div",{className:"loading-spinner-navbar"}):n?t.jsxs("div",{className:"user-profile-container",children:[t.jsx("img",{className:"user-profile",src:((X=n==null?void 0:n.user_metadata)==null?void 0:X.picture)||"/default-avatar.jpg",alt:((W=n==null?void 0:n.user_metadata)==null?void 0:W.name)||"User",onClick:()=>f(!u)}),t.jsxs("div",{className:`user-dropdown ${u?"open":""}`,children:[t.jsxs("p",{children:["Signed in as ",t.jsx("strong",{children:(z=n==null?void 0:n.user_metadata)==null?void 0:z.name})]}),t.jsx("hr",{}),t.jsx(pe,{to:"/dashboard",className:"dropdown-item",onClick:()=>f(!1),children:"Dashboard"}),t.jsx(pe,{to:"/admin",className:"dropdown-item",onClick:()=>f(!1),children:"Admin Portal"}),t.jsx("button",{onClick:R=>{R.preventDefault(),R.stopPropagation(),f(!1),w()},className:"dropdown-item delete-account-btn",children:"Delete Account"}),t.jsx("button",{onClick:()=>{f(!1),T()},children:"Logout"})]})]}):t.jsx("button",{className:"sign-in-btn",onClick:d,children:"Sign In"})]})]}),t.jsx(ta,{isOpen:r,onClose:F})]})},la=()=>t.jsx("footer",{className:"site-footer",children:t.jsx("div",{className:"footer-container",children:t.jsxs("div",{className:"footer-content",children:[t.jsx("div",{className:"footer-logo-section",children:t.jsx("img",{src:Rt,alt:"ScreenMerch",className:"footer-logo"})}),t.jsxs("div",{className:"footer-links-section",children:[t.jsx(pe,{to:"/privacy-policy",children:"Privacy Policy"}),t.jsx(pe,{to:"/terms-of-service",children:"Terms of Service"}),t.jsx("a",{href:"mailto:support@screenmerch.com",children:"Contact Us"})]}),t.jsx("div",{className:"footer-copyright",children:t.jsx("p",{children:"© 2025 ScreenMerch. All rights reserved."})})]})})}),ca=e=>e>=1e6?Math.floor(e/1e6)+"M":e>=1e3?Math.floor(e/1e3)+"K":e;//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var Gs;function C(){return Gs.apply(null,arguments)}function da(e){Gs=e}function Ne(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function Ke(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function Q(e,s){return Object.prototype.hasOwnProperty.call(e,s)}function fs(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var s;for(s in e)if(Q(e,s))return!1;return!0}function fe(e){return e===void 0}function We(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function vt(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function qs(e,s){var r=[],a,n=e.length;for(a=0;a<n;++a)r.push(s(e[a],a));return r}function Ge(e,s){for(var r in s)Q(s,r)&&(e[r]=s[r]);return Q(s,"toString")&&(e.toString=s.toString),Q(s,"valueOf")&&(e.valueOf=s.valueOf),e}function Ee(e,s,r,a){return xr(e,s,r,a,!0).utc()}function ha(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function $(e){return e._pf==null&&(e._pf=ha()),e._pf}var as;Array.prototype.some?as=Array.prototype.some:as=function(e){var s=Object(this),r=s.length>>>0,a;for(a=0;a<r;a++)if(a in s&&e.call(this,s[a],a,s))return!0;return!1};function ps(e){var s=null,r=!1,a=e._d&&!isNaN(e._d.getTime());if(a&&(s=$(e),r=as.call(s.parsedDateParts,function(n){return n!=null}),a=s.overflow<0&&!s.empty&&!s.invalidEra&&!s.invalidMonth&&!s.invalidWeekday&&!s.weekdayMismatch&&!s.nullInput&&!s.invalidFormat&&!s.userInvalidated&&(!s.meridiem||s.meridiem&&r),e._strict&&(a=a&&s.charsLeftOver===0&&s.unusedTokens.length===0&&s.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=a;else return a;return e._isValid}function It(e){var s=Ee(NaN);return e!=null?Ge($(s),e):$(s).userInvalidated=!0,s}var Ls=C.momentProperties=[],Kt=!1;function gs(e,s){var r,a,n,i=Ls.length;if(fe(s._isAMomentObject)||(e._isAMomentObject=s._isAMomentObject),fe(s._i)||(e._i=s._i),fe(s._f)||(e._f=s._f),fe(s._l)||(e._l=s._l),fe(s._strict)||(e._strict=s._strict),fe(s._tzm)||(e._tzm=s._tzm),fe(s._isUTC)||(e._isUTC=s._isUTC),fe(s._offset)||(e._offset=s._offset),fe(s._pf)||(e._pf=$(s)),fe(s._locale)||(e._locale=s._locale),i>0)for(r=0;r<i;r++)a=Ls[r],n=s[a],fe(n)||(e[a]=n);return e}function jt(e){gs(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Kt===!1&&(Kt=!0,C.updateOffset(this),Kt=!1)}function ke(e){return e instanceof jt||e!=null&&e._isAMomentObject!=null}function Js(e){C.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function Se(e,s){var r=!0;return Ge(function(){if(C.deprecationHandler!=null&&C.deprecationHandler(null,e),r){var a=[],n,i,o,c=arguments.length;for(i=0;i<c;i++){if(n="",typeof arguments[i]=="object"){n+=`
[`+i+"] ";for(o in arguments[0])Q(arguments[0],o)&&(n+=o+": "+arguments[0][o]+", ");n=n.slice(0,-2)}else n=arguments[i];a.push(n)}Js(e+`
Arguments: `+Array.prototype.slice.call(a).join("")+`
`+new Error().stack),r=!1}return s.apply(this,arguments)},s)}var Fs={};function Zs(e,s){C.deprecationHandler!=null&&C.deprecationHandler(e,s),Fs[e]||(Js(s),Fs[e]=!0)}C.suppressDeprecationWarnings=!1;C.deprecationHandler=null;function Ue(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function ua(e){var s,r;for(r in e)Q(e,r)&&(s=e[r],Ue(s)?this[r]=s:this["_"+r]=s);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function ns(e,s){var r=Ge({},e),a;for(a in s)Q(s,a)&&(Ke(e[a])&&Ke(s[a])?(r[a]={},Ge(r[a],e[a]),Ge(r[a],s[a])):s[a]!=null?r[a]=s[a]:delete r[a]);for(a in e)Q(e,a)&&!Q(s,a)&&Ke(e[a])&&(r[a]=Ge({},r[a]));return r}function xs(e){e!=null&&this.set(e)}var is;Object.keys?is=Object.keys:is=function(e){var s,r=[];for(s in e)Q(e,s)&&r.push(s);return r};var ma={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function fa(e,s,r){var a=this._calendar[e]||this._calendar.sameElse;return Ue(a)?a.call(s,r):a}function Te(e,s,r){var a=""+Math.abs(e),n=s-a.length,i=e>=0;return(i?r?"+":"":"-")+Math.pow(10,Math.max(0,n)).toString().substr(1)+a}var ys=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,_t=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,es={},nt={};function I(e,s,r,a){var n=a;typeof a=="string"&&(n=function(){return this[a]()}),e&&(nt[e]=n),s&&(nt[s[0]]=function(){return Te(n.apply(this,arguments),s[1],s[2])}),r&&(nt[r]=function(){return this.localeData().ordinal(n.apply(this,arguments),e)})}function pa(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function ga(e){var s=e.match(ys),r,a;for(r=0,a=s.length;r<a;r++)nt[s[r]]?s[r]=nt[s[r]]:s[r]=pa(s[r]);return function(n){var i="",o;for(o=0;o<a;o++)i+=Ue(s[o])?s[o].call(n,e):s[o];return i}}function kt(e,s){return e.isValid()?(s=Xs(s,e.localeData()),es[s]=es[s]||ga(s),es[s](e)):e.localeData().invalidDate()}function Xs(e,s){var r=5;function a(n){return s.longDateFormat(n)||n}for(_t.lastIndex=0;r>=0&&_t.test(e);)e=e.replace(_t,a),_t.lastIndex=0,r-=1;return e}var xa={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function ya(e){var s=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return s||!r?s:(this._longDateFormat[e]=r.match(ys).map(function(a){return a==="MMMM"||a==="MM"||a==="DD"||a==="dddd"?a.slice(1):a}).join(""),this._longDateFormat[e])}var va="Invalid date";function ja(){return this._invalidDate}var wa="%d",Sa=/\d{1,2}/;function ba(e){return this._ordinal.replace("%d",e)}var _a={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function Na(e,s,r,a){var n=this._relativeTime[r];return Ue(n)?n(e,s,r,a):n.replace(/%d/i,e)}function ka(e,s){var r=this._relativeTime[e>0?"future":"past"];return Ue(r)?r(s):r.replace(/%s/i,s)}var Ws={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function be(e){return typeof e=="string"?Ws[e]||Ws[e.toLowerCase()]:void 0}function vs(e){var s={},r,a;for(a in e)Q(e,a)&&(r=be(a),r&&(s[r]=e[a]));return s}var Ca={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function Ma(e){var s=[],r;for(r in e)Q(e,r)&&s.push({unit:r,priority:Ca[r]});return s.sort(function(a,n){return a.priority-n.priority}),s}var Qs=/\d/,xe=/\d\d/,Ks=/\d{3}/,js=/\d{4}/,Yt=/[+-]?\d{6}/,se=/\d\d?/,er=/\d\d\d\d?/,tr=/\d\d\d\d\d\d?/,Lt=/\d{1,3}/,ws=/\d{1,4}/,Ft=/[+-]?\d{1,6}/,lt=/\d+/,Wt=/[+-]?\d+/,Aa=/Z|[+-]\d\d:?\d\d/gi,Vt=/Z|[+-]\d\d(?::?\d\d)?/gi,Da=/[+-]?\d+(\.\d{1,3})?/,wt=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,ct=/^[1-9]\d?/,Ss=/^([1-9]\d|\d)/,Dt;Dt={};function D(e,s,r){Dt[e]=Ue(s)?s:function(a,n){return a&&r?r:s}}function Pa(e,s){return Q(Dt,e)?Dt[e](s._strict,s._locale):new RegExp(Ta(e))}function Ta(e){return Le(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(s,r,a,n,i){return r||a||n||i}))}function Le(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function we(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function q(e){var s=+e,r=0;return s!==0&&isFinite(s)&&(r=we(s)),r}var os={};function ee(e,s){var r,a=s,n;for(typeof e=="string"&&(e=[e]),We(s)&&(a=function(i,o){o[s]=q(i)}),n=e.length,r=0;r<n;r++)os[e[r]]=a}function St(e,s){ee(e,function(r,a,n,i){n._w=n._w||{},s(r,n._w,n,i)})}function Ea(e,s,r){s!=null&&Q(os,e)&&os[e](s,r._a,r,e)}function $t(e){return e%4===0&&e%100!==0||e%400===0}var ue=0,Ie=1,Pe=2,le=3,_e=4,Ye=5,Qe=6,Ua=7,Oa=8;I("Y",0,0,function(){var e=this.year();return e<=9999?Te(e,4):"+"+e});I(0,["YY",2],0,function(){return this.year()%100});I(0,["YYYY",4],0,"year");I(0,["YYYYY",5],0,"year");I(0,["YYYYYY",6,!0],0,"year");D("Y",Wt);D("YY",se,xe);D("YYYY",ws,js);D("YYYYY",Ft,Yt);D("YYYYYY",Ft,Yt);ee(["YYYYY","YYYYYY"],ue);ee("YYYY",function(e,s){s[ue]=e.length===2?C.parseTwoDigitYear(e):q(e)});ee("YY",function(e,s){s[ue]=C.parseTwoDigitYear(e)});ee("Y",function(e,s){s[ue]=parseInt(e,10)});function mt(e){return $t(e)?366:365}C.parseTwoDigitYear=function(e){return q(e)+(q(e)>68?1900:2e3)};var sr=dt("FullYear",!0);function Ra(){return $t(this.year())}function dt(e,s){return function(r){return r!=null?(rr(this,e,r),C.updateOffset(this,s),this):pt(this,e)}}function pt(e,s){if(!e.isValid())return NaN;var r=e._d,a=e._isUTC;switch(s){case"Milliseconds":return a?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return a?r.getUTCSeconds():r.getSeconds();case"Minutes":return a?r.getUTCMinutes():r.getMinutes();case"Hours":return a?r.getUTCHours():r.getHours();case"Date":return a?r.getUTCDate():r.getDate();case"Day":return a?r.getUTCDay():r.getDay();case"Month":return a?r.getUTCMonth():r.getMonth();case"FullYear":return a?r.getUTCFullYear():r.getFullYear();default:return NaN}}function rr(e,s,r){var a,n,i,o,c;if(!(!e.isValid()||isNaN(r))){switch(a=e._d,n=e._isUTC,s){case"Milliseconds":return void(n?a.setUTCMilliseconds(r):a.setMilliseconds(r));case"Seconds":return void(n?a.setUTCSeconds(r):a.setSeconds(r));case"Minutes":return void(n?a.setUTCMinutes(r):a.setMinutes(r));case"Hours":return void(n?a.setUTCHours(r):a.setHours(r));case"Date":return void(n?a.setUTCDate(r):a.setDate(r));case"FullYear":break;default:return}i=r,o=e.month(),c=e.date(),c=c===29&&o===1&&!$t(i)?28:c,n?a.setUTCFullYear(i,o,c):a.setFullYear(i,o,c)}}function Ia(e){return e=be(e),Ue(this[e])?this[e]():this}function Ya(e,s){if(typeof e=="object"){e=vs(e);var r=Ma(e),a,n=r.length;for(a=0;a<n;a++)this[r[a].unit](e[r[a].unit])}else if(e=be(e),Ue(this[e]))return this[e](s);return this}function La(e,s){return(e%s+s)%s}var ne;Array.prototype.indexOf?ne=Array.prototype.indexOf:ne=function(e){var s;for(s=0;s<this.length;++s)if(this[s]===e)return s;return-1};function bs(e,s){if(isNaN(e)||isNaN(s))return NaN;var r=La(s,12);return e+=(s-r)/12,r===1?$t(e)?29:28:31-r%7%2}I("M",["MM",2],"Mo",function(){return this.month()+1});I("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});I("MMMM",0,0,function(e){return this.localeData().months(this,e)});D("M",se,ct);D("MM",se,xe);D("MMM",function(e,s){return s.monthsShortRegex(e)});D("MMMM",function(e,s){return s.monthsRegex(e)});ee(["M","MM"],function(e,s){s[Ie]=q(e)-1});ee(["MMM","MMMM"],function(e,s,r,a){var n=r._locale.monthsParse(e,a,r._strict);n!=null?s[Ie]=n:$(r).invalidMonth=e});var Fa="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ar="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),nr=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Wa=wt,Va=wt;function $a(e,s){return e?Ne(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||nr).test(s)?"format":"standalone"][e.month()]:Ne(this._months)?this._months:this._months.standalone}function Ba(e,s){return e?Ne(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[nr.test(s)?"format":"standalone"][e.month()]:Ne(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function Ha(e,s,r){var a,n,i,o=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],a=0;a<12;++a)i=Ee([2e3,a]),this._shortMonthsParse[a]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[a]=this.months(i,"").toLocaleLowerCase();return r?s==="MMM"?(n=ne.call(this._shortMonthsParse,o),n!==-1?n:null):(n=ne.call(this._longMonthsParse,o),n!==-1?n:null):s==="MMM"?(n=ne.call(this._shortMonthsParse,o),n!==-1?n:(n=ne.call(this._longMonthsParse,o),n!==-1?n:null)):(n=ne.call(this._longMonthsParse,o),n!==-1?n:(n=ne.call(this._shortMonthsParse,o),n!==-1?n:null))}function za(e,s,r){var a,n,i;if(this._monthsParseExact)return Ha.call(this,e,s,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),a=0;a<12;a++){if(n=Ee([2e3,a]),r&&!this._longMonthsParse[a]&&(this._longMonthsParse[a]=new RegExp("^"+this.months(n,"").replace(".","")+"$","i"),this._shortMonthsParse[a]=new RegExp("^"+this.monthsShort(n,"").replace(".","")+"$","i")),!r&&!this._monthsParse[a]&&(i="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[a]=new RegExp(i.replace(".",""),"i")),r&&s==="MMMM"&&this._longMonthsParse[a].test(e))return a;if(r&&s==="MMM"&&this._shortMonthsParse[a].test(e))return a;if(!r&&this._monthsParse[a].test(e))return a}}function ir(e,s){if(!e.isValid())return e;if(typeof s=="string"){if(/^\d+$/.test(s))s=q(s);else if(s=e.localeData().monthsParse(s),!We(s))return e}var r=s,a=e.date();return a=a<29?a:Math.min(a,bs(e.year(),r)),e._isUTC?e._d.setUTCMonth(r,a):e._d.setMonth(r,a),e}function or(e){return e!=null?(ir(this,e),C.updateOffset(this,!0),this):pt(this,"Month")}function Ga(){return bs(this.year(),this.month())}function qa(e){return this._monthsParseExact?(Q(this,"_monthsRegex")||lr.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(Q(this,"_monthsShortRegex")||(this._monthsShortRegex=Wa),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function Ja(e){return this._monthsParseExact?(Q(this,"_monthsRegex")||lr.call(this),e?this._monthsStrictRegex:this._monthsRegex):(Q(this,"_monthsRegex")||(this._monthsRegex=Va),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function lr(){function e(u,f){return f.length-u.length}var s=[],r=[],a=[],n,i,o,c;for(n=0;n<12;n++)i=Ee([2e3,n]),o=Le(this.monthsShort(i,"")),c=Le(this.months(i,"")),s.push(o),r.push(c),a.push(c),a.push(o);s.sort(e),r.sort(e),a.sort(e),this._monthsRegex=new RegExp("^("+a.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+s.join("|")+")","i")}function Za(e,s,r,a,n,i,o){var c;return e<100&&e>=0?(c=new Date(e+400,s,r,a,n,i,o),isFinite(c.getFullYear())&&c.setFullYear(e)):c=new Date(e,s,r,a,n,i,o),c}function gt(e){var s,r;return e<100&&e>=0?(r=Array.prototype.slice.call(arguments),r[0]=e+400,s=new Date(Date.UTC.apply(null,r)),isFinite(s.getUTCFullYear())&&s.setUTCFullYear(e)):s=new Date(Date.UTC.apply(null,arguments)),s}function Pt(e,s,r){var a=7+s-r,n=(7+gt(e,0,a).getUTCDay()-s)%7;return-n+a-1}function cr(e,s,r,a,n){var i=(7+r-a)%7,o=Pt(e,a,n),c=1+7*(s-1)+i+o,u,f;return c<=0?(u=e-1,f=mt(u)+c):c>mt(e)?(u=e+1,f=c-mt(e)):(u=e,f=c),{year:u,dayOfYear:f}}function xt(e,s,r){var a=Pt(e.year(),s,r),n=Math.floor((e.dayOfYear()-a-1)/7)+1,i,o;return n<1?(o=e.year()-1,i=n+Fe(o,s,r)):n>Fe(e.year(),s,r)?(i=n-Fe(e.year(),s,r),o=e.year()+1):(o=e.year(),i=n),{week:i,year:o}}function Fe(e,s,r){var a=Pt(e,s,r),n=Pt(e+1,s,r);return(mt(e)-a+n)/7}I("w",["ww",2],"wo","week");I("W",["WW",2],"Wo","isoWeek");D("w",se,ct);D("ww",se,xe);D("W",se,ct);D("WW",se,xe);St(["w","ww","W","WW"],function(e,s,r,a){s[a.substr(0,1)]=q(e)});function Xa(e){return xt(e,this._week.dow,this._week.doy).week}var Qa={dow:0,doy:6};function Ka(){return this._week.dow}function en(){return this._week.doy}function tn(e){var s=this.localeData().week(this);return e==null?s:this.add((e-s)*7,"d")}function sn(e){var s=xt(this,1,4).week;return e==null?s:this.add((e-s)*7,"d")}I("d",0,"do","day");I("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});I("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});I("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});I("e",0,0,"weekday");I("E",0,0,"isoWeekday");D("d",se);D("e",se);D("E",se);D("dd",function(e,s){return s.weekdaysMinRegex(e)});D("ddd",function(e,s){return s.weekdaysShortRegex(e)});D("dddd",function(e,s){return s.weekdaysRegex(e)});St(["dd","ddd","dddd"],function(e,s,r,a){var n=r._locale.weekdaysParse(e,a,r._strict);n!=null?s.d=n:$(r).invalidWeekday=e});St(["d","e","E"],function(e,s,r,a){s[a]=q(e)});function rn(e,s){return typeof e!="string"?e:isNaN(e)?(e=s.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function an(e,s){return typeof e=="string"?s.weekdaysParse(e)%7||7:isNaN(e)?null:e}function _s(e,s){return e.slice(s,7).concat(e.slice(0,s))}var nn="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),dr="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),on="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),ln=wt,cn=wt,dn=wt;function hn(e,s){var r=Ne(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(s)?"format":"standalone"];return e===!0?_s(r,this._week.dow):e?r[e.day()]:r}function un(e){return e===!0?_s(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function mn(e){return e===!0?_s(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function fn(e,s,r){var a,n,i,o=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],a=0;a<7;++a)i=Ee([2e3,1]).day(a),this._minWeekdaysParse[a]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[a]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[a]=this.weekdays(i,"").toLocaleLowerCase();return r?s==="dddd"?(n=ne.call(this._weekdaysParse,o),n!==-1?n:null):s==="ddd"?(n=ne.call(this._shortWeekdaysParse,o),n!==-1?n:null):(n=ne.call(this._minWeekdaysParse,o),n!==-1?n:null):s==="dddd"?(n=ne.call(this._weekdaysParse,o),n!==-1||(n=ne.call(this._shortWeekdaysParse,o),n!==-1)?n:(n=ne.call(this._minWeekdaysParse,o),n!==-1?n:null)):s==="ddd"?(n=ne.call(this._shortWeekdaysParse,o),n!==-1||(n=ne.call(this._weekdaysParse,o),n!==-1)?n:(n=ne.call(this._minWeekdaysParse,o),n!==-1?n:null)):(n=ne.call(this._minWeekdaysParse,o),n!==-1||(n=ne.call(this._weekdaysParse,o),n!==-1)?n:(n=ne.call(this._shortWeekdaysParse,o),n!==-1?n:null))}function pn(e,s,r){var a,n,i;if(this._weekdaysParseExact)return fn.call(this,e,s,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),a=0;a<7;a++){if(n=Ee([2e3,1]).day(a),r&&!this._fullWeekdaysParse[a]&&(this._fullWeekdaysParse[a]=new RegExp("^"+this.weekdays(n,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[a]=new RegExp("^"+this.weekdaysShort(n,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[a]=new RegExp("^"+this.weekdaysMin(n,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[a]||(i="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[a]=new RegExp(i.replace(".",""),"i")),r&&s==="dddd"&&this._fullWeekdaysParse[a].test(e))return a;if(r&&s==="ddd"&&this._shortWeekdaysParse[a].test(e))return a;if(r&&s==="dd"&&this._minWeekdaysParse[a].test(e))return a;if(!r&&this._weekdaysParse[a].test(e))return a}}function gn(e){if(!this.isValid())return e!=null?this:NaN;var s=pt(this,"Day");return e!=null?(e=rn(e,this.localeData()),this.add(e-s,"d")):s}function xn(e){if(!this.isValid())return e!=null?this:NaN;var s=(this.day()+7-this.localeData()._week.dow)%7;return e==null?s:this.add(e-s,"d")}function yn(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var s=an(e,this.localeData());return this.day(this.day()%7?s:s-7)}else return this.day()||7}function vn(e){return this._weekdaysParseExact?(Q(this,"_weekdaysRegex")||Ns.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(Q(this,"_weekdaysRegex")||(this._weekdaysRegex=ln),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function jn(e){return this._weekdaysParseExact?(Q(this,"_weekdaysRegex")||Ns.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Q(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=cn),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function wn(e){return this._weekdaysParseExact?(Q(this,"_weekdaysRegex")||Ns.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Q(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=dn),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Ns(){function e(j,M){return M.length-j.length}var s=[],r=[],a=[],n=[],i,o,c,u,f;for(i=0;i<7;i++)o=Ee([2e3,1]).day(i),c=Le(this.weekdaysMin(o,"")),u=Le(this.weekdaysShort(o,"")),f=Le(this.weekdays(o,"")),s.push(c),r.push(u),a.push(f),n.push(c),n.push(u),n.push(f);s.sort(e),r.sort(e),a.sort(e),n.sort(e),this._weekdaysRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+s.join("|")+")","i")}function ks(){return this.hours()%12||12}function Sn(){return this.hours()||24}I("H",["HH",2],0,"hour");I("h",["hh",2],0,ks);I("k",["kk",2],0,Sn);I("hmm",0,0,function(){return""+ks.apply(this)+Te(this.minutes(),2)});I("hmmss",0,0,function(){return""+ks.apply(this)+Te(this.minutes(),2)+Te(this.seconds(),2)});I("Hmm",0,0,function(){return""+this.hours()+Te(this.minutes(),2)});I("Hmmss",0,0,function(){return""+this.hours()+Te(this.minutes(),2)+Te(this.seconds(),2)});function hr(e,s){I(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),s)})}hr("a",!0);hr("A",!1);function ur(e,s){return s._meridiemParse}D("a",ur);D("A",ur);D("H",se,Ss);D("h",se,ct);D("k",se,ct);D("HH",se,xe);D("hh",se,xe);D("kk",se,xe);D("hmm",er);D("hmmss",tr);D("Hmm",er);D("Hmmss",tr);ee(["H","HH"],le);ee(["k","kk"],function(e,s,r){var a=q(e);s[le]=a===24?0:a});ee(["a","A"],function(e,s,r){r._isPm=r._locale.isPM(e),r._meridiem=e});ee(["h","hh"],function(e,s,r){s[le]=q(e),$(r).bigHour=!0});ee("hmm",function(e,s,r){var a=e.length-2;s[le]=q(e.substr(0,a)),s[_e]=q(e.substr(a)),$(r).bigHour=!0});ee("hmmss",function(e,s,r){var a=e.length-4,n=e.length-2;s[le]=q(e.substr(0,a)),s[_e]=q(e.substr(a,2)),s[Ye]=q(e.substr(n)),$(r).bigHour=!0});ee("Hmm",function(e,s,r){var a=e.length-2;s[le]=q(e.substr(0,a)),s[_e]=q(e.substr(a))});ee("Hmmss",function(e,s,r){var a=e.length-4,n=e.length-2;s[le]=q(e.substr(0,a)),s[_e]=q(e.substr(a,2)),s[Ye]=q(e.substr(n))});function bn(e){return(e+"").toLowerCase().charAt(0)==="p"}var _n=/[ap]\.?m?\.?/i,Nn=dt("Hours",!0);function kn(e,s,r){return e>11?r?"pm":"PM":r?"am":"AM"}var mr={calendar:ma,longDateFormat:xa,invalidDate:va,ordinal:wa,dayOfMonthOrdinalParse:Sa,relativeTime:_a,months:Fa,monthsShort:ar,week:Qa,weekdays:nn,weekdaysMin:on,weekdaysShort:dr,meridiemParse:_n},re={},ht={},yt;function Cn(e,s){var r,a=Math.min(e.length,s.length);for(r=0;r<a;r+=1)if(e[r]!==s[r])return r;return a}function Vs(e){return e&&e.toLowerCase().replace("_","-")}function Mn(e){for(var s=0,r,a,n,i;s<e.length;){for(i=Vs(e[s]).split("-"),r=i.length,a=Vs(e[s+1]),a=a?a.split("-"):null;r>0;){if(n=Bt(i.slice(0,r).join("-")),n)return n;if(a&&a.length>=r&&Cn(i,a)>=r-1)break;r--}s++}return yt}function An(e){return!!(e&&e.match("^[^/\\\\]*$"))}function Bt(e){var s=null,r;if(re[e]===void 0&&typeof At<"u"&&At&&At.exports&&An(e))try{s=yt._abbr,r=require,r("./locale/"+e),Je(s)}catch{re[e]=null}return re[e]}function Je(e,s){var r;return e&&(fe(s)?r=Ve(e):r=Cs(e,s),r?yt=r:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),yt._abbr}function Cs(e,s){if(s!==null){var r,a=mr;if(s.abbr=e,re[e]!=null)Zs("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),a=re[e]._config;else if(s.parentLocale!=null)if(re[s.parentLocale]!=null)a=re[s.parentLocale]._config;else if(r=Bt(s.parentLocale),r!=null)a=r._config;else return ht[s.parentLocale]||(ht[s.parentLocale]=[]),ht[s.parentLocale].push({name:e,config:s}),null;return re[e]=new xs(ns(a,s)),ht[e]&&ht[e].forEach(function(n){Cs(n.name,n.config)}),Je(e),re[e]}else return delete re[e],null}function Dn(e,s){if(s!=null){var r,a,n=mr;re[e]!=null&&re[e].parentLocale!=null?re[e].set(ns(re[e]._config,s)):(a=Bt(e),a!=null&&(n=a._config),s=ns(n,s),a==null&&(s.abbr=e),r=new xs(s),r.parentLocale=re[e],re[e]=r),Je(e)}else re[e]!=null&&(re[e].parentLocale!=null?(re[e]=re[e].parentLocale,e===Je()&&Je(e)):re[e]!=null&&delete re[e]);return re[e]}function Ve(e){var s;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return yt;if(!Ne(e)){if(s=Bt(e),s)return s;e=[e]}return Mn(e)}function Pn(){return is(re)}function Ms(e){var s,r=e._a;return r&&$(e).overflow===-2&&(s=r[Ie]<0||r[Ie]>11?Ie:r[Pe]<1||r[Pe]>bs(r[ue],r[Ie])?Pe:r[le]<0||r[le]>24||r[le]===24&&(r[_e]!==0||r[Ye]!==0||r[Qe]!==0)?le:r[_e]<0||r[_e]>59?_e:r[Ye]<0||r[Ye]>59?Ye:r[Qe]<0||r[Qe]>999?Qe:-1,$(e)._overflowDayOfYear&&(s<ue||s>Pe)&&(s=Pe),$(e)._overflowWeeks&&s===-1&&(s=Ua),$(e)._overflowWeekday&&s===-1&&(s=Oa),$(e).overflow=s),e}var Tn=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,En=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Un=/Z|[+-]\d\d(?::?\d\d)?/,Nt=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],ts=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],On=/^\/?Date\((-?\d+)/i,Rn=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,In={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function fr(e){var s,r,a=e._i,n=Tn.exec(a)||En.exec(a),i,o,c,u,f=Nt.length,j=ts.length;if(n){for($(e).iso=!0,s=0,r=f;s<r;s++)if(Nt[s][1].exec(n[1])){o=Nt[s][0],i=Nt[s][2]!==!1;break}if(o==null){e._isValid=!1;return}if(n[3]){for(s=0,r=j;s<r;s++)if(ts[s][1].exec(n[3])){c=(n[2]||" ")+ts[s][0];break}if(c==null){e._isValid=!1;return}}if(!i&&c!=null){e._isValid=!1;return}if(n[4])if(Un.exec(n[4]))u="Z";else{e._isValid=!1;return}e._f=o+(c||"")+(u||""),Ds(e)}else e._isValid=!1}function Yn(e,s,r,a,n,i){var o=[Ln(e),ar.indexOf(s),parseInt(r,10),parseInt(a,10),parseInt(n,10)];return i&&o.push(parseInt(i,10)),o}function Ln(e){var s=parseInt(e,10);return s<=49?2e3+s:s<=999?1900+s:s}function Fn(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Wn(e,s,r){if(e){var a=dr.indexOf(e),n=new Date(s[0],s[1],s[2]).getDay();if(a!==n)return $(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function Vn(e,s,r){if(e)return In[e];if(s)return 0;var a=parseInt(r,10),n=a%100,i=(a-n)/100;return i*60+n}function pr(e){var s=Rn.exec(Fn(e._i)),r;if(s){if(r=Yn(s[4],s[3],s[2],s[5],s[6],s[7]),!Wn(s[1],r,e))return;e._a=r,e._tzm=Vn(s[8],s[9],s[10]),e._d=gt.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),$(e).rfc2822=!0}else e._isValid=!1}function $n(e){var s=On.exec(e._i);if(s!==null){e._d=new Date(+s[1]);return}if(fr(e),e._isValid===!1)delete e._isValid;else return;if(pr(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:C.createFromInputFallback(e)}C.createFromInputFallback=Se("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function rt(e,s,r){return e??s??r}function Bn(e){var s=new Date(C.now());return e._useUTC?[s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate()]:[s.getFullYear(),s.getMonth(),s.getDate()]}function As(e){var s,r,a=[],n,i,o;if(!e._d){for(n=Bn(e),e._w&&e._a[Pe]==null&&e._a[Ie]==null&&Hn(e),e._dayOfYear!=null&&(o=rt(e._a[ue],n[ue]),(e._dayOfYear>mt(o)||e._dayOfYear===0)&&($(e)._overflowDayOfYear=!0),r=gt(o,0,e._dayOfYear),e._a[Ie]=r.getUTCMonth(),e._a[Pe]=r.getUTCDate()),s=0;s<3&&e._a[s]==null;++s)e._a[s]=a[s]=n[s];for(;s<7;s++)e._a[s]=a[s]=e._a[s]==null?s===2?1:0:e._a[s];e._a[le]===24&&e._a[_e]===0&&e._a[Ye]===0&&e._a[Qe]===0&&(e._nextDay=!0,e._a[le]=0),e._d=(e._useUTC?gt:Za).apply(null,a),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[le]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==i&&($(e).weekdayMismatch=!0)}}function Hn(e){var s,r,a,n,i,o,c,u,f;s=e._w,s.GG!=null||s.W!=null||s.E!=null?(i=1,o=4,r=rt(s.GG,e._a[ue],xt(te(),1,4).year),a=rt(s.W,1),n=rt(s.E,1),(n<1||n>7)&&(u=!0)):(i=e._locale._week.dow,o=e._locale._week.doy,f=xt(te(),i,o),r=rt(s.gg,e._a[ue],f.year),a=rt(s.w,f.week),s.d!=null?(n=s.d,(n<0||n>6)&&(u=!0)):s.e!=null?(n=s.e+i,(s.e<0||s.e>6)&&(u=!0)):n=i),a<1||a>Fe(r,i,o)?$(e)._overflowWeeks=!0:u!=null?$(e)._overflowWeekday=!0:(c=cr(r,a,n,i,o),e._a[ue]=c.year,e._dayOfYear=c.dayOfYear)}C.ISO_8601=function(){};C.RFC_2822=function(){};function Ds(e){if(e._f===C.ISO_8601){fr(e);return}if(e._f===C.RFC_2822){pr(e);return}e._a=[],$(e).empty=!0;var s=""+e._i,r,a,n,i,o,c=s.length,u=0,f,j;for(n=Xs(e._f,e._locale).match(ys)||[],j=n.length,r=0;r<j;r++)i=n[r],a=(s.match(Pa(i,e))||[])[0],a&&(o=s.substr(0,s.indexOf(a)),o.length>0&&$(e).unusedInput.push(o),s=s.slice(s.indexOf(a)+a.length),u+=a.length),nt[i]?(a?$(e).empty=!1:$(e).unusedTokens.push(i),Ea(i,a,e)):e._strict&&!a&&$(e).unusedTokens.push(i);$(e).charsLeftOver=c-u,s.length>0&&$(e).unusedInput.push(s),e._a[le]<=12&&$(e).bigHour===!0&&e._a[le]>0&&($(e).bigHour=void 0),$(e).parsedDateParts=e._a.slice(0),$(e).meridiem=e._meridiem,e._a[le]=zn(e._locale,e._a[le],e._meridiem),f=$(e).era,f!==null&&(e._a[ue]=e._locale.erasConvertYear(f,e._a[ue])),As(e),Ms(e)}function zn(e,s,r){var a;return r==null?s:e.meridiemHour!=null?e.meridiemHour(s,r):(e.isPM!=null&&(a=e.isPM(r),a&&s<12&&(s+=12),!a&&s===12&&(s=0)),s)}function Gn(e){var s,r,a,n,i,o,c=!1,u=e._f.length;if(u===0){$(e).invalidFormat=!0,e._d=new Date(NaN);return}for(n=0;n<u;n++)i=0,o=!1,s=gs({},e),e._useUTC!=null&&(s._useUTC=e._useUTC),s._f=e._f[n],Ds(s),ps(s)&&(o=!0),i+=$(s).charsLeftOver,i+=$(s).unusedTokens.length*10,$(s).score=i,c?i<a&&(a=i,r=s):(a==null||i<a||o)&&(a=i,r=s,o&&(c=!0));Ge(e,r||s)}function qn(e){if(!e._d){var s=vs(e._i),r=s.day===void 0?s.date:s.day;e._a=qs([s.year,s.month,r,s.hour,s.minute,s.second,s.millisecond],function(a){return a&&parseInt(a,10)}),As(e)}}function Jn(e){var s=new jt(Ms(gr(e)));return s._nextDay&&(s.add(1,"d"),s._nextDay=void 0),s}function gr(e){var s=e._i,r=e._f;return e._locale=e._locale||Ve(e._l),s===null||r===void 0&&s===""?It({nullInput:!0}):(typeof s=="string"&&(e._i=s=e._locale.preparse(s)),ke(s)?new jt(Ms(s)):(vt(s)?e._d=s:Ne(r)?Gn(e):r?Ds(e):Zn(e),ps(e)||(e._d=null),e))}function Zn(e){var s=e._i;fe(s)?e._d=new Date(C.now()):vt(s)?e._d=new Date(s.valueOf()):typeof s=="string"?$n(e):Ne(s)?(e._a=qs(s.slice(0),function(r){return parseInt(r,10)}),As(e)):Ke(s)?qn(e):We(s)?e._d=new Date(s):C.createFromInputFallback(e)}function xr(e,s,r,a,n){var i={};return(s===!0||s===!1)&&(a=s,s=void 0),(r===!0||r===!1)&&(a=r,r=void 0),(Ke(e)&&fs(e)||Ne(e)&&e.length===0)&&(e=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=n,i._l=r,i._i=e,i._f=s,i._strict=a,Jn(i)}function te(e,s,r,a){return xr(e,s,r,a,!1)}var Xn=Se("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=te.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:It()}),Qn=Se("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=te.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:It()});function yr(e,s){var r,a;if(s.length===1&&Ne(s[0])&&(s=s[0]),!s.length)return te();for(r=s[0],a=1;a<s.length;++a)(!s[a].isValid()||s[a][e](r))&&(r=s[a]);return r}function Kn(){var e=[].slice.call(arguments,0);return yr("isBefore",e)}function ei(){var e=[].slice.call(arguments,0);return yr("isAfter",e)}var ti=function(){return Date.now?Date.now():+new Date},ut=["year","quarter","month","week","day","hour","minute","second","millisecond"];function si(e){var s,r=!1,a,n=ut.length;for(s in e)if(Q(e,s)&&!(ne.call(ut,s)!==-1&&(e[s]==null||!isNaN(e[s]))))return!1;for(a=0;a<n;++a)if(e[ut[a]]){if(r)return!1;parseFloat(e[ut[a]])!==q(e[ut[a]])&&(r=!0)}return!0}function ri(){return this._isValid}function ai(){return Ce(NaN)}function Ht(e){var s=vs(e),r=s.year||0,a=s.quarter||0,n=s.month||0,i=s.week||s.isoWeek||0,o=s.day||0,c=s.hour||0,u=s.minute||0,f=s.second||0,j=s.millisecond||0;this._isValid=si(s),this._milliseconds=+j+f*1e3+u*6e4+c*1e3*60*60,this._days=+o+i*7,this._months=+n+a*3+r*12,this._data={},this._locale=Ve(),this._bubble()}function Ct(e){return e instanceof Ht}function ls(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function ni(e,s,r){var a=Math.min(e.length,s.length),n=Math.abs(e.length-s.length),i=0,o;for(o=0;o<a;o++)(r&&e[o]!==s[o]||!r&&q(e[o])!==q(s[o]))&&i++;return i+n}function vr(e,s){I(e,0,0,function(){var r=this.utcOffset(),a="+";return r<0&&(r=-r,a="-"),a+Te(~~(r/60),2)+s+Te(~~r%60,2)})}vr("Z",":");vr("ZZ","");D("Z",Vt);D("ZZ",Vt);ee(["Z","ZZ"],function(e,s,r){r._useUTC=!0,r._tzm=Ps(Vt,e)});var ii=/([\+\-]|\d\d)/gi;function Ps(e,s){var r=(s||"").match(e),a,n,i;return r===null?null:(a=r[r.length-1]||[],n=(a+"").match(ii)||["-",0,0],i=+(n[1]*60)+q(n[2]),i===0?0:n[0]==="+"?i:-i)}function Ts(e,s){var r,a;return s._isUTC?(r=s.clone(),a=(ke(e)||vt(e)?e.valueOf():te(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+a),C.updateOffset(r,!1),r):te(e).local()}function cs(e){return-Math.round(e._d.getTimezoneOffset())}C.updateOffset=function(){};function oi(e,s,r){var a=this._offset||0,n;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=Ps(Vt,e),e===null)return this}else Math.abs(e)<16&&!r&&(e=e*60);return!this._isUTC&&s&&(n=cs(this)),this._offset=e,this._isUTC=!0,n!=null&&this.add(n,"m"),a!==e&&(!s||this._changeInProgress?Sr(this,Ce(e-a,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,C.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?a:cs(this)}function li(e,s){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,s),this):-this.utcOffset()}function ci(e){return this.utcOffset(0,e)}function di(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(cs(this),"m")),this}function hi(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=Ps(Aa,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function ui(e){return this.isValid()?(e=e?te(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function mi(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function fi(){if(!fe(this._isDSTShifted))return this._isDSTShifted;var e={},s;return gs(e,this),e=gr(e),e._a?(s=e._isUTC?Ee(e._a):te(e._a),this._isDSTShifted=this.isValid()&&ni(e._a,s.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function pi(){return this.isValid()?!this._isUTC:!1}function gi(){return this.isValid()?this._isUTC:!1}function jr(){return this.isValid()?this._isUTC&&this._offset===0:!1}var xi=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,yi=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Ce(e,s){var r=e,a=null,n,i,o;return Ct(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:We(e)||!isNaN(+e)?(r={},s?r[s]=+e:r.milliseconds=+e):(a=xi.exec(e))?(n=a[1]==="-"?-1:1,r={y:0,d:q(a[Pe])*n,h:q(a[le])*n,m:q(a[_e])*n,s:q(a[Ye])*n,ms:q(ls(a[Qe]*1e3))*n}):(a=yi.exec(e))?(n=a[1]==="-"?-1:1,r={y:Xe(a[2],n),M:Xe(a[3],n),w:Xe(a[4],n),d:Xe(a[5],n),h:Xe(a[6],n),m:Xe(a[7],n),s:Xe(a[8],n)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(o=vi(te(r.from),te(r.to)),r={},r.ms=o.milliseconds,r.M=o.months),i=new Ht(r),Ct(e)&&Q(e,"_locale")&&(i._locale=e._locale),Ct(e)&&Q(e,"_isValid")&&(i._isValid=e._isValid),i}Ce.fn=Ht.prototype;Ce.invalid=ai;function Xe(e,s){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*s}function $s(e,s){var r={};return r.months=s.month()-e.month()+(s.year()-e.year())*12,e.clone().add(r.months,"M").isAfter(s)&&--r.months,r.milliseconds=+s-+e.clone().add(r.months,"M"),r}function vi(e,s){var r;return e.isValid()&&s.isValid()?(s=Ts(s,e),e.isBefore(s)?r=$s(e,s):(r=$s(s,e),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function wr(e,s){return function(r,a){var n,i;return a!==null&&!isNaN(+a)&&(Zs(s,"moment()."+s+"(period, number) is deprecated. Please use moment()."+s+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=r,r=a,a=i),n=Ce(r,a),Sr(this,n,e),this}}function Sr(e,s,r,a){var n=s._milliseconds,i=ls(s._days),o=ls(s._months);e.isValid()&&(a=a??!0,o&&ir(e,pt(e,"Month")+o*r),i&&rr(e,"Date",pt(e,"Date")+i*r),n&&e._d.setTime(e._d.valueOf()+n*r),a&&C.updateOffset(e,i||o))}var ji=wr(1,"add"),wi=wr(-1,"subtract");function br(e){return typeof e=="string"||e instanceof String}function Si(e){return ke(e)||vt(e)||br(e)||We(e)||_i(e)||bi(e)||e===null||e===void 0}function bi(e){var s=Ke(e)&&!fs(e),r=!1,a=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],n,i,o=a.length;for(n=0;n<o;n+=1)i=a[n],r=r||Q(e,i);return s&&r}function _i(e){var s=Ne(e),r=!1;return s&&(r=e.filter(function(a){return!We(a)&&br(e)}).length===0),s&&r}function Ni(e){var s=Ke(e)&&!fs(e),r=!1,a=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],n,i;for(n=0;n<a.length;n+=1)i=a[n],r=r||Q(e,i);return s&&r}function ki(e,s){var r=e.diff(s,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function Ci(e,s){arguments.length===1&&(arguments[0]?Si(arguments[0])?(e=arguments[0],s=void 0):Ni(arguments[0])&&(s=arguments[0],e=void 0):(e=void 0,s=void 0));var r=e||te(),a=Ts(r,this).startOf("day"),n=C.calendarFormat(this,a)||"sameElse",i=s&&(Ue(s[n])?s[n].call(this,r):s[n]);return this.format(i||this.localeData().calendar(n,this,te(r)))}function Mi(){return new jt(this)}function Ai(e,s){var r=ke(e)?e:te(e);return this.isValid()&&r.isValid()?(s=be(s)||"millisecond",s==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(s).valueOf()):!1}function Di(e,s){var r=ke(e)?e:te(e);return this.isValid()&&r.isValid()?(s=be(s)||"millisecond",s==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(s).valueOf()<r.valueOf()):!1}function Pi(e,s,r,a){var n=ke(e)?e:te(e),i=ke(s)?s:te(s);return this.isValid()&&n.isValid()&&i.isValid()?(a=a||"()",(a[0]==="("?this.isAfter(n,r):!this.isBefore(n,r))&&(a[1]===")"?this.isBefore(i,r):!this.isAfter(i,r))):!1}function Ti(e,s){var r=ke(e)?e:te(e),a;return this.isValid()&&r.isValid()?(s=be(s)||"millisecond",s==="millisecond"?this.valueOf()===r.valueOf():(a=r.valueOf(),this.clone().startOf(s).valueOf()<=a&&a<=this.clone().endOf(s).valueOf())):!1}function Ei(e,s){return this.isSame(e,s)||this.isAfter(e,s)}function Ui(e,s){return this.isSame(e,s)||this.isBefore(e,s)}function Oi(e,s,r){var a,n,i;if(!this.isValid())return NaN;if(a=Ts(e,this),!a.isValid())return NaN;switch(n=(a.utcOffset()-this.utcOffset())*6e4,s=be(s),s){case"year":i=Mt(this,a)/12;break;case"month":i=Mt(this,a);break;case"quarter":i=Mt(this,a)/3;break;case"second":i=(this-a)/1e3;break;case"minute":i=(this-a)/6e4;break;case"hour":i=(this-a)/36e5;break;case"day":i=(this-a-n)/864e5;break;case"week":i=(this-a-n)/6048e5;break;default:i=this-a}return r?i:we(i)}function Mt(e,s){if(e.date()<s.date())return-Mt(s,e);var r=(s.year()-e.year())*12+(s.month()-e.month()),a=e.clone().add(r,"months"),n,i;return s-a<0?(n=e.clone().add(r-1,"months"),i=(s-a)/(a-n)):(n=e.clone().add(r+1,"months"),i=(s-a)/(n-a)),-(r+i)||0}C.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";C.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function Ri(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Ii(e){if(!this.isValid())return null;var s=e!==!0,r=s?this.clone().utc():this;return r.year()<0||r.year()>9999?kt(r,s?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Ue(Date.prototype.toISOString)?s?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",kt(r,"Z")):kt(r,s?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function Yi(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",s="",r,a,n,i;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",s="Z"),r="["+e+'("]',a=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",n="-MM-DD[T]HH:mm:ss.SSS",i=s+'[")]',this.format(r+a+n+i)}function Li(e){e||(e=this.isUtc()?C.defaultFormatUtc:C.defaultFormat);var s=kt(this,e);return this.localeData().postformat(s)}function Fi(e,s){return this.isValid()&&(ke(e)&&e.isValid()||te(e).isValid())?Ce({to:this,from:e}).locale(this.locale()).humanize(!s):this.localeData().invalidDate()}function Wi(e){return this.from(te(),e)}function Vi(e,s){return this.isValid()&&(ke(e)&&e.isValid()||te(e).isValid())?Ce({from:this,to:e}).locale(this.locale()).humanize(!s):this.localeData().invalidDate()}function $i(e){return this.to(te(),e)}function _r(e){var s;return e===void 0?this._locale._abbr:(s=Ve(e),s!=null&&(this._locale=s),this)}var Nr=Se("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function kr(){return this._locale}var Tt=1e3,it=60*Tt,Et=60*it,Cr=(365*400+97)*24*Et;function ot(e,s){return(e%s+s)%s}function Mr(e,s,r){return e<100&&e>=0?new Date(e+400,s,r)-Cr:new Date(e,s,r).valueOf()}function Ar(e,s,r){return e<100&&e>=0?Date.UTC(e+400,s,r)-Cr:Date.UTC(e,s,r)}function Bi(e){var s,r;if(e=be(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?Ar:Mr,e){case"year":s=r(this.year(),0,1);break;case"quarter":s=r(this.year(),this.month()-this.month()%3,1);break;case"month":s=r(this.year(),this.month(),1);break;case"week":s=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":s=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":s=r(this.year(),this.month(),this.date());break;case"hour":s=this._d.valueOf(),s-=ot(s+(this._isUTC?0:this.utcOffset()*it),Et);break;case"minute":s=this._d.valueOf(),s-=ot(s,it);break;case"second":s=this._d.valueOf(),s-=ot(s,Tt);break}return this._d.setTime(s),C.updateOffset(this,!0),this}function Hi(e){var s,r;if(e=be(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?Ar:Mr,e){case"year":s=r(this.year()+1,0,1)-1;break;case"quarter":s=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":s=r(this.year(),this.month()+1,1)-1;break;case"week":s=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":s=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":s=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":s=this._d.valueOf(),s+=Et-ot(s+(this._isUTC?0:this.utcOffset()*it),Et)-1;break;case"minute":s=this._d.valueOf(),s+=it-ot(s,it)-1;break;case"second":s=this._d.valueOf(),s+=Tt-ot(s,Tt)-1;break}return this._d.setTime(s),C.updateOffset(this,!0),this}function zi(){return this._d.valueOf()-(this._offset||0)*6e4}function Gi(){return Math.floor(this.valueOf()/1e3)}function qi(){return new Date(this.valueOf())}function Ji(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Zi(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Xi(){return this.isValid()?this.toISOString():null}function Qi(){return ps(this)}function Ki(){return Ge({},$(this))}function eo(){return $(this).overflow}function to(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}I("N",0,0,"eraAbbr");I("NN",0,0,"eraAbbr");I("NNN",0,0,"eraAbbr");I("NNNN",0,0,"eraName");I("NNNNN",0,0,"eraNarrow");I("y",["y",1],"yo","eraYear");I("y",["yy",2],0,"eraYear");I("y",["yyy",3],0,"eraYear");I("y",["yyyy",4],0,"eraYear");D("N",Es);D("NN",Es);D("NNN",Es);D("NNNN",mo);D("NNNNN",fo);ee(["N","NN","NNN","NNNN","NNNNN"],function(e,s,r,a){var n=r._locale.erasParse(e,a,r._strict);n?$(r).era=n:$(r).invalidEra=e});D("y",lt);D("yy",lt);D("yyy",lt);D("yyyy",lt);D("yo",po);ee(["y","yy","yyy","yyyy"],ue);ee(["yo"],function(e,s,r,a){var n;r._locale._eraYearOrdinalRegex&&(n=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?s[ue]=r._locale.eraYearOrdinalParse(e,n):s[ue]=parseInt(e,10)});function so(e,s){var r,a,n,i=this._eras||Ve("en")._eras;for(r=0,a=i.length;r<a;++r){switch(typeof i[r].since){case"string":n=C(i[r].since).startOf("day"),i[r].since=n.valueOf();break}switch(typeof i[r].until){case"undefined":i[r].until=1/0;break;case"string":n=C(i[r].until).startOf("day").valueOf(),i[r].until=n.valueOf();break}}return i}function ro(e,s,r){var a,n,i=this.eras(),o,c,u;for(e=e.toUpperCase(),a=0,n=i.length;a<n;++a)if(o=i[a].name.toUpperCase(),c=i[a].abbr.toUpperCase(),u=i[a].narrow.toUpperCase(),r)switch(s){case"N":case"NN":case"NNN":if(c===e)return i[a];break;case"NNNN":if(o===e)return i[a];break;case"NNNNN":if(u===e)return i[a];break}else if([o,c,u].indexOf(e)>=0)return i[a]}function ao(e,s){var r=e.since<=e.until?1:-1;return s===void 0?C(e.since).year():C(e.since).year()+(s-e.offset)*r}function no(){var e,s,r,a=this.localeData().eras();for(e=0,s=a.length;e<s;++e)if(r=this.clone().startOf("day").valueOf(),a[e].since<=r&&r<=a[e].until||a[e].until<=r&&r<=a[e].since)return a[e].name;return""}function io(){var e,s,r,a=this.localeData().eras();for(e=0,s=a.length;e<s;++e)if(r=this.clone().startOf("day").valueOf(),a[e].since<=r&&r<=a[e].until||a[e].until<=r&&r<=a[e].since)return a[e].narrow;return""}function oo(){var e,s,r,a=this.localeData().eras();for(e=0,s=a.length;e<s;++e)if(r=this.clone().startOf("day").valueOf(),a[e].since<=r&&r<=a[e].until||a[e].until<=r&&r<=a[e].since)return a[e].abbr;return""}function lo(){var e,s,r,a,n=this.localeData().eras();for(e=0,s=n.length;e<s;++e)if(r=n[e].since<=n[e].until?1:-1,a=this.clone().startOf("day").valueOf(),n[e].since<=a&&a<=n[e].until||n[e].until<=a&&a<=n[e].since)return(this.year()-C(n[e].since).year())*r+n[e].offset;return this.year()}function co(e){return Q(this,"_erasNameRegex")||Us.call(this),e?this._erasNameRegex:this._erasRegex}function ho(e){return Q(this,"_erasAbbrRegex")||Us.call(this),e?this._erasAbbrRegex:this._erasRegex}function uo(e){return Q(this,"_erasNarrowRegex")||Us.call(this),e?this._erasNarrowRegex:this._erasRegex}function Es(e,s){return s.erasAbbrRegex(e)}function mo(e,s){return s.erasNameRegex(e)}function fo(e,s){return s.erasNarrowRegex(e)}function po(e,s){return s._eraYearOrdinalRegex||lt}function Us(){var e=[],s=[],r=[],a=[],n,i,o,c,u,f=this.eras();for(n=0,i=f.length;n<i;++n)o=Le(f[n].name),c=Le(f[n].abbr),u=Le(f[n].narrow),s.push(o),e.push(c),r.push(u),a.push(o),a.push(c),a.push(u);this._erasRegex=new RegExp("^("+a.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+s.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}I(0,["gg",2],0,function(){return this.weekYear()%100});I(0,["GG",2],0,function(){return this.isoWeekYear()%100});function zt(e,s){I(0,[e,e.length],0,s)}zt("gggg","weekYear");zt("ggggg","weekYear");zt("GGGG","isoWeekYear");zt("GGGGG","isoWeekYear");D("G",Wt);D("g",Wt);D("GG",se,xe);D("gg",se,xe);D("GGGG",ws,js);D("gggg",ws,js);D("GGGGG",Ft,Yt);D("ggggg",Ft,Yt);St(["gggg","ggggg","GGGG","GGGGG"],function(e,s,r,a){s[a.substr(0,2)]=q(e)});St(["gg","GG"],function(e,s,r,a){s[a]=C.parseTwoDigitYear(e)});function go(e){return Dr.call(this,e,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function xo(e){return Dr.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function yo(){return Fe(this.year(),1,4)}function vo(){return Fe(this.isoWeekYear(),1,4)}function jo(){var e=this.localeData()._week;return Fe(this.year(),e.dow,e.doy)}function wo(){var e=this.localeData()._week;return Fe(this.weekYear(),e.dow,e.doy)}function Dr(e,s,r,a,n){var i;return e==null?xt(this,a,n).year:(i=Fe(e,a,n),s>i&&(s=i),So.call(this,e,s,r,a,n))}function So(e,s,r,a,n){var i=cr(e,s,r,a,n),o=gt(i.year,0,i.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}I("Q",0,"Qo","quarter");D("Q",Qs);ee("Q",function(e,s){s[Ie]=(q(e)-1)*3});function bo(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}I("D",["DD",2],"Do","date");D("D",se,ct);D("DD",se,xe);D("Do",function(e,s){return e?s._dayOfMonthOrdinalParse||s._ordinalParse:s._dayOfMonthOrdinalParseLenient});ee(["D","DD"],Pe);ee("Do",function(e,s){s[Pe]=q(e.match(se)[0])});var Pr=dt("Date",!0);I("DDD",["DDDD",3],"DDDo","dayOfYear");D("DDD",Lt);D("DDDD",Ks);ee(["DDD","DDDD"],function(e,s,r){r._dayOfYear=q(e)});function _o(e){var s=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?s:this.add(e-s,"d")}I("m",["mm",2],0,"minute");D("m",se,Ss);D("mm",se,xe);ee(["m","mm"],_e);var No=dt("Minutes",!1);I("s",["ss",2],0,"second");D("s",se,Ss);D("ss",se,xe);ee(["s","ss"],Ye);var ko=dt("Seconds",!1);I("S",0,0,function(){return~~(this.millisecond()/100)});I(0,["SS",2],0,function(){return~~(this.millisecond()/10)});I(0,["SSS",3],0,"millisecond");I(0,["SSSS",4],0,function(){return this.millisecond()*10});I(0,["SSSSS",5],0,function(){return this.millisecond()*100});I(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});I(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});I(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});I(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});D("S",Lt,Qs);D("SS",Lt,xe);D("SSS",Lt,Ks);var qe,Tr;for(qe="SSSS";qe.length<=9;qe+="S")D(qe,lt);function Co(e,s){s[Qe]=q(("0."+e)*1e3)}for(qe="S";qe.length<=9;qe+="S")ee(qe,Co);Tr=dt("Milliseconds",!1);I("z",0,0,"zoneAbbr");I("zz",0,0,"zoneName");function Mo(){return this._isUTC?"UTC":""}function Ao(){return this._isUTC?"Coordinated Universal Time":""}var y=jt.prototype;y.add=ji;y.calendar=Ci;y.clone=Mi;y.diff=Oi;y.endOf=Hi;y.format=Li;y.from=Fi;y.fromNow=Wi;y.to=Vi;y.toNow=$i;y.get=Ia;y.invalidAt=eo;y.isAfter=Ai;y.isBefore=Di;y.isBetween=Pi;y.isSame=Ti;y.isSameOrAfter=Ei;y.isSameOrBefore=Ui;y.isValid=Qi;y.lang=Nr;y.locale=_r;y.localeData=kr;y.max=Qn;y.min=Xn;y.parsingFlags=Ki;y.set=Ya;y.startOf=Bi;y.subtract=wi;y.toArray=Ji;y.toObject=Zi;y.toDate=qi;y.toISOString=Ii;y.inspect=Yi;typeof Symbol<"u"&&Symbol.for!=null&&(y[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});y.toJSON=Xi;y.toString=Ri;y.unix=Gi;y.valueOf=zi;y.creationData=to;y.eraName=no;y.eraNarrow=io;y.eraAbbr=oo;y.eraYear=lo;y.year=sr;y.isLeapYear=Ra;y.weekYear=go;y.isoWeekYear=xo;y.quarter=y.quarters=bo;y.month=or;y.daysInMonth=Ga;y.week=y.weeks=tn;y.isoWeek=y.isoWeeks=sn;y.weeksInYear=jo;y.weeksInWeekYear=wo;y.isoWeeksInYear=yo;y.isoWeeksInISOWeekYear=vo;y.date=Pr;y.day=y.days=gn;y.weekday=xn;y.isoWeekday=yn;y.dayOfYear=_o;y.hour=y.hours=Nn;y.minute=y.minutes=No;y.second=y.seconds=ko;y.millisecond=y.milliseconds=Tr;y.utcOffset=oi;y.utc=ci;y.local=di;y.parseZone=hi;y.hasAlignedHourOffset=ui;y.isDST=mi;y.isLocal=pi;y.isUtcOffset=gi;y.isUtc=jr;y.isUTC=jr;y.zoneAbbr=Mo;y.zoneName=Ao;y.dates=Se("dates accessor is deprecated. Use date instead.",Pr);y.months=Se("months accessor is deprecated. Use month instead",or);y.years=Se("years accessor is deprecated. Use year instead",sr);y.zone=Se("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",li);y.isDSTShifted=Se("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",fi);function Do(e){return te(e*1e3)}function Po(){return te.apply(null,arguments).parseZone()}function Er(e){return e}var K=xs.prototype;K.calendar=fa;K.longDateFormat=ya;K.invalidDate=ja;K.ordinal=ba;K.preparse=Er;K.postformat=Er;K.relativeTime=Na;K.pastFuture=ka;K.set=ua;K.eras=so;K.erasParse=ro;K.erasConvertYear=ao;K.erasAbbrRegex=ho;K.erasNameRegex=co;K.erasNarrowRegex=uo;K.months=$a;K.monthsShort=Ba;K.monthsParse=za;K.monthsRegex=Ja;K.monthsShortRegex=qa;K.week=Xa;K.firstDayOfYear=en;K.firstDayOfWeek=Ka;K.weekdays=hn;K.weekdaysMin=mn;K.weekdaysShort=un;K.weekdaysParse=pn;K.weekdaysRegex=vn;K.weekdaysShortRegex=jn;K.weekdaysMinRegex=wn;K.isPM=bn;K.meridiem=kn;function Ut(e,s,r,a){var n=Ve(),i=Ee().set(a,s);return n[r](i,e)}function Ur(e,s,r){if(We(e)&&(s=e,e=void 0),e=e||"",s!=null)return Ut(e,s,r,"month");var a,n=[];for(a=0;a<12;a++)n[a]=Ut(e,a,r,"month");return n}function Os(e,s,r,a){typeof e=="boolean"?(We(s)&&(r=s,s=void 0),s=s||""):(s=e,r=s,e=!1,We(s)&&(r=s,s=void 0),s=s||"");var n=Ve(),i=e?n._week.dow:0,o,c=[];if(r!=null)return Ut(s,(r+i)%7,a,"day");for(o=0;o<7;o++)c[o]=Ut(s,(o+i)%7,a,"day");return c}function To(e,s){return Ur(e,s,"months")}function Eo(e,s){return Ur(e,s,"monthsShort")}function Uo(e,s,r){return Os(e,s,r,"weekdays")}function Oo(e,s,r){return Os(e,s,r,"weekdaysShort")}function Ro(e,s,r){return Os(e,s,r,"weekdaysMin")}Je("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var s=e%10,r=q(e%100/10)===1?"th":s===1?"st":s===2?"nd":s===3?"rd":"th";return e+r}});C.lang=Se("moment.lang is deprecated. Use moment.locale instead.",Je);C.langData=Se("moment.langData is deprecated. Use moment.localeData instead.",Ve);var Oe=Math.abs;function Io(){var e=this._data;return this._milliseconds=Oe(this._milliseconds),this._days=Oe(this._days),this._months=Oe(this._months),e.milliseconds=Oe(e.milliseconds),e.seconds=Oe(e.seconds),e.minutes=Oe(e.minutes),e.hours=Oe(e.hours),e.months=Oe(e.months),e.years=Oe(e.years),this}function Or(e,s,r,a){var n=Ce(s,r);return e._milliseconds+=a*n._milliseconds,e._days+=a*n._days,e._months+=a*n._months,e._bubble()}function Yo(e,s){return Or(this,e,s,1)}function Lo(e,s){return Or(this,e,s,-1)}function Bs(e){return e<0?Math.floor(e):Math.ceil(e)}function Fo(){var e=this._milliseconds,s=this._days,r=this._months,a=this._data,n,i,o,c,u;return e>=0&&s>=0&&r>=0||e<=0&&s<=0&&r<=0||(e+=Bs(ds(r)+s)*864e5,s=0,r=0),a.milliseconds=e%1e3,n=we(e/1e3),a.seconds=n%60,i=we(n/60),a.minutes=i%60,o=we(i/60),a.hours=o%24,s+=we(o/24),u=we(Rr(s)),r+=u,s-=Bs(ds(u)),c=we(r/12),r%=12,a.days=s,a.months=r,a.years=c,this}function Rr(e){return e*4800/146097}function ds(e){return e*146097/4800}function Wo(e){if(!this.isValid())return NaN;var s,r,a=this._milliseconds;if(e=be(e),e==="month"||e==="quarter"||e==="year")switch(s=this._days+a/864e5,r=this._months+Rr(s),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(s=this._days+Math.round(ds(this._months)),e){case"week":return s/7+a/6048e5;case"day":return s+a/864e5;case"hour":return s*24+a/36e5;case"minute":return s*1440+a/6e4;case"second":return s*86400+a/1e3;case"millisecond":return Math.floor(s*864e5)+a;default:throw new Error("Unknown unit "+e)}}function $e(e){return function(){return this.as(e)}}var Ir=$e("ms"),Vo=$e("s"),$o=$e("m"),Bo=$e("h"),Ho=$e("d"),zo=$e("w"),Go=$e("M"),qo=$e("Q"),Jo=$e("y"),Zo=Ir;function Xo(){return Ce(this)}function Qo(e){return e=be(e),this.isValid()?this[e+"s"]():NaN}function et(e){return function(){return this.isValid()?this._data[e]:NaN}}var Ko=et("milliseconds"),el=et("seconds"),tl=et("minutes"),sl=et("hours"),rl=et("days"),al=et("months"),nl=et("years");function il(){return we(this.days()/7)}var Re=Math.round,at={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function ol(e,s,r,a,n){return n.relativeTime(s||1,!!r,e,a)}function ll(e,s,r,a){var n=Ce(e).abs(),i=Re(n.as("s")),o=Re(n.as("m")),c=Re(n.as("h")),u=Re(n.as("d")),f=Re(n.as("M")),j=Re(n.as("w")),M=Re(n.as("y")),v=i<=r.ss&&["s",i]||i<r.s&&["ss",i]||o<=1&&["m"]||o<r.m&&["mm",o]||c<=1&&["h"]||c<r.h&&["hh",c]||u<=1&&["d"]||u<r.d&&["dd",u];return r.w!=null&&(v=v||j<=1&&["w"]||j<r.w&&["ww",j]),v=v||f<=1&&["M"]||f<r.M&&["MM",f]||M<=1&&["y"]||["yy",M],v[2]=s,v[3]=+e>0,v[4]=a,ol.apply(null,v)}function cl(e){return e===void 0?Re:typeof e=="function"?(Re=e,!0):!1}function dl(e,s){return at[e]===void 0?!1:s===void 0?at[e]:(at[e]=s,e==="s"&&(at.ss=s-1),!0)}function hl(e,s){if(!this.isValid())return this.localeData().invalidDate();var r=!1,a=at,n,i;return typeof e=="object"&&(s=e,e=!1),typeof e=="boolean"&&(r=e),typeof s=="object"&&(a=Object.assign({},at,s),s.s!=null&&s.ss==null&&(a.ss=s.s-1)),n=this.localeData(),i=ll(this,!r,a,n),r&&(i=n.pastFuture(+this,i)),n.postformat(i)}var ss=Math.abs;function st(e){return(e>0)-(e<0)||+e}function Gt(){if(!this.isValid())return this.localeData().invalidDate();var e=ss(this._milliseconds)/1e3,s=ss(this._days),r=ss(this._months),a,n,i,o,c=this.asSeconds(),u,f,j,M;return c?(a=we(e/60),n=we(a/60),e%=60,a%=60,i=we(r/12),r%=12,o=e?e.toFixed(3).replace(/\.?0+$/,""):"",u=c<0?"-":"",f=st(this._months)!==st(c)?"-":"",j=st(this._days)!==st(c)?"-":"",M=st(this._milliseconds)!==st(c)?"-":"",u+"P"+(i?f+i+"Y":"")+(r?f+r+"M":"")+(s?j+s+"D":"")+(n||a||e?"T":"")+(n?M+n+"H":"")+(a?M+a+"M":"")+(e?M+o+"S":"")):"P0D"}var Z=Ht.prototype;Z.isValid=ri;Z.abs=Io;Z.add=Yo;Z.subtract=Lo;Z.as=Wo;Z.asMilliseconds=Ir;Z.asSeconds=Vo;Z.asMinutes=$o;Z.asHours=Bo;Z.asDays=Ho;Z.asWeeks=zo;Z.asMonths=Go;Z.asQuarters=qo;Z.asYears=Jo;Z.valueOf=Zo;Z._bubble=Fo;Z.clone=Xo;Z.get=Qo;Z.milliseconds=Ko;Z.seconds=el;Z.minutes=tl;Z.hours=sl;Z.days=rl;Z.weeks=il;Z.months=al;Z.years=nl;Z.humanize=hl;Z.toISOString=Gt;Z.toString=Gt;Z.toJSON=Gt;Z.locale=_r;Z.localeData=kr;Z.toIsoString=Se("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Gt);Z.lang=Nr;I("X",0,0,"unix");I("x",0,0,"valueOf");D("x",Wt);D("X",Da);ee("X",function(e,s,r){r._d=new Date(parseFloat(e)*1e3)});ee("x",function(e,s,r){r._d=new Date(q(e))});//! moment.js
C.version="2.30.1";da(te);C.fn=y;C.min=Kn;C.max=ei;C.now=ti;C.utc=Ee;C.unix=Do;C.months=To;C.isDate=vt;C.locale=Je;C.invalid=It;C.duration=Ce;C.isMoment=ke;C.weekdays=Uo;C.parseZone=Po;C.localeData=Ve;C.isDuration=Ct;C.monthsShort=Eo;C.weekdaysMin=Ro;C.defineLocale=Cs;C.updateLocale=Dn;C.locales=Pn;C.weekdaysShort=Oo;C.normalizeUnits=be;C.relativeTimeRounding=cl;C.relativeTimeThreshold=dl;C.calendarFormat=ki;C.prototype=y;C.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const ul=({videos:e})=>{const s=ge();return t.jsx("div",{className:"feed",children:e.map(r=>t.jsxs("div",{className:"card",style:{cursor:"pointer"},onClick:()=>{console.log("Clicked item:",r),s(`/video/${r.categoryId||0}/${r.id}`)},children:[t.jsx("img",{src:r.thumbnail||"https://via.placeholder.com/320x180?text=No+Thumbnail",alt:""}),t.jsx("h2",{children:r.title}),t.jsx("h3",{children:r.channelTitle||"Creator"}),t.jsxs("p",{children:[ca(r.viewCount||0)," Views • "," "+C(r.created_at).fromNow()]})]},r.id))})},ml=({sidebar:e,category:s,selectedCategory:r,setSelectedCategory:a})=>{const[n,i]=l.useState([]),[o,c]=l.useState(!0),[u,f]=l.useState("");return ge(),l.useEffect(()=>{(async()=>{c(!0),f("");let M=_.from("videos2").select("*").order("created_at",{ascending:!1});s&&s!=="All"&&(M=M.eq("category",s));let{data:v,error:d}=await M;d?(f("Failed to fetch videos."),i([])):i(v||[]),c(!1)})()},[s]),t.jsx(t.Fragment,{children:t.jsxs("div",{className:`container ${e?"":" large-container"}`,children:[t.jsx("div",{className:"user-flow-section",children:t.jsxs("div",{className:"flow-steps",children:[t.jsxs("div",{className:"flow-step",children:[t.jsx("div",{className:"step-number",children:"1"}),t.jsxs("div",{className:"step-content",children:[t.jsx("h3",{children:"Choose Video"}),t.jsx("p",{children:"Browse and select your favorite video content"})]})]}),t.jsx("div",{className:"flow-arrow",children:"→"}),t.jsxs("div",{className:"flow-step",children:[t.jsx("div",{className:"step-number",children:"2"}),t.jsxs("div",{className:"step-content",children:[t.jsx("h3",{children:"Pick Screenshot"}),t.jsx("p",{children:"Select the perfect moment to capture"})]})]}),t.jsx("div",{className:"flow-arrow",children:"→"}),t.jsxs("div",{className:"flow-step",children:[t.jsx("div",{className:"step-number",children:"3"}),t.jsxs("div",{className:"step-content",children:[t.jsx("h3",{children:"Make Merchandise"}),t.jsx("p",{children:"Create custom products with your screenshot"})]})]})]})}),o&&t.jsx("div",{style:{padding:24},children:"Loading videos..."}),u&&t.jsx("div",{style:{padding:24,color:"red"},children:u}),!o&&!u&&n.length>0&&t.jsx(ul,{videos:n})]})})},fl=({isOpen:e,image:s,onCrop:r,onCancel:a})=>{console.log("🎯 CropModal v2.0 loaded with resize handles!",{isOpen:e,image:(s==null?void 0:s.substring(0,50))+"...",timestamp:new Date().toISOString(),version:"2.0.2",cacheBuster:Math.random()});const[n,i]=l.useState({x:50,y:50,width:200,height:200}),[o,c]=l.useState(!1),[u,f]=l.useState(!1),[j,M]=l.useState(null),[v,d]=l.useState({x:0,y:0}),[T,w]=l.useState("free"),[x,F]=l.useState({width:0,height:0}),h=l.useRef(null);l.useRef(null),l.useEffect(()=>{if(e&&s){const b=new Image;b.crossOrigin="anonymous",b.onload=()=>{const P=h.current,g=P.getContext("2d");P.width=b.width,P.height=b.height,F({width:b.width,height:b.height}),g.drawImage(b,0,0);const A=b.width/2-150,p=b.height/2-150,m=Math.min(300,Math.min(b.width,b.height)*.8);i({x:Math.max(0,A),y:Math.max(0,p),width:m,height:m})},b.onerror=()=>{console.error("Failed to load image with CORS. Trying without CORS...");const P=new Image;P.onload=()=>{const g=h.current,A=g.getContext("2d");g.width=P.width,g.height=P.height,F({width:P.width,height:P.height}),A.drawImage(P,0,0);const p=P.width/2-150,m=P.height/2-150,E=Math.min(300,Math.min(P.width,P.height)*.8);i({x:Math.max(0,p),y:Math.max(0,m),width:E,height:E})},P.src=s},b.src=s}},[e,s]);const N=b=>{const P=h.current.getBoundingClientRect(),g=b.clientX-P.left,A=b.clientY-P.top,p=10;return g>=n.x-p&&g<=n.x+p&&A>=n.y-p&&A<=n.y+p?"top-left":g>=n.x+n.width-p&&g<=n.x+n.width+p&&A>=n.y-p&&A<=n.y+p?"top-right":g>=n.x-p&&g<=n.x+p&&A>=n.y+n.height-p&&A<=n.y+n.height+p?"bottom-left":g>=n.x+n.width-p&&g<=n.x+n.width+p&&A>=n.y+n.height-p&&A<=n.y+n.height+p?"bottom-right":g>=n.x-p&&g<=n.x+p&&A>=n.y&&A<=n.y+n.height?"left":g>=n.x+n.width-p&&g<=n.x+n.width+p&&A>=n.y&&A<=n.y+n.height?"right":A>=n.y-p&&A<=n.y+p&&g>=n.x&&g<=n.x+n.width?"top":A>=n.y+n.height-p&&A<=n.y+n.height+p&&g>=n.x&&g<=n.x+n.width?"bottom":null},H=b=>{const P=h.current.getBoundingClientRect(),g=b.clientX-P.left,A=b.clientY-P.top,p=N(b);if(p){f(!0),M(p),d({x:g,y:A});return}g>=n.x&&g<=n.x+n.width&&A>=n.y&&A<=n.y+n.height&&(c(!0),d({x:g-n.x,y:A-n.y}))},X=b=>{const P=h.current.getBoundingClientRect(),g=b.clientX-P.left,A=b.clientY-P.top;if(o){const p=Math.max(0,Math.min(g-v.x,x.width-n.width)),m=Math.max(0,Math.min(A-v.y,x.height-n.height));i(E=>({...E,x:p,y:m}))}else if(u){let p={...n};switch(j){case"top-left":p.x=Math.min(g,n.x+n.width-20),p.y=Math.min(A,n.y+n.height-20),p.width=n.x+n.width-p.x,p.height=n.y+n.height-p.y;break;case"top-right":p.y=Math.min(A,n.y+n.height-20),p.width=Math.max(20,g-n.x),p.height=n.y+n.height-p.y;break;case"bottom-left":p.x=Math.min(g,n.x+n.width-20),p.width=n.x+n.width-p.x,p.height=Math.max(20,A-n.y);break;case"bottom-right":p.width=Math.max(20,g-n.x),p.height=Math.max(20,A-n.y);break;case"left":p.x=Math.min(g,n.x+n.width-20),p.width=n.x+n.width-p.x;break;case"right":p.width=Math.max(20,g-n.x);break;case"top":p.y=Math.min(A,n.y+n.height-20),p.height=n.y+n.height-p.y;break;case"bottom":p.height=Math.max(20,A-n.y);break}T!=="free"&&(p=W(p,T)),p.x=Math.max(0,Math.min(p.x,x.width-p.width)),p.y=Math.max(0,Math.min(p.y,x.height-p.height)),p.width=Math.min(p.width,x.width-p.x),p.height=Math.min(p.height,x.height-p.y),i(p)}},W=(b,P)=>{let g={...b};switch(P){case"square":const A=Math.min(b.width,b.height);g.width=A,g.height=A;break;case"16:9":g.height=b.width*(9/16);break;case"4:3":g.height=b.width*(3/4);break;case"3:4":g.width=b.height*(3/4);break}return g},z=()=>{c(!1),f(!1),M(null)},R=b=>{if(w(b),b!=="free"){const P=W(n,b);P.x+P.width>x.width&&(P.x=x.width-P.width),P.y+P.height>x.height&&(P.y=x.height-P.height),i(P)}},L=()=>{try{const b=h.current,P=b.getContext("2d"),g=document.createElement("canvas"),A=g.getContext("2d");g.width=n.width,g.height=n.height,A.drawImage(b,n.x,n.y,n.width,n.height,0,0,n.width,n.height);let p;try{p=g.toDataURL("image/png")}catch(m){console.error("CORS error when creating data URL:",m),g.toBlob(E=>{const B=URL.createObjectURL(E);r(B)},"image/png");return}r(p)}catch(b){console.error("Error during crop operation:",b),alert("Error cropping image. Please try again.")}},J=b=>{if(!h.current)return"default";const P=N(b);if(!P){const g=h.current.getBoundingClientRect(),A=b.clientX-g.left,p=b.clientY-g.top;return A>=n.x&&A<=n.x+n.width&&p>=n.y&&p<=n.y+n.height?"move":"default"}switch(P){case"top-left":case"bottom-right":return"nw-resize";case"top-right":case"bottom-left":return"ne-resize";case"left":case"right":return"ew-resize";case"top":case"bottom":return"ns-resize";default:return"default"}};return e?t.jsx("div",{className:"crop-modal-overlay","data-version":"2.0.2","data-cache-buster":Math.random(),children:t.jsxs("div",{className:"crop-modal",children:[t.jsxs("div",{className:"crop-modal-header",children:[t.jsxs("h3",{children:["Crop Screenshot (v2.0.2) - ",new Date().toLocaleTimeString()," - CACHE BUSTED"]}),t.jsx("button",{className:"crop-modal-close",onClick:a,style:{marginRight:"10px"},children:"×"}),t.jsx("button",{onClick:()=>window.location.reload(!0),style:{background:"#ff4444",color:"white",border:"none",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",cursor:"pointer"},children:"FORCE REFRESH"})]}),t.jsxs("div",{className:"crop-modal-content",children:[t.jsxs("div",{className:"crop-tools",children:[t.jsx("label",{children:"Aspect Ratio:"}),t.jsxs("select",{value:T,onChange:b=>R(b.target.value),children:[t.jsx("option",{value:"free",children:"Free"}),t.jsx("option",{value:"square",children:"Square (1:1)"}),t.jsx("option",{value:"16:9",children:"Landscape (16:9)"}),t.jsx("option",{value:"4:3",children:"Standard (4:3)"}),t.jsx("option",{value:"3:4",children:"Portrait (3:4)"})]}),t.jsx("div",{className:"crop-info",children:t.jsxs("span",{children:["Size: ",Math.round(n.width)," × ",Math.round(n.height),"px"]})})]}),t.jsxs("div",{className:"crop-canvas-container",children:[t.jsx("div",{className:"crop-instructions",children:"Drag to move • Drag handles to resize • Use aspect ratio dropdown"}),t.jsx("canvas",{ref:h,className:"crop-canvas",style:{cursor:J},onMouseDown:H,onMouseMove:X,onMouseUp:z,onMouseLeave:z}),t.jsxs("div",{className:"crop-overlay",style:{left:n.x,top:n.y,width:n.width,height:n.height},children:[t.jsx("div",{className:"resize-handle top-left"}),t.jsx("div",{className:"resize-handle top-right"}),t.jsx("div",{className:"resize-handle bottom-left"}),t.jsx("div",{className:"resize-handle bottom-right"}),t.jsx("div",{className:"resize-handle left"}),t.jsx("div",{className:"resize-handle right"}),t.jsx("div",{className:"resize-handle top"}),t.jsx("div",{className:"resize-handle bottom"})]})]})]}),t.jsxs("div",{className:"crop-modal-footer",children:[t.jsx("button",{className:"crop-btn cancel",onClick:a,children:"Cancel"}),t.jsx("button",{className:"crop-btn apply",onClick:L,children:"Apply Crop"})]})]})}):null},qt=({isOpen:e,onClose:s,onSuccess:r})=>{const[a,n]=l.useState(!0),[i,o]=l.useState(""),[c,u]=l.useState(""),[f,j]=l.useState(!1),[M,v]=l.useState(""),d=async w=>{w.preventDefault(),j(!0),v("");try{const x=a?"/api/auth/login":"/api/auth/signup",F=`${he.BASE_URL}${x}`;console.log("Attempting auth request to:",F),console.log("Mode:",a?"login":"signup"),console.log("Email:",i.trim());const h=await fetch(F,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({email:i.trim(),password:c})});if(console.log("Response status:",h.status),console.log("Response headers:",Object.fromEntries(h.headers.entries())),!h.ok){const H=await h.text();throw console.error("Server error response:",H),new Error(`Server error: ${h.status} - ${H}`)}const N=await h.json();console.log("Response data:",N),N.success?(localStorage.setItem("user_authenticated","true"),localStorage.setItem("user_email",i.trim()),v({type:"success",text:N.message}),setTimeout(()=>{r(),s()},1500)):v({type:"error",text:N.error||"Authentication failed"})}catch(x){console.error("Auth error:",x),v({type:"error",text:`Network error: ${x.message}. Please check the console for details.`})}finally{j(!1)}},T=()=>{n(!a),v("")};return e?t.jsx("div",{className:"auth-modal-overlay",onClick:s,children:t.jsxs("div",{className:"auth-modal",onClick:w=>w.stopPropagation(),children:[t.jsxs("div",{className:"auth-modal-header",children:[t.jsx("div",{className:"auth-logo",children:"🎯"}),t.jsx("h2",{children:"ScreenMerch Login"}),t.jsx("button",{className:"auth-close-btn",onClick:s,children:"×"})]}),t.jsxs("div",{className:"auth-message",children:[t.jsx("strong",{children:"Login Required"}),t.jsx("br",{}),"To create merchandise, please log in or create an account with your email address."]}),t.jsxs("form",{onSubmit:d,className:"auth-form",children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"email",children:"Email Address"}),t.jsx("input",{type:"email",id:"email",value:i,onChange:w=>o(w.target.value),required:!0,placeholder:"Enter your email"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"password",children:"Password"}),t.jsx("input",{type:"password",id:"password",value:c,onChange:w=>u(w.target.value),required:!0,placeholder:"Enter your password"})]}),t.jsx("button",{type:"submit",className:"auth-submit-btn",disabled:f,children:f?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"loading-spinner"}),"Processing..."]}):a?"Login":"Sign Up"})]}),t.jsxs("div",{className:"auth-toggle",children:[t.jsx("span",{children:a?"Don't have an account?":"Already have an account?"}),t.jsx("button",{type:"button",onClick:T,className:"auth-toggle-btn",children:a?"Sign Up":"Login"})]}),M&&t.jsx("div",{className:`auth-message-display ${M.type}`,children:M.text})]})}):null},pl=({videoId:e,thumbnail:s,setThumbnail:r,screenshots:a,setScreenshots:n,videoRef:i,onVideoData:o})=>{const c=hs(),u=e||c.videoId,[f,j]=l.useState(null),[M,v]=l.useState(!0),[d,T]=l.useState(""),w=i||l.useRef(null),[x,F]=l.useState(!1),[h,N]=l.useState({x:0,y:0,width:0,height:0}),[H,X]=l.useState(!1),[W,z]=l.useState({x:0,y:0}),[R]=l.useState(l.useRef(null)),[L,J]=l.useState(null),[b,P]=l.useState(!1),[g,A]=l.useState(!1);l.useState(!1),l.useState(null),l.useState(null);const[p,m]=l.useState(!1),E=(S,O="info")=>{const Y=document.querySelector(".custom-notification");Y&&Y.remove();const U=document.createElement("div");U.className=`custom-notification ${O}`,U.style.cssText=`
            position: fixed;
            top: 20px;
            right: 20px;
            background: ${O==="success"?"#4CAF50":O==="warning"?"#FF9800":"#2196F3"};
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            z-index: 10000;
            font-size: 14px;
            font-weight: 500;
            max-width: 300px;
            word-wrap: break-word;
            animation: slideIn 0.3s ease;
        `,U.textContent=S;const G=document.createElement("style");G.textContent=`
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
        `,document.head.appendChild(G),document.body.appendChild(U),setTimeout(()=>{U.parentNode&&(U.style.animation="slideOut 0.3s ease",setTimeout(()=>{U.parentNode&&U.remove()},300))},3e3)};l.useEffect(()=>{if(!u){T("No video selected."),v(!1);return}(async()=>{v(!0),T("");let{data:O,error:Y}=await _.from("videos2").select("*").eq("id",u).single();Y?(T("Video not found."),j(null)):(j(O),(O.thumbnail||O.poster)&&r(O.thumbnail||O.poster),o&&o(O)),v(!1)})()},[u,r]),l.useEffect(()=>{w.current&&w.current.load(),n([]),F(!1),N({x:0,y:0,width:0,height:0}),J(null),P(!1)},[u,n]),l.useEffect(()=>{if(x&&w.current){w.current.pause();const S=()=>{x&&w.current.pause()},O=Y=>{x&&(Y.preventDefault(),Y.stopPropagation(),w.current.pause())};return w.current.addEventListener("play",S),w.current.addEventListener("click",O),()=>{w.current&&(w.current.removeEventListener("play",S),w.current.removeEventListener("click",O))}}},[x]),l.useEffect(()=>()=>{document.body.style.overflow="auto"},[]),l.useEffect(()=>{if(w.current){const S=w.current;S.style.width="100%",S.style.height="360px",S.style.minWidth="100%",S.style.minHeight="360px",S.style.maxWidth="100%",S.style.maxHeight="360px",S.style.objectFit="contain",S.style.transition="none",S.style.flexShrink="0",S.style.flexGrow="0";const O=S.parentElement;O&&(O.style.height="360px",O.style.minHeight="360px",O.style.maxHeight="360px",O.style.transition="none",O.style.flexShrink="0",O.style.flexGrow="0")}},[x]);const B=S=>{if(!x||!w.current)return;S.preventDefault(),S.stopPropagation(),w.current&&w.current.pause();const O=w.current.getBoundingClientRect(),Y=S.clientX-O.left,U=S.clientY-O.top;console.log("Crop mouse down at:",{x:Y,y:U}),X(!0),z({x:Y,y:U}),N({x:Y,y:U,width:0,height:0})},ie=S=>{if(!x||!H||!w.current)return;S.preventDefault(),S.stopPropagation(),w.current&&w.current.pause();const O=w.current.getBoundingClientRect(),Y=S.clientX-O.left,U=S.clientY-O.top,G=Math.abs(Y-W.x),Ae=Math.abs(U-W.y),ye=Math.min(Y,W.x),De=Math.min(U,W.y),ze={x:ye,y:De,width:G,height:Ae};console.log("Crop area updated:",ze),N(ze)},ce=()=>{X(!1),w.current&&w.current.pause(),console.log("Crop selection finished. Final crop area:",h)},Me=S=>{if(!x||!w.current||!S.touches||S.touches.length===0)return;S.preventDefault(),S.stopPropagation(),w.current&&w.current.pause();const O=S.touches[0],Y=w.current.getBoundingClientRect(),U=O.clientX-Y.left,G=O.clientY-Y.top;X(!0),z({x:U,y:G}),N({x:U,y:G,width:0,height:0})},Ze=S=>{if(!x||!H||!w.current||!S.touches||S.touches.length===0)return;S.preventDefault(),S.stopPropagation(),w.current&&w.current.pause();const O=S.touches[0],Y=w.current.getBoundingClientRect(),U=O.clientX-Y.left,G=O.clientY-Y.top,Ae=Math.abs(U-W.x),ye=Math.abs(G-W.y),De=Math.min(U,W.x),ze=Math.min(G,W.y);N({x:De,y:ze,width:Ae,height:ye})},Be=S=>{S.preventDefault(),S.stopPropagation(),X(!1),w.current&&w.current.pause()},tt=()=>{N({x:0,y:0,width:0,height:0}),J(null),P(!1)},He=async()=>{if(console.log("Apply crop called with cropArea:",h),!w.current||!x){alert("Please enable crop tool first");return}if(h.width<150||h.height<150){alert("Please select a larger crop area (minimum 150x150 pixels for good print quality and proper aspect ratio)");return}A(!0);try{const S=w.current.currentTime||0,O=f.video_url,Y=w.current;Y.readyState<1&&await new Promise(Xt=>{Y.addEventListener("loadedmetadata",Xt,{once:!0})});const U=Y.videoWidth,G=Y.videoHeight,Ae=Y.getBoundingClientRect(),ye=Ae.width,De=Ae.height;console.log("Video actual dimensions:",{videoWidth:U,videoHeight:G}),console.log("Video display dimensions:",{displayWidth:ye,displayHeight:De}),console.log("Crop area (display pixels):",h);const ze=U/ye,Jt=G/De;console.log("Scale factors:",{scaleX:ze,scaleY:Jt});const me={x:Math.round(h.x*ze),y:Math.round(h.y*Jt),width:Math.round(h.width*ze),height:Math.round(h.height*Jt)};me.x=Math.max(0,Math.min(me.x,U-1)),me.y=Math.max(0,Math.min(me.y,G-1)),me.width=Math.max(1,Math.min(me.width,U-me.x)),me.height=Math.max(1,Math.min(me.height,G-me.y));const Rs={x:me.x/U,y:me.y/G,width:me.width/U,height:me.height/G};console.log("Video crop area (pixels):",me),console.log("Normalized crop area (0-1):",Rs);const Zt=await fetch(he.ENDPOINTS.CAPTURE_SCREENSHOT,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({video_url:O,timestamp:S,crop_area:Rs})});if(!Zt.ok)throw new Error(`HTTP error! status: ${Zt.status}`);const bt=await Zt.json();if(bt.success){console.log("Crop applied successfully"),n(Qt=>{const Yr=Qt.length<6?[...Qt,bt.screenshot]:Qt;return console.log("Automatically added cropped image to screenshots"),Yr});const Xt=a.length+1;alert(`Cropped screenshot ${Xt} captured and added to grid!`),F(!1),N({x:0,y:0,width:0,height:0}),X(!1),z({x:0,y:0}),J(null),P(!1),document.body.style.overflow="auto"}else console.error("Crop failed:",bt.error),alert("Failed to apply crop: "+bt.error)}catch(S){console.error("Error applying crop:",S),alert("Error applying crop: "+S.message)}finally{A(!1)}},k=()=>{x?(F(!1),N({x:0,y:0,width:0,height:0}),J(null),P(!1),document.body.style.overflow="auto"):(F(!0),J(null),P(!1),w.current&&w.current.pause(),document.body.style.overflow="hidden")},V=async()=>{if(console.log("🔘 Grab Screenshot clicked"),a.length>=6){E("Maximum 6 screenshots allowed. Please delete some screenshots first.","warning");return}if(b&&L){console.log("✅ Using cropped image for screenshot"),n(G=>G.length<6?[...G,L]:G);const U=a.length+1;E(`Cropped screenshot ${U} captured successfully!`,"success"),J(null),P(!1),F(!1),N({x:0,y:0,width:0,height:0});return}const S=w.current;if(!S){E("Video not loaded yet. Please wait for the video to load.","warning");return}if(!f){E("Video data not loaded yet. Please wait for the video to load.","warning");return}try{console.log("Attempting to capture actual screenshot from video frame...");const U=document.createElement("canvas"),G=U.getContext("2d");U.width=S.videoWidth||640,U.height=S.videoHeight||360,G.drawImage(S,0,0,U.width,U.height);const Ae=U.toDataURL("image/jpeg",.85);console.log("Actual screenshot captured from video frame"),n(De=>De.length<6?[...De,Ae]:De);const ye=a.length+1;E(`Screenshot ${ye} captured successfully!`,"success");return}catch(U){console.error("Failed to capture actual screenshot:",U);const G=f.thumbnail||f.poster||S.poster;if(G&&G!=="undefined"&&G!=="null"){console.log("Fallback: Using video thumbnail as screenshot"),n(ye=>ye.length<6?[...ye,G]:ye);const Ae=a.length+1;E(`Screenshot ${Ae} captured successfully! (using thumbnail)`,"success");return}}console.log("No thumbnail available, creating placeholder");const O=`https://via.placeholder.com/300x200/FF5722/FFFFFF?text=Screenshot+${a.length+1}`;n(U=>U.length<6?[...U,O]:U);const Y=a.length+1;E(`Screenshot ${Y} captured successfully! (using placeholder)`,"success")},oe=async()=>{try{if(console.log("🔘 Make Merch button clicked!"),a.length===0){alert("Please capture at least one screenshot before creating merchandise.");return}if(!(localStorage.getItem("user_authenticated")==="true")){const G={thumbnail:s,videoUrl:window.location.href,screenshots:a.slice(0,6)};localStorage.setItem("pending_merch_data",JSON.stringify(G)),m(!0);return}console.log("📤 Sending merch creation request...");const O={thumbnail:s,videoUrl:window.location.href,screenshots:a.slice(0,6)};console.log("📤 Request data:",O);const Y=await fetch(he.ENDPOINTS.CREATE_PRODUCT,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(O)});if(console.log("📥 Response status:",Y.status),!Y.ok){const G=await Y.text();console.error("❌ Server error:",G),alert(`Server error: ${Y.status}. Please try again.`);return}const U=await Y.json();console.log("✅ Success! Response:",U),U.success&&U.product_url?(console.log("🚀 Redirecting to:",U.product_url),window.location.href=U.product_url):(console.error("❌ Failed to create product:",U),alert(`Failed to create merchandise: ${U.error||"Unknown error"}`))}catch(S){console.error("❌ Make Merch error:",S),alert(`Connection error: ${S.message}. Please check your internet connection and try again.`)}},ae=async()=>{const S=localStorage.getItem("pending_merch_data");if(S){localStorage.removeItem("pending_merch_data");try{const O=JSON.parse(S);console.log("Creating merch product after authentication:",O);const Y=await fetch(he.ENDPOINTS.CREATE_PRODUCT,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(O)});if(!Y.ok)throw new Error(`HTTP error! status: ${Y.status}`);const U=await Y.json();U.success&&U.product_url?(console.log("Merch product created successfully, redirecting to:",U.product_url),window.location.href=U.product_url):(console.error("Failed to create product:",U),alert(`Failed to create merch product: ${U.error||"Unknown error"}`))}catch(O){console.error("Error creating merch product after auth:",O),alert("Error creating merch product. Please try again.")}}};return M?t.jsx("div",{style:{padding:24},children:"Loading video..."}):d||!f?t.jsx("div",{style:{padding:24,color:"red"},children:d||"Video not found."}):t.jsxs("div",{className:"play-video",children:[t.jsxs("div",{className:"video-container",ref:R,style:{position:"relative",display:"inline-block"},children:[t.jsxs("div",{style:{position:"relative",display:"inline-block",width:"100%",maxWidth:"640px",height:"360px",minHeight:"360px",maxHeight:"360px",overflow:"hidden",boxSizing:"border-box",transition:"none",flexShrink:0,flexGrow:0,touchAction:x?"none":"manipulation",overscrollBehavior:"contain"},children:[t.jsx("video",{ref:w,controls:!0,playsInline:!0,"webkit-playsinline":"true",disablePictureInPicture:!0,controlsList:"nodownload",width:"100%",style:{background:"#000",cursor:x?"crosshair":"default",width:"100%",height:"360px",maxWidth:"100%",maxHeight:"360px",minWidth:"100%",minHeight:"360px",objectFit:"contain",transition:"none",flexShrink:0,flexGrow:0,touchAction:x?"none":"manipulation"},poster:f.thumbnail||"",src:f.video_url,crossOrigin:"anonymous",onMouseDown:x?B:void 0,onMouseMove:x?ie:void 0,onMouseUp:x?ce:void 0,onMouseLeave:x?ce:void 0,onClick:x?S=>S.preventDefault():void 0,onTouchStart:x?Me:void 0,onTouchMove:x?Ze:void 0,onTouchEnd:x?Be:void 0,children:"Your browser does not support the video tag."},u),x&&h.width>0&&h.height>0&&t.jsx("div",{className:"crop-selection",style:{position:"absolute",left:h.x,top:h.y,width:h.width,height:h.height,border:"2px solid #ff0000",background:"rgba(255, 0, 0, 0.1)",pointerEvents:"none",zIndex:1e3}}),x&&h.width>0&&h.height>0&&t.jsxs("div",{style:{position:"absolute",top:"5px",left:"5px",background:"rgba(0, 0, 0, 0.9)",color:"white",padding:"8px",fontSize:"12px",zIndex:1001,fontFamily:"monospace",borderRadius:"4px",border:"1px solid #fff"},children:[t.jsxs("div",{children:["Crop: ",Math.round(h.x),",",Math.round(h.y)]}),t.jsxs("div",{children:["Size: ",Math.round(h.width),"x",Math.round(h.height)]}),t.jsx("div",{style:{color:h.width>=150&&h.height>=150?"#4CAF50":"#FF9800",fontWeight:"bold"},children:h.width>=150&&h.height>=150?"✅ Good size":"⚠️ Min 150x150px"})]})]}),t.jsxs("div",{className:"crop-tool-button",style:{position:"absolute",top:"10px",left:"10px",zIndex:1e3,display:"flex",flexDirection:"column",gap:"8px"},children:[t.jsx("button",{onClick:k,style:{padding:"8px 12px",borderRadius:"4px",border:"none",background:x?"#dc3545":"#28a745",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"bold",boxShadow:"0 2px 4px rgba(0,0,0,0.3)"},title:x?"Click and drag to select crop area":"Enable crop tool",children:x?"✂️ Crop Active":"✂️ Crop"}),x&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:tt,style:{padding:"8px 12px",borderRadius:"4px",border:"none",background:"#6c757d",color:"white",cursor:"pointer",fontSize:"14px"},title:"Clear crop selection",children:"Clear"}),t.jsx("button",{onClick:He,disabled:g,style:{padding:"8px 12px",borderRadius:"4px",border:"none",background:g?"#6c757d":"#007bff",color:"white",cursor:g?"not-allowed":"pointer",fontSize:"14px",display:"flex",alignItems:"center",gap:"6px"},title:g?"Applying crop...":"Apply crop to selected screenshot",children:g?t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{width:"12px",height:"12px",border:"2px solid #ffffff",borderTop:"2px solid transparent",borderRadius:"50%",animation:"spin 1s linear infinite"}}),"Processing..."]}):"Apply Crop"})]})]})]}),t.jsxs("div",{className:"screenmerch-actions",style:{display:"flex",gap:"10px",marginBottom:"15px",flexWrap:"wrap"},children:[t.jsx("button",{className:"screenmerch-btn",onClick:V,style:{padding:"10px 20px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"5px",cursor:"pointer",fontWeight:"bold"},children:"Select Screenshot"}),t.jsx("button",{className:"screenmerch-btn",onClick:oe,style:{padding:"10px 20px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"5px",cursor:"pointer",fontWeight:"bold"},children:"Make Merch"})]}),t.jsx("h3",{children:f.title}),t.jsx("div",{className:"play-video-info",children:t.jsx("p",{children:C(f.created_at).fromNow()})}),t.jsx("hr",{}),t.jsx("div",{className:"vid-description",children:t.jsx("p",{children:f.description})}),t.jsx(qt,{isOpen:p,onClose:()=>m(!1),onSuccess:ae})]})},gl=({thumbnail:e,screenshots:s,onDeleteScreenshot:r,onCropScreenshot:a})=>{const[n,i]=l.useState(!1),[o,c]=l.useState(null),[u,f]=l.useState(null),j=d=>{s[d]&&(c(d),f(s[d]),i(!0))},M=d=>{o!==null&&a&&a(o,d),i(!1),c(null),f(null)},v=()=>{i(!1),c(null),f(null)};return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"screenmerch-images-grid",children:[0,1,2,3,4,5].map(d=>t.jsxs("div",{className:"screenmerch-image-box",children:[t.jsxs("h4",{children:["Screenshot ",d+1]}),s[d]?t.jsxs("div",{className:"screenmerch-img-wrapper",children:[t.jsx("img",{src:s[d],alt:`Screenshot ${d+1}`,className:"screenmerch-preview",style:{maxWidth:"100%",maxHeight:"100%",width:"auto",height:"auto",objectFit:"contain",cursor:"pointer"},onClick:()=>j(d),title:"Click to crop this screenshot"}),t.jsx("div",{className:"screenmerch-buttons",children:t.jsx("button",{className:"screenmerch-delete-btn",onClick:()=>r(d),title:"Delete screenshot",children:"×"})})]}):t.jsx("div",{className:"screenmerch-placeholder",children:"No screenshot"})]},d))}),t.jsx(fl,{isOpen:n,image:u,onCrop:M,onCancel:v})]})},xl=()=>{const{videoId:e,categoryId:s}=hs(),[r,a]=l.useState(null),[n,i]=l.useState([]),[o,c]=l.useState(!1),[u,f]=l.useState(!1),[j,M]=l.useState(null),v=l.useRef(null),d=(W,z="info")=>{const R=document.querySelector(".custom-notification");R&&R.remove();const L=document.createElement("div");L.className=`custom-notification ${z}`,L.style.cssText=`
      position: fixed;
      top: 20px;
      right: 20px;
      background: ${z==="success"?"#4CAF50":z==="warning"?"#FF9800":"#2196F3"};
      color: white;
      padding: 12px 20px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      z-index: 10000;
      font-size: 14px;
      font-weight: 500;
      max-width: 300px;
      word-wrap: break-word;
      animation: slideIn 0.3s ease;
    `,L.textContent=W;const J=document.createElement("style");J.textContent=`
      @keyframes slideIn {
        from { transform: translateX(100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
      }
    `,document.head.appendChild(J),document.body.appendChild(L),setTimeout(()=>{L.parentNode&&(L.style.animation="slideOut 0.3s ease",setTimeout(()=>{L.parentNode&&L.remove()},300))},3e3)};l.useEffect(()=>{e&&(i([]),a(null),localStorage.removeItem("merch_screenshots"),localStorage.removeItem("merch_thumbnail"),localStorage.removeItem("merch_video_data"))},[e]),l.useEffect(()=>{localStorage.removeItem("merch_screenshots"),localStorage.removeItem("merch_thumbnail"),localStorage.removeItem("merch_video_data")},[]),l.useEffect(()=>{const W=()=>{c(window.innerWidth<=768)};return W(),window.addEventListener("resize",W),()=>window.removeEventListener("resize",W)},[]),l.useEffect(()=>{r&&n.length===0&&i([r])},[r,n.length]);const T=W=>{i(z=>z.filter((R,L)=>L!==W))},w=(W,z)=>{i(R=>{const L=[...R];return L[W]=z,L})},x=()=>{if(n.length===0){d("No screenshots to clear.","warning");return}window.confirm("Are you sure you want to clear all screenshots? This action cannot be undone.")&&(i([]),localStorage.removeItem("merch_screenshots"),d("All screenshots cleared successfully!","success"))},F=async()=>{console.log("🚀 Video.jsx handleGrabScreenshot called - FAST METHOD");const W=v.current;if(console.log("Grab Screenshot clicked"),!W){console.log("❌ Video element not found"),d("Video not loaded yet. Please wait for the video to load.","warning");return}if(n.length>=6){console.log("❌ Maximum screenshots reached"),d("Maximum 6 screenshots allowed. Please delete some screenshots first.","warning");return}console.log("✅ Starting FAST client-side screenshot capture...");try{console.log("🎯 Attempting to capture actual screenshot from video frame...");const R=document.createElement("canvas"),L=R.getContext("2d");R.width=W.videoWidth||640,R.height=W.videoHeight||360,console.log(`📐 Canvas size: ${R.width}x${R.height}`),L.drawImage(W,0,0,R.width,R.height);const J=R.toDataURL("image/jpeg",.85);console.log("✅ FAST METHOD: Actual screenshot captured from video frame"),i(b=>[...b,J]),d("Screenshot captured successfully!","success");return}catch(R){console.error("❌ FAST METHOD failed:",R);const L=(j==null?void 0:j.thumbnail)||(j==null?void 0:j.poster)||W.poster;if(L&&L!=="undefined"&&L!=="null"){console.log("🔄 Fallback: Using video thumbnail as screenshot"),i(J=>[...J,L]),d("Screenshot captured successfully! (using thumbnail)","success");return}}console.log("🔄 No thumbnail available, creating placeholder");const z=`https://via.placeholder.com/300x200/FF5722/FFFFFF?text=Screenshot+${n.length+1}`;i(R=>[...R,z]),d("Screenshot captured successfully! (using placeholder)","success")},h=async()=>{await N()},N=async()=>{try{console.log("Make Merch clicked, sending request to:",he.ENDPOINTS.CREATE_PRODUCT);const W=localStorage.getItem("user_authenticated"),z=localStorage.getItem("user_email"),R=window.location.href,L=(j==null?void 0:j.title)||"Unknown Video",J=(j==null?void 0:j.channelTitle)||"Unknown Creator";console.log("🔍 Video data found:",{videoTitle:L,creatorName:J,videoUrl:R}),console.log("🔍 API URL being called:",he.ENDPOINTS.CREATE_PRODUCT);const b={thumbnail:r,videoUrl:R,videoTitle:L,creatorName:J,screenshots:n.slice(0,6),isAuthenticated:W==="true",userEmail:z||""};console.log("Request data:",b);const P=await fetch(he.ENDPOINTS.CREATE_PRODUCT,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(b)});if(console.log("Response status:",P.status),console.log("Response headers:",Object.fromEntries(P.headers.entries())),!P.ok){const A=await P.text();throw console.error("Server error response:",A),new Error(`Server error: ${P.status} - ${A}`)}const g=await P.json();if(console.log("Response data:",g),g.success&&g.product_url)if(window.innerWidth<=768)try{window.location.href=g.product_url}catch{d(`Your merch page is ready! Please visit: ${g.product_url}`,"success")}else window.open(g.product_url,"_blank");else console.error("Failed to create product:",g),d(`Failed to create merch product page: ${g.error||"Unknown error"}`,"error")}catch(W){console.error("Make Merch error:",W),d(`Error connecting to merch server: ${W.message}. Please check the console for more details.`,"error")}},H=()=>{const W=document.querySelector(".screenshots-header"),z=document.querySelector(".screenshots-section");if(W)window.innerWidth<=768?W.scrollIntoView({behavior:"smooth",block:"center"}):(W.scrollIntoView({behavior:"smooth",block:"start"}),setTimeout(()=>{window.scrollBy(0,-80)},100));else if(z)window.innerWidth<=768?z.scrollIntoView({behavior:"smooth",block:"center"}):(z.scrollIntoView({behavior:"smooth",block:"start"}),setTimeout(()=>{window.scrollBy(0,-120)},100));else{const R=document.querySelector(".main-container");R&&(R.scrollIntoView({behavior:"smooth",block:"start"}),setTimeout(()=>{window.scrollBy(0,-150)},100))}setTimeout(()=>F(),800)},X=()=>{h()};return t.jsxs("div",{className:"video-page-container",children:[t.jsx("div",{className:"user-flow-section",children:t.jsxs("div",{className:"flow-steps",children:[t.jsxs("div",{className:"flow-step",onClick:H,style:{cursor:"pointer",userSelect:"none",WebkitTapHighlightColor:"transparent"},children:[t.jsx("div",{className:"step-number",children:"2"}),t.jsxs("div",{className:"step-content",children:[t.jsx("h3",{children:"Pick Screenshot"}),t.jsx("p",{children:"Select the perfect moment to capture"})]})]}),t.jsx("div",{className:"flow-arrow",children:"→"}),t.jsxs("div",{className:"flow-step",onClick:X,style:{cursor:"pointer",userSelect:"none",WebkitTapHighlightColor:"transparent"},children:[t.jsx("div",{className:"step-number",children:"3"}),t.jsxs("div",{className:"step-content",children:[t.jsx("h3",{children:"Make Merchandise"}),t.jsx("p",{children:"Create custom products with your screenshot"})]})]})]})}),t.jsxs("div",{className:"main-container",children:[t.jsx("div",{className:"video-viewer",children:e?t.jsx(pl,{videoId:e,thumbnail:r,setThumbnail:a,screenshots:n,setScreenshots:i,videoRef:v,onVideoData:M}):t.jsx("div",{style:{padding:24,color:"red"},children:"No video selected."})}),t.jsxs("div",{className:"screenshots-section",id:"screenshotsSection",children:[t.jsxs("div",{className:"screenshots-header",children:[t.jsx("h3",{children:"Screenshot Selection"}),n.length>0&&t.jsx("button",{className:"clear-all-btn",onClick:x,title:"Clear all screenshots",children:"Clear All"})]}),t.jsx(gl,{thumbnail:r,screenshots:n,onDeleteScreenshot:T,onCropScreenshot:w})]})]}),t.jsx(qt,{isOpen:u,onClose:()=>f(!1),onSuccess:N})]})},yl=({sidebar:e})=>{var J,b,P;const[s,r]=l.useState(null),[a,n]=l.useState(null),[i,o]=l.useState(!0),c=ge(),[u,f]=l.useState(""),[j,M]=l.useState(""),[v,d]=l.useState(null),[T,w]=l.useState(null),[x,F]=l.useState(!1),[h,N]=l.useState(""),[H,X]=l.useState(0);l.useEffect(()=>{(async()=>{var A,p,m;try{const{data:{user:E}}=await _.auth.getUser();if(!E){N("❌ Please log in to upload videos"),o(!1);return}r(E);const{data:B,error:ie}=await _.from("users").select("*").eq("id",E.id).single();if(B)n(B);else if(ie&&ie.code==="PGRST116"){const{data:ce,error:Me}=await _.from("users").upsert({id:E.id,email:E.email,username:((A=E.email)==null?void 0:A.split("@")[0])||"user",display_name:((p=E.user_metadata)==null?void 0:p.name)||((m=E.email)==null?void 0:m.split("@")[0])||"User",role:"creator",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{onConflict:"id",ignoreDuplicates:!1}).select().single();if(Me&&Me.message.includes("duplicate key")){console.log("Duplicate key detected, fetching existing user");const{data:Ze,error:Be}=await _.from("users").select("*").eq("id",E.id).single();Ze&&n(Ze)}else ce&&n(ce)}}catch(E){console.error("Error fetching user:",E),N("❌ Authentication error. Please log in again.")}finally{o(!1)}})()},[]);const W=(g,A)=>{if(!g)return"No file selected";if(A==="video"){if(!g.type.startsWith("video/"))return"Please select a valid video file";if(g.size>100*1024*1024)return"Video file size must be less than 100MB"}else if(A==="image"){if(!g.type.startsWith("image/"))return"Please select a valid image file";if(g.size>10*1024*1024)return"Image file size must be less than 10MB"}return null},z=g=>{const A=g.target.files[0],p=W(A,"video");p?(N(`❌ ${p}`),d(null)):(d(A),N(""))},R=g=>{const A=g.target.files[0],p=W(A,"image");p?(N(`❌ ${p}`),w(null)):(w(A),N(""))},L=async g=>{var A,p,m;if(g.preventDefault(),N(""),X(0),!u.trim()){N("❌ Please enter a video title");return}if(!j.trim()){N("❌ Please enter a video description");return}if(!v){N("❌ Please select a video file");return}if(!T){N("❌ Please select a thumbnail image");return}if(!s||!s.id){N("❌ Please log in to upload videos");return}F(!0);try{console.log("Starting upload process..."),console.log("User ID:",s.id);const E=await fetch("https://backend-hidden-firefly-7865.fly.dev/api/users/ensure-exists",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:s.id,email:s.email,display_name:(a==null?void 0:a.display_name)||((A=s.user_metadata)==null?void 0:A.name)})});if(!E.ok)throw new Error("Failed to ensure user exists in database");const B=await E.json();console.log("User ensured:",B),X(10);const ie=v.name.split(".").pop(),ce=`${s.id}/${Date.now()}.${ie}`;console.log("Uploading video to:",ce);const{error:Me,data:Ze}=await _.storage.from("videos2").upload(ce,v,{cacheControl:"3600",upsert:!1});if(Me)throw console.error("Video upload error:",Me),new Error(`Video upload failed: ${Me.message}`);X(50);const{data:Be}=_.storage.from("videos2").getPublicUrl(ce);console.log("Video uploaded successfully:",Be.publicUrl),X(60);const tt=T.name.split(".").pop(),He=`${s.id}/${Date.now()}_thumb.${tt}`;console.log("Uploading thumbnail to:",He);const{error:k,data:V}=await _.storage.from("thumbnails").upload(He,T,{cacheControl:"3600",upsert:!1});if(k)throw console.error("Thumbnail upload error:",k),new Error(`Thumbnail upload failed: ${k.message}`);X(80);const{data:oe}=_.storage.from("thumbnails").getPublicUrl(He);console.log("Thumbnail uploaded successfully:",oe.publicUrl),X(90),console.log("Inserting video metadata into database...");const ae={title:u.trim(),description:j.trim(),video_url:Be.publicUrl,thumbnail:oe.publicUrl,channelTitle:(a==null?void 0:a.display_name)||((p=s.user_metadata)==null?void 0:p.name)||((m=s.email)==null?void 0:m.split("@")[0])||"Unknown Creator",user_id:s.id,verification_status:"verified_via_supabase_auth",created_at:new Date().toISOString()};console.log("Video metadata:",ae);const{error:S,data:O}=await _.from("videos2").insert([ae]).select();if(S)throw console.error("Database insert error:",S),new Error(`Database error: ${S.message}`);X(100),console.log("Video uploaded and saved successfully:",O),N("✅ Video uploaded successfully! Redirecting you to the homepage..."),f(""),M(""),d(null),w(null),setTimeout(()=>{c("/")},2e3)}catch(E){if(console.error("Upload error:",E),N(`❌ Upload failed: ${E.message}`),E.message.includes("Database error")&&v)try{const B=v.name.split(".").pop(),ie=`${s.id}/${Date.now()}.${B}`;await _.storage.from("videos2").remove([ie]),console.log("Cleaned up uploaded video file")}catch(B){console.error("Failed to cleanup video file:",B)}}finally{F(!1),X(0)}};return i?t.jsx("div",{className:`container ${e?"":" large-container"}`,children:t.jsx("h2",{children:"Loading..."})}):s?t.jsx("div",{className:`container ${e?"":" large-container"}`,children:t.jsxs("div",{style:{maxWidth:700,margin:"20px auto",background:"#fff",padding:24,borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[t.jsx("h2",{children:"Upload a New Video"}),t.jsxs("div",{className:"uploader-info",children:[t.jsx("img",{src:(a==null?void 0:a.profile_image_url)||((J=s.user_metadata)==null?void 0:J.picture)||"/default-avatar.jpg",alt:"Your avatar"}),t.jsxs("p",{children:["You are uploading as: ",t.jsx("strong",{children:(a==null?void 0:a.display_name)||((b=s.user_metadata)==null?void 0:b.name)||((P=s.email)==null?void 0:P.split("@")[0])||"Your Channel"})]})]}),t.jsxs("form",{onSubmit:L,children:[t.jsxs("div",{style:{marginBottom:16},children:[t.jsx("label",{children:"Title *"}),t.jsx("input",{type:"text",value:u,onChange:g=>f(g.target.value),required:!0,style:{width:"100%",padding:8,marginTop:4},placeholder:"Enter video title"})]}),t.jsxs("div",{style:{marginBottom:16},children:[t.jsx("label",{children:"Description *"}),t.jsx("textarea",{value:j,onChange:g=>M(g.target.value),required:!0,style:{width:"100%",padding:8,marginTop:4},rows:4,placeholder:"Enter video description"})]}),t.jsxs("div",{style:{marginBottom:16},children:[t.jsx("label",{children:"Video File * (Max 100MB)"}),t.jsx("input",{type:"file",accept:"video/*",onChange:z,required:!0,style:{display:"block",marginTop:4}}),v&&t.jsxs("small",{style:{color:"#666",marginTop:4,display:"block"},children:["Selected: ",v.name," (",(v.size/1024/1024).toFixed(2)," MB)"]})]}),t.jsxs("div",{style:{marginBottom:16},children:[t.jsx("label",{children:"Thumbnail Image * (Max 10MB)"}),t.jsx("input",{type:"file",accept:"image/*",onChange:R,required:!0,style:{display:"block",marginTop:4}}),T&&t.jsxs("small",{style:{color:"#666",marginTop:4,display:"block"},children:["Selected: ",T.name," (",(T.size/1024/1024).toFixed(2)," MB)"]})]}),H>0&&t.jsxs("div",{style:{marginBottom:16},children:[t.jsx("div",{style:{width:"100%",backgroundColor:"#f0f0f0",borderRadius:4,overflow:"hidden",marginTop:8},children:t.jsx("div",{style:{width:`${H}%`,height:20,backgroundColor:"#4CAF50",transition:"width 0.3s ease"}})}),t.jsxs("small",{style:{color:"#666"},children:["Upload Progress: ",H,"%"]})]}),h&&t.jsx("div",{className:`upload-message ${h.includes("✅")?"success":"error"}`,children:h}),t.jsx("button",{type:"submit",className:"upload-btn",disabled:x,children:x?"Uploading...":"Upload Video"})]})]})}):t.jsxs("div",{className:`container ${e?"":" large-container"}`,style:{textAlign:"center",paddingTop:"5rem"},children:[t.jsx("h2",{children:"Please Log In to Upload"}),t.jsx("p",{children:"You must sign in with Google to upload videos."}),t.jsx("button",{className:"sign-in-btn",onClick:async()=>{const{error:g}=await _.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/upload`,queryParams:{prompt:"select_account"}}});g&&alert("Login failed: "+g.message)},children:"Sign In with Google"})]})},vl=()=>{const{username:e}=hs(),s=ge(),[r,a]=l.useState(null),[n,i]=l.useState([]),[o,c]=l.useState(!0),[u,f]=l.useState(null),[j,M]=l.useState(null);return l.useEffect(()=>{e&&(async()=>{c(!0),f(null);const{data:d,error:T}=await _.from("users").select("*").eq("username",e).single();if(T||!d){f("User not found"),c(!1);return}a(d);const{data:w}=await _.from("videos2").select("*").eq("channelTitle",d.display_name||d.username).order("created_at",{ascending:!1});i(w||[]),c(!1)})()},[e]),l.useEffect(()=>{(async()=>{const{data:{user:d}}=await _.auth.getUser();if(d){const{data:T}=await _.from("users").select("role").eq("id",d.id).single();M({...d,...T})}else M(null)})()},[]),j&&j.role!=="creator"?t.jsx(Wr,{to:"/",replace:!0}):o?t.jsx("div",{className:"profile-page",children:t.jsx("div",{children:"Loading profile..."})}):u?t.jsx("div",{className:"profile-page",children:t.jsx("div",{children:u})}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"channel-header",children:t.jsxs("div",{className:"channel-cover-container",children:[t.jsx("div",{className:"cover-image-container",children:t.jsx("img",{className:"channel-cover-photo",src:r.cover_image_url||"https://images.unsplash.com/photo-1557683316-973673baf926?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80",alt:"Channel Cover"})}),t.jsxs("div",{className:"channel-info-overlay",children:[t.jsx("div",{className:"channel-avatar-container",children:t.jsx("img",{className:"channel-avatar",src:r.profile_image_url||"/default-avatar.jpg",alt:"Channel Avatar"})}),t.jsxs("div",{className:"channel-details",children:[t.jsx("h1",{className:"channel-name",children:r.display_name||r.username}),t.jsxs("p",{className:"channel-username",children:["@",r.username]}),r.bio&&t.jsx("p",{className:"channel-bio",children:r.bio})]})]})]})}),t.jsxs("div",{className:"profile-page",children:[t.jsx("div",{className:"profile-tabs",children:t.jsx("span",{className:"active",children:"Videos"})}),t.jsx("div",{className:"profile-videos",children:n.length===0?t.jsx("div",{children:"No videos yet."}):t.jsx("div",{className:"profile-video-grid",children:n.map(v=>t.jsxs("div",{className:"profile-video-card",style:{cursor:"pointer"},onClick:()=>{console.log("Clicked video:",v),s(`/video/${v.categoryId||0}/${v.id}`)},children:[t.jsx("img",{src:v.thumbnail||"https://via.placeholder.com/320x180?text=No+Thumbnail",alt:v.title}),t.jsx("h3",{children:v.title}),t.jsx("p",{children:v.description})]},v.id))})})]})]})},jl=()=>{const[e]=us(),[s,r]=l.useState("verifying"),[a,n]=l.useState("");l.useEffect(()=>{const o=e.get("email"),c=e.get("token");if(!o||!c){r("error");return}n(o),setTimeout(()=>{r("success")},2e3)},[e]);const i=()=>{switch(s){case"verifying":return t.jsxs("div",{className:"approval-content",children:[t.jsx("div",{className:"loading-spinner"}),t.jsx("h2",{children:"Verifying your subscription..."}),t.jsx("p",{children:"Please wait while we process your request."})]});case"success":return t.jsxs("div",{className:"approval-content success",children:[t.jsx("div",{className:"success-icon",children:"✓"}),t.jsx("h2",{children:"Subscription Approved!"}),t.jsxs("p",{children:["Welcome to ScreenMerch, ",t.jsx("strong",{children:a}),"!"]}),t.jsx("p",{children:"Your subscription has been successfully activated. You can now enjoy all our premium features."}),t.jsx(pe,{to:"/",className:"home-btn",children:"Go to Home"})]});case"error":return t.jsxs("div",{className:"approval-content error",children:[t.jsx("div",{className:"error-icon",children:"✗"}),t.jsx("h2",{children:"Invalid Link"}),t.jsx("p",{children:"This approval link is invalid or has expired."}),t.jsx("p",{children:"Please try subscribing again or contact support if you continue to have issues."}),t.jsx(pe,{to:"/",className:"home-btn",children:"Go to Home"})]});default:return null}};return t.jsx("div",{className:"approval-page",children:t.jsxs("div",{className:"approval-container",children:[t.jsx("div",{className:"logo-section",children:t.jsx("h1",{children:"ScreenMerch"})}),i()]})})};class ft{static async getCurrentUserSubscription(){try{const{data:{user:s}}=await _.auth.getUser();if(!s)return null;const{data:r,error:a}=await _.from("user_subscriptions").select("*").eq("user_id",s.id).single();if(a&&a.code!=="PGRST116")throw a;return r||{tier:"free",status:"active"}}catch(s){return console.error("Error fetching subscription:",s),{tier:"free",status:"active"}}}static async subscribeToFreeTier(){try{const{data:{user:s}}=await _.auth.getUser();if(!s)throw new Error("User not authenticated");const{data:r,error:a}=await _.from("user_subscriptions").upsert({user_id:s.id,tier:"free",status:"active",updated_at:new Date().toISOString()},{onConflict:"user_id"}).select().single();if(a)throw a;return{success:!0,subscription:r}}catch(s){return console.error("Error subscribing to free tier:",s),{success:!1,error:s.message}}}static async subscribeToProTier(){try{const{data:{user:s}}=await _.auth.getUser(),a=await(await fetch("https://backend-hidden-firefly-7865.fly.dev/api/create-pro-checkout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:(s==null?void 0:s.id)||null,tier:"pro",email:(s==null?void 0:s.email)||null})})).json();if(a.url)return window.location.href=a.url,{success:!0,redirecting:!0};throw new Error(a.error||"Failed to create checkout session")}catch(s){return console.error("Error subscribing to pro tier:",s),{success:!1,error:s.message}}}static async hasMinimumTier(s){try{const r=await this.getCurrentUserSubscription(),a={free:0,pro:1},n=a[(r==null?void 0:r.tier)||"free"],i=a[s];return n>=i}catch(r){return console.error("Error checking tier requirement:",r),!1}}static getTierConfig(s){const r={free:{name:"Free for Fans",price:"Free",features:["Upload videos (up to 100MB, 10 minutes)","Basic analytics","Standard features","Community access","Grab screenshots","Preview merch","Buy merchandise"],maxUploadSize:"100MB",maxVideoLength:"10 minutes"},pro:{name:"Pro Plan for Creators",price:"$9.99/month",trialDays:7,features:["Everything in Free","Priority support","Custom branding","Enhanced upload limits (2GB, 60 minutes)","Ad-free experience","Early access to new features","Monetization tools","Revenue tracking","Custom channel colors","Branded merchandise"],maxUploadSize:"2GB",maxVideoLength:"60 minutes"}};return r[s]||r.free}static async isInTrialPeriod(){try{const s=await this.getCurrentUserSubscription();if(!s||s.tier!=="pro"||!s.trial_end)return!1;const r=new Date(s.trial_end);return new Date<r}catch(s){return console.error("Error checking trial period:",s),!1}}static async getTrialDaysRemaining(){try{const s=await this.getCurrentUserSubscription();if(!s||s.tier!=="pro"||!s.trial_end)return 0;const n=new Date(s.trial_end)-new Date,i=Math.ceil(n/(1e3*60*60*24));return Math.max(0,i)}catch(s){return console.error("Error getting trial days remaining:",s),0}}}class je{static async isAdmin(){try{const{data:{user:s}}=await _.auth.getUser();if(!s)return!1;const{data:r,error:a}=await _.from("users").select("is_admin").eq("id",s.id).single();return a?(console.error("Error checking admin status:",a),!1):(r==null?void 0:r.is_admin)||!1}catch(s){return console.error("Error in isAdmin:",s),!1}}static async getDashboardStats(){try{const{data:s,error:r}=await _.from("admin_dashboard_stats").select("*").single();if(r)throw r;return s}catch(s){return console.error("Error fetching dashboard stats:",s),{total_users:0,active_users:0,suspended_users:0,total_videos:0,pending_videos:0,approved_videos:0,total_subscriptions:0,active_subscriptions:0,premium_subscriptions:0,creator_network_subscriptions:0}}}static async getUsers(s=0,r=20,a="",n="all"){try{let i=_.from("users").select("*",{count:"exact"});a&&(i=i.or(`display_name.ilike.%${a}%,email.ilike.%${a}%`)),n!=="all"&&(i=i.eq("status",n));const{data:o,error:c,count:u}=await i.order("created_at",{ascending:!1}).range(s*r,(s+1)*r-1);if(c)throw c;return{users:o||[],total:u||0,page:s,limit:r,totalPages:Math.ceil((u||0)/r)}}catch(i){return console.error("Error fetching users:",i),{users:[],total:0,page:s,limit:r,totalPages:0}}}static async getVideos(s=0,r=20,a="",n="all"){try{let i=_.from("videos2").select("*, users(display_name, email)",{count:"exact"});a&&(i=i.or(`title.ilike.%${a}%,description.ilike.%${a}%`)),n!=="all"&&(i=i.eq("verification_status",n));const{data:o,error:c,count:u}=await i.order("created_at",{ascending:!1}).range(s*r,(s+1)*r-1);if(c)throw c;return{videos:o||[],total:u||0,page:s,limit:r,totalPages:Math.ceil((u||0)/r)}}catch(i){return console.error("Error fetching videos:",i),{videos:[],total:0,page:s,limit:r,totalPages:0}}}static async getSubscriptions(){try{const{data:s,error:r}=await _.from("user_subscriptions").select("*, users(display_name, email)").order("created_at",{ascending:!1});if(r)throw r;return s||[]}catch(s){return console.error("Error fetching subscriptions:",s),[]}}static async updateUserStatus(s,r){try{const{data:{user:a}}=await _.auth.getUser();if(!a)return{success:!1,error:"Not authenticated"};const{data:n,error:i}=await _.from("users").update({status:r}).eq("id",s).select().single();if(i)throw i;return await this.logAdminAction("update_user_status","user",s,{new_status:r,target_user_id:s}),{success:!0,data:n}}catch(a){return console.error("Error updating user status:",a),{success:!1,error:a.message}}}static async deleteUser(s){try{const r=await fetch(`http://localhost:3002/api/users/${s}/delete-account`,{method:"DELETE",headers:{"Content-Type":"application/json"}});return r.ok?(await this.logAdminAction("delete_user","user",s,{target_user_id:s}),{success:!0}):{success:!1,error:(await r.json()).error||"Failed to delete user"}}catch(r){return console.error("Error deleting user:",r),{success:!1,error:r.message}}}static async updateVideoStatus(s,r){try{const{data:a,error:n}=await _.from("videos2").update({verification_status:r}).eq("id",s).select().single();if(n)throw n;return await this.logAdminAction("update_video_status","video",s,{new_status:r,target_video_id:s}),{success:!0,data:a}}catch(a){return console.error("Error updating video status:",a),{success:!1,error:a.message}}}static async deleteVideo(s){try{const{data:r,error:a}=await _.from("videos2").select("*").eq("id",s).single();if(a)throw a;const{error:n}=await _.from("videos2").delete().eq("id",s);if(n)throw n;if(r&&r.video_url&&!r.video_url.includes("youtube.com"))try{const i=r.video_url.split("/storage/v1/object/public/")[1];i&&await _.storage.from("videos2").remove([i])}catch(i){console.warn("Could not delete video file from storage:",i)}if(r&&r.thumbnail&&!r.thumbnail.includes("ytimg.com"))try{const i=r.thumbnail.split("/storage/v1/object/public/")[1];i&&await _.storage.from("thumbnails").remove([i])}catch(i){console.warn("Could not delete thumbnail from storage:",i)}return await this.logAdminAction("delete_video","video",s,{target_video_id:s}),{success:!0}}catch(r){return console.error("Error deleting video:",r),{success:!1,error:r.message}}}static async getAdminSettings(){try{const{data:s,error:r}=await _.from("admin_settings").select("*").order("setting_key");if(r)throw r;const a={};return s.forEach(n=>{a[n.setting_key]=n.setting_value}),a}catch(s){return console.error("Error fetching admin settings:",s),{}}}static async updateAdminSetting(s,r){try{const{data:{user:a}}=await _.auth.getUser();if(!a)return{success:!1,error:"Not authenticated"};const{data:n,error:i}=await _.rpc("update_admin_setting",{p_setting_key:s,p_setting_value:r,p_admin_user_id:a.id});if(i)throw i;return{success:!0,data:n}}catch(a){return console.error("Error updating admin setting:",a),{success:!1,error:a.message}}}static async getAdminLogs(s=0,r=50){try{const{data:a,error:n,count:i}=await _.from("admin_logs").select("*, admin_user:users(display_name, email)",{count:"exact"}).order("created_at",{ascending:!1}).range(s*r,(s+1)*r-1);if(n)throw n;return{logs:a||[],total:i||0,page:s,limit:r,totalPages:Math.ceil((i||0)/r)}}catch(a){return console.error("Error fetching admin logs:",a),{logs:[],total:0,page:s,limit:r,totalPages:0}}}static async logAdminAction(s,r,a=null,n=null){try{const{data:{user:i}}=await _.auth.getUser();if(!i)return;await _.rpc("log_admin_action",{p_admin_user_id:i.id,p_action_type:s,p_target_type:r,p_target_id:a,p_details:n})}catch(i){console.error("Error logging admin action:",i)}}static async getRecentActivity(s=10){try{const{data:r,error:a}=await _.from("admin_logs").select("*, admin_user:users(display_name, email)").order("created_at",{ascending:!1}).limit(s);if(a)throw a;return r||[]}catch(r){return console.error("Error fetching recent activity:",r),[]}}}const wl=({sidebar:e})=>{var Be,tt,He;const[s,r]=l.useState(null),[a,n]=l.useState(null),[i,o]=l.useState(null),[c,u]=l.useState([]),[f,j]=l.useState(!0),[M,v]=l.useState(!1),[d,T]=l.useState({display_name:"",bio:"",cover_image_url:"",profile_image_url:""}),[w,x]=l.useState(!1),[F,h]=l.useState({cover:null,profile:null}),[N,H]=l.useState(!1),[X,W]=l.useState(!1),[z,R]=l.useState("videos"),[L,J]=l.useState(null),[b,P]=l.useState({total_sales:0,total_revenue:0,avg_order_value:0,products_sold_count:0,videos_with_sales_count:0,sales_data:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],products_sold:[],videos_with_sales:[]}),[g,A]=l.useState(!1),p=ge(),m=b.sales_data,E=Math.max(...m)||1;l.useEffect(()=>{(async()=>{try{const{data:{user:V},error:oe}=await _.auth.getUser();if(!V){p("/");return}r(V);const{data:ae,error:S}=await _.from("users").select("*").eq("id",V.id).single();ae&&(n(ae),T({display_name:ae.display_name||"",bio:ae.bio||"",cover_image_url:ae.cover_image_url||"",profile_image_url:ae.profile_image_url||""}));const O=await ft.getCurrentUserSubscription();o(O);const{data:Y,error:U}=await _.from("videos2").select("*").eq("user_id",V.id).order("created_at",{ascending:!1});Y&&u(Y)}catch(V){console.error("Error fetching data:",V),p("/")}finally{j(!1)}})()},[p]),l.useEffect(()=>{(async()=>{const{data:{user:V}}=await _.auth.getUser();if(V){const{data:oe}=await _.from("users").select("role").eq("id",V.id).single();J({...V,...oe})}else J(null)})()},[]);const B=async()=>{try{console.log("🔍 Starting analytics fetch..."),A(!0);const k=await fetch("https://backend-hidden-firefly-7865.fly.dev/api/analytics?t="+Date.now());if(console.log("📡 Response status:",k.status),k.ok){const V=await k.json();console.log("📊 Analytics data received:",V),P(V)}else{console.error("❌ Failed to fetch analytics data, status:",k.status);const V=await k.text();console.error("❌ Error response:",V)}}catch(k){console.error("❌ Error fetching analytics:",k)}finally{A(!1)}};l.useEffect(()=>{console.log("🔄 Tab changed to:",z),z==="analytics"&&(console.log("📊 Analytics tab activated, fetching data..."),B())},[z]);const ie=async(k,V)=>{try{x(!0);const oe=k.name.split(".").pop(),ae=`${s.id}/${V}-${Date.now()}.${oe}`,{data:S,error:O}=await _.storage.from("profile-images").upload(ae,k,{cacheControl:"3600",upsert:!0});if(O)return console.error("Error uploading image:",O),alert("Failed to upload image. Please try again."),null;const{data:{publicUrl:Y}}=_.storage.from("profile-images").getPublicUrl(ae);return Y}catch(oe){return console.error("Error in uploadImageToSupabase:",oe),alert("Failed to upload image. Please try again."),null}finally{x(!1)}},ce=async(k,V)=>{if(!k.type.startsWith("image/")){alert("Please select a valid image file.");return}if(k.size>5*1024*1024){alert("File size must be less than 5MB.");return}const oe=new FileReader;oe.onload=S=>{h(O=>({...O,[V]:S.target.result}))},oe.readAsDataURL(k);const ae=await ie(k,V);ae&&T(S=>({...S,[`${V}_image_url`]:ae}))},Me=async()=>{try{const{data:k,error:V}=await _.from("users").update({display_name:d.display_name,bio:d.bio,cover_image_url:d.cover_image_url,profile_image_url:d.profile_image_url,updated_at:new Date().toISOString()}).eq("id",s.id);V?console.error("Error updating profile:",V):(n({...a,...d}),v(!1),h({cover:null,profile:null}))}catch(k){console.error("Error saving profile:",k)}},Ze=async(k,V,oe)=>{if(oe.stopPropagation(),!!window.confirm(`Are you sure you want to delete "${V}"? This action cannot be undone.`))try{const S=await je.deleteVideo(k);S.success?(u(O=>O.filter(Y=>Y.id!==k)),alert("Video deleted successfully!")):alert(`Failed to delete video: ${S.error}`)}catch(S){console.error("Error deleting video:",S),alert("Failed to delete video. Please try again.")}};return L&&(!L.role||L.role!=="creator")?(console.log("User role issue:",L.role,"User:",L),t.jsxs("div",{className:"dashboard-error",children:["Access denied. Only creators can view this page.",t.jsx("br",{}),t.jsx("button",{onClick:async()=>{var k,V,oe;try{console.log("Fixing role for user:",L.id);const{data:ae,error:S}=await _.from("users").select("*").eq("id",L.id).single();if(S&&S.code==="PGRST116"){console.log("User not found, creating new user record");const{data:O,error:Y}=await _.from("users").upsert({id:L.id,email:L.email,username:((k=L.email)==null?void 0:k.split("@")[0])||"user",display_name:((V=L.user_metadata)==null?void 0:V.name)||((oe=L.email)==null?void 0:oe.split("@")[0])||"User",role:"creator",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{onConflict:"id",ignoreDuplicates:!1}).select();if(Y)if(console.error("Error creating user:",Y),Y.message.includes("duplicate key")){console.log("Duplicate key detected, updating existing user");const{data:U,error:G}=await _.from("users").update({role:"creator",updated_at:new Date().toISOString()}).eq("id",L.id).select();G?(console.error("Error updating user:",G),alert("Failed to update user: "+G.message)):(console.log("User updated successfully:",U),alert("User updated! Reloading page..."),window.location.reload())}else alert("Failed to create user: "+Y.message);else console.log("User created successfully:",O),alert("User created! Reloading page..."),window.location.reload()}else if(ae){const{data:O,error:Y}=await _.from("users").update({role:"creator"}).eq("id",L.id).select();Y?(console.error("Error updating role:",Y),alert("Failed to update role: "+Y.message)):(console.log("Role updated successfully:",O),alert("Role updated! Reloading page..."),window.location.reload())}else console.error("Unexpected error checking user:",S),alert("Error checking user: "+S.message)}catch(ae){console.error("Error in role fix:",ae),alert("Error fixing role: "+ae.message)}},style:{marginTop:"10px",padding:"8px 16px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Fix Role & Reload"})]})):f?t.jsx("div",{className:"dashboard-loading",children:"Loading your dashboard..."}):s?t.jsxs("div",{className:`dashboard-container ${e?"":" large-container"}`,children:[t.jsx("div",{className:"channel-header",children:t.jsxs("div",{className:"channel-cover-container",children:[N?t.jsxs("div",{className:"edit-cover-section",children:[t.jsx("div",{className:"cover-edit-backdrop",onClick:()=>{H(!1),h(k=>({...k,cover:null}))}}),t.jsx("div",{className:"cover-edit-overlay",onClick:k=>k.stopPropagation(),children:t.jsxs("div",{className:"cover-edit-controls",children:[t.jsx("button",{className:"cover-edit-close-btn",onClick:()=>{H(!1),h(k=>({...k,cover:null}))},title:"Close",children:"×"}),t.jsx("h3",{children:"📸 Update Cover Image"}),t.jsxs("div",{className:"file-upload-section",children:[t.jsx("input",{type:"file",accept:"image/*",onChange:k=>k.target.files[0]&&ce(k.target.files[0],"cover"),id:"cover-upload",className:"file-input",disabled:w}),t.jsx("label",{htmlFor:"cover-upload",className:"file-upload-btn",children:w?"⏳ Uploading...":"📁 Choose Cover Image"})]}),t.jsx("p",{className:"edit-tip",children:"💡 Tip: Max 5MB, high-quality image (1920x1080 recommended)"})]})}),(F.cover||d.cover_image_url)&&t.jsx("img",{src:F.cover||d.cover_image_url||(a==null?void 0:a.cover_image_url)||"https://images.unsplash.com/photo-1557683316-973673baf926?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80",alt:"Cover preview",className:"channel-cover-photo"})]}):t.jsxs("div",{className:"cover-image-container",children:[t.jsx("img",{className:"channel-cover-photo",src:d.cover_image_url||(a==null?void 0:a.cover_image_url)||"https://images.unsplash.com/photo-1557683316-973673baf926?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80",alt:"Channel Cover"}),t.jsx("button",{className:"corner-edit-icon cover-edit",onClick:()=>H(!0),title:"Edit cover image",children:"✏️"})]}),t.jsxs("div",{className:"channel-info-overlay",children:[t.jsx("div",{className:"channel-avatar-container",children:X?t.jsxs("div",{className:"edit-avatar-section",children:[t.jsx("img",{className:"channel-avatar editing",src:F.profile||d.profile_image_url||(a==null?void 0:a.profile_image_url)||((Be=s.user_metadata)==null?void 0:Be.picture)||"/default-avatar.jpg",alt:"Channel Avatar"}),t.jsxs("div",{className:"avatar-upload-section",children:[t.jsx("input",{type:"file",accept:"image/*",onChange:k=>k.target.files[0]&&ce(k.target.files[0],"profile"),id:"avatar-upload",className:"file-input",disabled:w}),t.jsx("label",{htmlFor:"avatar-upload",className:"avatar-upload-btn",children:w?"⏳ Uploading...":"📷 Change Avatar"})]})]}):t.jsxs("div",{className:"avatar-with-edit",children:[t.jsx("img",{className:"channel-avatar",src:(a==null?void 0:a.profile_image_url)||((tt=s.user_metadata)==null?void 0:tt.picture)||"/default-avatar.jpg",alt:"Channel Avatar"}),t.jsx("button",{className:"corner-edit-icon avatar-edit",onClick:()=>W(!0),title:"Edit avatar",children:"✏️"})]})}),t.jsx("div",{className:"channel-details",children:M?t.jsxs("div",{className:"edit-details-section",children:[t.jsx("input",{type:"text",placeholder:"Display name",value:d.display_name,onChange:k=>T({...d,display_name:k.target.value}),className:"edit-input edit-title"}),t.jsx("textarea",{placeholder:"Bio/Description",value:d.bio,onChange:k=>T({...d,bio:k.target.value}),className:"edit-textarea",rows:"2"})]}):t.jsxs(t.Fragment,{children:[t.jsx("h1",{className:"channel-name",children:(a==null?void 0:a.display_name)||((He=s.user_metadata)==null?void 0:He.name)||"Your Channel"}),t.jsxs("p",{className:"channel-username",children:["@",(a==null?void 0:a.username)||"username"]}),(a==null?void 0:a.bio)&&t.jsx("p",{className:"channel-bio",children:a.bio})]})}),t.jsx("div",{className:"edit-controls",children:M?t.jsxs("div",{className:"edit-buttons",children:[t.jsx("button",{onClick:Me,className:"save-btn",children:"Save Changes"}),t.jsx("button",{onClick:()=>v(!1),className:"cancel-btn",children:"Cancel"})]}):null})]})]})}),t.jsxs("div",{className:"dashboard-tabs",children:[t.jsxs("button",{className:`tab-button ${z==="videos"?"active":""}`,onClick:()=>R("videos"),children:["📹 Videos (",c.length,")"]}),t.jsx("button",{className:`tab-button ${z==="analytics"?"active":""}`,onClick:()=>R("analytics"),children:"📊 Analytics"})]}),t.jsxs("div",{className:"tab-content",children:[z==="videos"&&t.jsxs("div",{className:"videos-tab",children:[t.jsx("div",{className:"quick-upload-section",children:t.jsxs("div",{className:"upload-card",children:[t.jsx("div",{className:"upload-icon",children:"📹"}),t.jsx("h3",{children:"Upload New Video"}),t.jsx("p",{children:"Share your content with the ScreenMerch community"}),t.jsx("button",{onClick:()=>p("/upload"),className:"primary-upload-btn",children:"Start Upload"})]})}),t.jsxs("div",{className:"user-videos-section",children:[t.jsx("div",{className:"section-header",children:t.jsxs("h2",{children:["Your Videos (",c.length,")"]})}),c.length>0?t.jsx("div",{className:"dashboard-video-grid",children:c.map(k=>t.jsxs("div",{className:"dashboard-video-card",onClick:()=>p(`/video/${k.categoryId||0}/${k.id}`),children:[t.jsx("img",{src:k.thumbnail,alt:k.title,className:"dashboard-video-thumbnail"}),t.jsxs("div",{className:"dashboard-video-info",children:[t.jsx("h4",{children:k.title}),t.jsx("p",{children:new Date(k.created_at).toLocaleDateString()}),t.jsx("span",{className:"video-views",children:"0 views"})]}),t.jsx("button",{className:"delete-video-btn",onClick:V=>Ze(k.id,k.title,V),title:"Delete Video",children:"🗑️"})]},k.id))}):t.jsx("div",{className:"no-videos-placeholder",children:t.jsxs("div",{className:"placeholder-content",children:[t.jsx("h3",{children:"No videos yet"}),t.jsx("p",{children:"Start building your content library by uploading your first video!"})]})})]}),t.jsxs("div",{className:"getting-started-section",children:[t.jsx("h2",{children:"Getting Started"}),t.jsxs("div",{className:"tips-grid",children:[t.jsxs("div",{className:"tip-card",children:[t.jsx("h4",{children:"🎨 Customize Your Channel"}),t.jsx("p",{children:"Add a cover image, profile picture, and bio to make your channel unique."})]}),t.jsxs("div",{className:"tip-card",children:[t.jsx("h4",{children:"📹 Upload Content"}),t.jsx("p",{children:"Start sharing your videos and build your audience."})]}),t.jsxs("div",{className:"tip-card",children:[t.jsx("h4",{children:"⬆️ Upgrade Your Plan"}),t.jsxs("p",{children:[t.jsx("button",{onClick:()=>p("/subscription"),className:"upgrade-link",children:"Explore subscription tiers"})," for more features."]})]})]})]})]}),z==="analytics"&&t.jsx("div",{className:"analytics-tab",children:t.jsxs("div",{className:"sales-analytics-section",children:[t.jsxs("div",{className:"section-header",children:[t.jsx("h2",{children:"📊 Sales Analytics"}),t.jsxs("div",{className:"analytics-summary",children:[t.jsxs("span",{className:"total-sales",children:["Total Sales: ",g?"Loading...":b.total_sales]}),t.jsxs("span",{className:"total-revenue",children:["Total Revenue: $",g?"0.00":b.total_revenue.toFixed(2)]})]})]}),t.jsxs("div",{className:"analytics-dashboard",children:[t.jsxs("div",{className:"analytics-overview-cards",children:[t.jsxs("div",{className:"analytics-card",children:[t.jsx("h4",{children:"📈 Sales Per Day"}),t.jsx("div",{className:"analytics-amount",children:g?"...":b.total_sales}),t.jsx("div",{className:"analytics-change",children:g?"Loading...":b.total_sales>0?"Active sales":"No data yet"})]}),t.jsxs("div",{className:"analytics-card",children:[t.jsx("h4",{children:"🛍️ Products Sold"}),t.jsx("div",{className:"analytics-amount",children:g?"...":b.products_sold_count}),t.jsx("div",{className:"analytics-change",children:g?"Loading...":b.products_sold_count>0?"Products selling":"No data yet"})]}),t.jsxs("div",{className:"analytics-card",children:[t.jsx("h4",{children:"🎬 Videos with Sales"}),t.jsx("div",{className:"analytics-amount",children:g?"...":b.videos_with_sales_count}),t.jsx("div",{className:"analytics-change",children:g?"Loading...":b.videos_with_sales_count>0?"Videos performing":"No data yet"})]}),t.jsxs("div",{className:"analytics-card",children:[t.jsx("h4",{children:"💰 Avg Order Value"}),t.jsxs("div",{className:"analytics-amount",children:["$",g?"0.00":b.avg_order_value.toFixed(2)]}),t.jsx("div",{className:"analytics-change",children:g?"Loading...":b.avg_order_value>0?"Good average":"No data yet"})]})]}),t.jsxs("div",{className:"sales-chart-section",children:[t.jsx("h3",{children:"📊 Sales Per Day (Last 30 Days)"}),t.jsxs("div",{className:"chart-container",children:[t.jsx("div",{className:"chart-bars",children:m.map((k,V)=>t.jsx("div",{className:"chart-bar",style:{height:`${k/E*200}px`},title:`Day ${V+1}: ${k} sales`,children:t.jsx("span",{className:"bar-value",children:k})},V))}),t.jsxs("div",{className:"chart-labels",children:[t.jsx("span",{children:"1"}),t.jsx("span",{children:"7"}),t.jsx("span",{children:"14"}),t.jsx("span",{children:"21"}),t.jsx("span",{children:"30"})]})]})]}),t.jsxs("div",{className:"products-sold-table",children:[t.jsx("h3",{children:"🛍️ Products Sold"}),t.jsxs("div",{className:"table-header",children:[t.jsx("div",{children:"Product"}),t.jsx("div",{children:"Quantity Sold"}),t.jsx("div",{children:"Revenue"}),t.jsx("div",{children:"Video Source"}),t.jsx("div",{children:"Image"})]}),b.products_sold&&b.products_sold.length>0?b.products_sold.map((k,V)=>t.jsxs("div",{className:"table-row",children:[t.jsx("div",{className:"product-info",children:t.jsx("span",{children:k.product})}),t.jsx("div",{children:k.quantity}),t.jsxs("div",{children:["$",k.revenue.toFixed(2)]}),t.jsx("div",{children:k.video_source}),t.jsx("div",{className:"product-image",children:k.image?t.jsx("img",{src:k.image,alt:k.product,style:{width:"50px",height:"50px",objectFit:"cover"}}):t.jsx("span",{children:"No image"})})]},V)):t.jsxs("div",{className:"table-row empty-state",children:[t.jsx("div",{className:"product-info",children:t.jsx("span",{children:"No products sold yet"})}),t.jsx("div",{children:"0"}),t.jsx("div",{children:"$0.00"}),t.jsx("div",{children:"No videos yet"}),t.jsx("div",{className:"product-image",children:t.jsx("span",{children:"No image"})})]})]}),t.jsxs("div",{className:"video-sources-section",children:[t.jsx("h3",{children:"🎬 Video Sources"}),t.jsx("div",{className:"video-sources-grid",children:b.videos_with_sales&&b.videos_with_sales.length>0?b.videos_with_sales.map((k,V)=>t.jsx("div",{className:"video-source-card",children:t.jsxs("div",{className:"video-source-info",children:[t.jsx("h4",{children:k.video_name}),t.jsxs("p",{children:[k.sales_count," sales • $",k.revenue.toFixed(2)," revenue"]}),t.jsx("span",{className:"video-date",children:"Active video"})]})},V)):t.jsx("div",{className:"video-source-card empty-state",children:t.jsxs("div",{className:"video-source-info",children:[t.jsx("h4",{children:"No videos with sales yet"}),t.jsx("p",{children:"0 sales • $0.00 revenue"}),t.jsx("span",{className:"video-date",children:"Upload your first video to start earning!"})]})})})]}),t.jsxs("div",{className:"analytics-actions",children:[t.jsx("button",{className:"action-btn primary",onClick:()=>{alert("Export functionality coming soon!")},children:"Export Sales Report"}),t.jsx("button",{className:"action-btn secondary",onClick:()=>{alert("Detailed analytics coming soon!")},children:"View Detailed Analytics"}),t.jsx("button",{className:"action-btn secondary",onClick:()=>{alert("Period comparison coming soon!")},children:"Compare Periods"})]})]})]})})]})]}):t.jsx("div",{className:"dashboard-error",children:"Please log in to see your dashboard."})},Sl=()=>{const e=ge(),s=ms(),r=[{id:"pro",name:"Pro Plan for Creators",price:"$9.99/month",trialText:"7-day free trial",features:["Upload and share your videos","Create custom product pages","Sell merchandise with revenue sharing","Priority customer support","Custom branding and channel colors","Enhanced upload limits (2GB, 60 minutes)","Analytics and sales tracking","Creator dashboard and tools","Ad-free viewing experience","Early access to new features"],color:"#007bff",popular:!0}],[a,n]=l.useState(null),[i,o]=l.useState(null),[c,u]=l.useState(!0),[f,j]=l.useState(!1),[M,v]=l.useState("");l.useEffect(()=>{(async()=>{try{const{data:{user:N}}=await _.auth.getUser();if(n(N),N){const H=await ft.getCurrentUserSubscription();o(H)}}catch(N){console.error("Error fetching user data:",N)}finally{u(!1)}})()},[]);const d=async()=>{j(!0),v("");try{if(!a){e("/signup",{state:{from:s.pathname,message:"Sign up to get started with ScreenMerch!"}});return}const h=await ft.subscribeToFreeTier();h.success?(o(h.subscription),v("Welcome to ScreenMerch! You now have access to all free features."),setTimeout(()=>{e("/dashboard")},2e3)):v(h.error||"Failed to activate free tier. Please try again.")}catch(h){console.error("Error subscribing to free tier:",h),v("An error occurred. Please try again.")}finally{j(!1)}},T=async()=>{j(!0),v("");try{const h=await ft.subscribeToProTier();h.success?h.redirecting?v("Redirecting to Stripe checkout... You will be charged $9.99/month after your 7-day free trial ends."):(o(h.subscription),v("Welcome to Pro! Your 7-day free trial is now active."),setTimeout(()=>{e("/dashboard")},2e3)):v(h.error||"Failed to start trial. Please try again.")}catch(h){console.error("Error subscribing to pro tier:",h),v("An error occurred. Please try again.")}finally{j(!1)}},w=h=>{switch(h){case"free":d();break;case"pro":T();break;default:v("Invalid tier selection.")}},x=h=>f?"Processing...":(i==null?void 0:i.tier)===h.id?(h.id==="pro","Current Plan"):h.id==="free"?a?"Get Started":"Sign Up & Get Started":"Start Free Trial",F=h=>f||(i==null?void 0:i.tier)===h.id;return c?t.jsx("div",{className:"subscription-tiers",children:t.jsx("div",{className:"loading",children:"Loading subscription options..."})}):t.jsxs("div",{className:"subscription-tiers",children:[t.jsxs("div",{className:"tiers-header",children:[t.jsx("h1",{children:"Creator Pro Plan"}),t.jsx("p",{children:"Start monetizing your content and selling products with ScreenMerch"})]}),M&&t.jsx("div",{className:`message ${M.includes("error")||M.includes("Failed")?"error":"success"}`,children:M}),t.jsx("div",{className:"tiers-container",children:r.map((h,N)=>t.jsxs("div",{className:`tier-card ${h.popular?"popular":""} ${(i==null?void 0:i.tier)===h.id?"current":""}`,style:{borderColor:h.color},children:[h.popular&&t.jsx("div",{className:"popular-badge",style:{backgroundColor:h.color},children:"Most Popular"}),(i==null?void 0:i.tier)===h.id&&t.jsx("div",{className:"current-badge",children:"Current Plan"}),t.jsxs("div",{className:"tier-header",children:[t.jsx("h2",{children:h.name}),t.jsxs("div",{className:"tier-price",children:[t.jsx("span",{className:"price",children:h.price}),h.price!=="Free"&&t.jsx("span",{className:"period",children:"/month"})]}),h.trialText&&t.jsx("div",{className:"trial-text",children:h.trialText})]}),t.jsx("div",{className:"tier-features",children:t.jsx("ul",{children:h.features.map((H,X)=>t.jsxs("li",{children:[t.jsx("span",{className:"checkmark",children:"✓"}),H]},X))})}),t.jsx("div",{className:"tier-action",children:t.jsx("button",{className:`tier-button ${h.popular?"popular":""}`,onClick:()=>w(h.id),disabled:F(h),style:{backgroundColor:h.color},children:x(h)})})]},N))}),t.jsxs("div",{className:"tiers-footer",children:[t.jsxs("p",{children:[t.jsx("strong",{children:"Pro Plan for Creators:"})," Everything you need to monetize your audience, create custom product pages, and earn from merchandise sales with our revenue sharing program."]}),t.jsxs("div",{className:"trial-notice",children:[t.jsx("h3",{children:"🎉 7-Day Free Trial"}),t.jsx("p",{children:t.jsx("strong",{children:"Start your Pro trial today!"})}),t.jsxs("ul",{children:[t.jsx("li",{children:"✅ No charges during the 7-day trial period"}),t.jsx("li",{children:"✅ Cancel anytime before the trial ends"}),t.jsx("li",{children:"✅ After 7 days, you'll be charged $9.99/month"}),t.jsx("li",{children:"✅ Full access to all Pro features during trial"})]})]})]})]})},bl=()=>{const[e]=us(),s=ge(),[r,a]=l.useState(!0),[n,i]=l.useState(!1),[o,c]=l.useState(null);return l.useEffect(()=>{(async()=>{const f=e.get("session_id");if(!f){c("No session ID found"),a(!1);return}try{const M=await(await fetch(`${he.ENDPOINTS.VERIFY_SUBSCRIPTION}/${f}`)).json();if(M.success){const v=await ft.activatePremiumSubscription(M.subscription_id,M.customer_id);v.success?(i(!0),setTimeout(()=>{s("/dashboard")},3e3)):c(v.error||"Failed to activate subscription")}else c(M.message||"Payment verification failed")}catch(j){console.error("Error verifying subscription:",j),c("Failed to verify payment")}finally{a(!1)}})()},[e,s]),r?t.jsx("div",{className:"subscription-success-page",children:t.jsxs("div",{className:"success-container",children:[t.jsx("div",{className:"loading-spinner"}),t.jsx("h2",{children:"Verifying your subscription..."}),t.jsx("p",{children:"Please wait while we confirm your payment."})]})}):o?t.jsx("div",{className:"subscription-success-page",children:t.jsxs("div",{className:"success-container error",children:[t.jsx("div",{className:"error-icon",children:"❌"}),t.jsx("h2",{children:"Subscription Error"}),t.jsx("p",{children:o}),t.jsx("button",{onClick:()=>s("/subscription"),className:"retry-btn",children:"Try Again"})]})}):t.jsx("div",{className:"subscription-success-page",children:t.jsxs("div",{className:"success-container",children:[t.jsx("div",{className:"success-icon",children:"🎉"}),t.jsx("h2",{children:"Welcome to Pro!"}),t.jsx("p",{children:"Your 7-day free trial has been successfully activated."}),t.jsxs("div",{className:"trial-notice",children:[t.jsx("h3",{children:"🎁 7-Day Free Trial Active"}),t.jsx("p",{children:t.jsx("strong",{children:"You're now in your free trial period!"})}),t.jsxs("ul",{children:[t.jsx("li",{children:"✅ No charges for the next 7 days"}),t.jsx("li",{children:"✅ Full access to all Pro features"}),t.jsx("li",{children:"✅ Cancel anytime before trial ends"}),t.jsx("li",{children:"✅ After 7 days, you'll be charged $9.99/month"})]})]}),t.jsxs("div",{className:"premium-features",children:[t.jsx("h3",{children:"You now have access to:"}),t.jsxs("ul",{children:[t.jsx("li",{children:"✅ Upload and share your videos"}),t.jsx("li",{children:"✅ Create custom product pages"}),t.jsx("li",{children:"✅ Sell merchandise with revenue sharing"}),t.jsx("li",{children:"✅ Priority customer support"}),t.jsx("li",{children:"✅ Custom branding and channel colors"}),t.jsx("li",{children:"✅ Enhanced upload limits (2GB, 60 minutes)"}),t.jsx("li",{children:"✅ Analytics and sales tracking"}),t.jsx("li",{children:"✅ Creator dashboard and tools"}),t.jsx("li",{children:"✅ Ad-free viewing experience"}),t.jsx("li",{children:"✅ Early access to new features"})]})]}),t.jsx("p",{className:"redirect-notice",children:"Redirecting to your dashboard in 3 seconds..."}),t.jsx("button",{onClick:()=>s("/dashboard"),className:"dashboard-btn",children:"Go to Dashboard Now"})]})})},_l=()=>{const e=ge(),[s,r]=l.useState(null);return l.useEffect(()=>{const a=localStorage.getItem("order_tracking");if(a)try{const i=JSON.parse(a);r(i),localStorage.removeItem("order_tracking")}catch(i){console.error("Error parsing tracking data:",i)}const n=document.querySelector(".order-success-container");n&&(n.style.opacity="0",n.style.transform="translateY(20px)",setTimeout(()=>{n.style.transition="all 0.5s ease",n.style.opacity="1",n.style.transform="translateY(0)"},100))},[]),t.jsx("div",{className:"order-success-page",children:t.jsxs("div",{className:"order-success-container",children:[t.jsx("div",{className:"success-icon",children:"✅"}),t.jsx("h1",{className:"success-title",children:"Order Successful!"}),t.jsx("div",{className:"thank-you-message",children:t.jsx("p",{children:"Thank you for your order! Your custom merchandise is being created."})}),t.jsxs("div",{className:"next-steps",children:[t.jsx("h3",{children:"What happens next:"}),t.jsxs("ul",{children:[t.jsx("li",{children:"✅ Your order is being processed automatically"}),t.jsx("li",{children:"✅ Products will be created and fulfilled by Printful"}),t.jsx("li",{children:"✅ You'll receive email updates with tracking information"}),t.jsx("li",{children:"✅ Your order will ship within 3-5 business days"})]})]}),s&&t.jsxs("div",{className:"order-details",children:[t.jsx("h3",{children:"📦 Order Details"}),t.jsxs("div",{className:"order-info",children:[t.jsxs("p",{children:[t.jsx("strong",{children:"Order ID:"})," ",s.order_id]}),s.tracking_url&&t.jsxs("p",{children:[t.jsx("strong",{children:"Track your order:"})," ",t.jsx("a",{href:s.tracking_url,target:"_blank",rel:"noopener noreferrer",children:"View Order Status →"})]})]})]}),t.jsx("div",{className:"support-info",children:t.jsxs("p",{children:[t.jsx("strong",{children:"Need help?"})," Contact us at"," ",t.jsx("a",{href:"mailto:support@screenmerch.com",children:"support@screenmerch.com"})]})}),t.jsxs("div",{className:"action-buttons",children:[t.jsx("button",{onClick:()=>e("/"),className:"home-button",children:"Return to Home"}),t.jsx("button",{onClick:()=>e("/dashboard"),className:"dashboard-button",children:"Go to Dashboard"})]})]})})},Nl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA10lEQVR4nO3QPQrCQBQE4NVCbAVrsbEUC72Cnaews02TmRB4XsE72HkIQbG0tdFKRGuxE2ElkJCwaGJ+wCJ5MLDF7veSUao0Y9t2B8Dei3cuGu8DOJPUXgBcAQwLwUmOAdwDPLLkAWCS98unJJ8mHsmL5CyLXSM5j4HNLESk/pMsIg2SyxS49itbiUgzFgfQIrlOizNcsrMsq/2t7y7JQ1acYY6u6/ZMfADgUgCu/dwcxxlFqzkViOvgTz5WlRdWSfO3BSrjvWqBLmdFW/MRgE3We9WopHkDXTJU7bkaB10AAAAASUVORK5CYII=",kl=({sidebar:e,category:s,setCategory:r})=>{const[a,n]=l.useState(!0),[i,o]=l.useState([]),[c,u]=l.useState(!0);return l.useState("platform"),ms(),l.useEffect(()=>{(async()=>{u(!0);try{const{data:j,error:M}=await _.from("users").select(`
            id,
            username,
            display_name,
            profile_image_url,
            created_at
          `).not("username","is",null).order("created_at",{ascending:!1}).limit(10);if(M)console.error("Error fetching platform creators:",M),o([]);else{const v=j.filter(d=>d.username).map(d=>({id:d.id,username:d.username,name:d.display_name||d.username,avatar:d.profile_image_url,joinedAt:d.created_at,type:"platform"}));o(v)}}catch(j){console.error("Error fetching subscribers:",j),o([])}u(!1)})()},[]),t.jsxs("div",{className:`sidebar ${e?"":"small-sidebar"}`,children:[t.jsxs("div",{className:"shortcut-links",children:[t.jsxs(pe,{to:"/",className:`side-link ${s===0?"active":""}`,onClick:()=>r(0),children:[t.jsx("img",{src:Nl,alt:""}),t.jsx("p",{children:"Home"})]}),t.jsx("hr",{})]}),t.jsxs("div",{className:"subscribed-list",children:[t.jsxs("h3",{style:{cursor:"pointer"},onClick:()=>n(f=>!f),children:["CREATORS ",a?"▲":"▼"]}),a&&t.jsx("div",{children:c?t.jsx("div",{className:"loading-subs",children:"Loading creators..."}):i.length===0?t.jsx("div",{className:"no-subs",children:"No creators yet."}):t.jsx("div",{className:"subscribers-list",children:i.map(f=>t.jsx("div",{className:"subscriber-item-container",children:t.jsxs(pe,{to:`/profile/${f.username}`,className:"side-link subscriber-item",children:[t.jsx("img",{src:f.avatar||"/default-avatar.jpg",alt:f.name,className:"subscriber-avatar"}),t.jsx("div",{className:"subscriber-info",children:t.jsx("p",{className:"subscriber-name",children:f.name})})]})},f.id))})})]})]})},Cl=()=>{const e=ge();return t.jsxs("div",{style:{minHeight:"60vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[t.jsx("h1",{style:{fontSize:"3rem",marginBottom:16},children:"🚧 Coming Soon!"}),t.jsx("p",{style:{fontSize:"1.2rem",color:"#555",marginBottom:32},children:"This category or feature is not available yet. Check back soon for updates!"}),t.jsx("button",{onClick:()=>e("/"),style:{padding:"12px 32px",fontSize:"1rem",borderRadius:8,background:"#222",color:"#fff",border:"none",cursor:"pointer"},children:"Back to Home"})]})},Ml=()=>{var p;const[e,s]=l.useState(null),[r,a]=l.useState(!0),[n,i]=l.useState(!1),[o,c]=l.useState("dashboard"),[u,f]=l.useState([]),[j,M]=l.useState([]),[v,d]=l.useState([]),[T,w]=l.useState({}),[x,F]=l.useState(""),[h,N]=l.useState("all"),H=ge();l.useEffect(()=>{X()},[]);const X=async()=>{try{const{data:{user:m}}=await _.auth.getUser();if(!m){H("/");return}if(s(m),!await je.isAdmin()){alert("Access denied. Admin privileges required."),H("/");return}i(!0),W()}catch(m){console.error("Error checking admin status:",m),H("/")}finally{a(!1)}},W=async()=>{await Promise.all([z(),R(),L(),J()])},z=async()=>{try{const m=await je.getUsers(0,100,x,h);f(m.users)}catch(m){console.error("Error loading users:",m)}},R=async()=>{try{const m=await je.getVideos(0,100,x,h);M(m.videos)}catch(m){console.error("Error loading videos:",m)}},L=async()=>{try{const m=await je.getSubscriptions();d(m)}catch(m){console.error("Error loading subscriptions:",m)}},J=async()=>{try{const m=await je.getDashboardStats();w({totalUsers:m.total_users||0,totalVideos:m.total_videos||0,totalSubscriptions:m.total_subscriptions||0,pendingVideos:m.pending_videos||0,activeUsers:m.active_users||0,suspendedUsers:m.suspended_users||0})}catch(m){console.error("Error loading stats:",m)}},b=async(m,E)=>{if(confirm(`Are you sure you want to ${E} this user?`))try{let B;E==="delete"?B=await je.deleteUser(m):E==="suspend"?B=await je.updateUserStatus(m,"suspended"):E==="activate"&&(B=await je.updateUserStatus(m,"active")),B.success?(alert(`User ${E}d successfully`),z()):alert(`Failed to ${E} user: ${B.error}`)}catch(B){console.error(`Error ${E}ing user:`,B),alert(`Failed to ${E} user`)}},P=async(m,E)=>{if(confirm(`Are you sure you want to ${E} this video?`))try{let B;E==="delete"?B=await je.deleteVideo(m):E==="approve"?B=await je.updateVideoStatus(m,"approved"):E==="reject"&&(B=await je.updateVideoStatus(m,"rejected")),B.success?(alert(`Video ${E}d successfully`),R()):alert(`Failed to ${E} video: ${B.error}`)}catch(B){console.error(`Error ${E}ing video:`,B),alert(`Failed to ${E} video`)}},g=u.filter(m=>{var ie,ce;const E=((ie=m.display_name)==null?void 0:ie.toLowerCase().includes(x.toLowerCase()))||((ce=m.email)==null?void 0:ce.toLowerCase().includes(x.toLowerCase())),B=h==="all"||m.status===h;return E&&B}),A=j.filter(m=>{var ie,ce;const E=((ie=m.title)==null?void 0:ie.toLowerCase().includes(x.toLowerCase()))||((ce=m.description)==null?void 0:ce.toLowerCase().includes(x.toLowerCase())),B=h==="all"||m.verification_status===h;return E&&B});return r?t.jsxs("div",{className:"admin-loading",children:[t.jsx("div",{className:"loading-spinner"}),t.jsx("p",{children:"Loading admin panel..."})]}):n?t.jsxs("div",{className:"admin-container",children:[t.jsxs("div",{className:"admin-header",children:[t.jsx("h1",{children:"Admin Portal"}),t.jsxs("div",{className:"admin-user-info",children:[t.jsxs("span",{children:["Welcome, ",((p=e==null?void 0:e.user_metadata)==null?void 0:p.name)||(e==null?void 0:e.email)]}),t.jsx("button",{onClick:()=>H("/"),className:"admin-logout-btn",children:"Back to Site"})]})]}),t.jsxs("div",{className:"admin-content",children:[t.jsxs("div",{className:"admin-sidebar",children:[t.jsx("button",{className:`admin-tab ${o==="dashboard"?"active":""}`,onClick:()=>c("dashboard"),children:"Dashboard"}),t.jsx("button",{className:`admin-tab ${o==="users"?"active":""}`,onClick:()=>c("users"),children:"User Management"}),t.jsx("button",{className:`admin-tab ${o==="videos"?"active":""}`,onClick:()=>c("videos"),children:"Content Moderation"}),t.jsx("button",{className:`admin-tab ${o==="subscriptions"?"active":""}`,onClick:()=>c("subscriptions"),children:"Subscriptions"}),t.jsx("button",{className:`admin-tab ${o==="settings"?"active":""}`,onClick:()=>c("settings"),children:"System Settings"})]}),t.jsxs("div",{className:"admin-main",children:[o==="dashboard"&&t.jsxs("div",{className:"admin-dashboard",children:[t.jsxs("div",{className:"stats-grid",children:[t.jsxs("div",{className:"stat-card",children:[t.jsx("h3",{children:"Total Users"}),t.jsx("p",{className:"stat-number",children:T.totalUsers})]}),t.jsxs("div",{className:"stat-card",children:[t.jsx("h3",{children:"Active Users"}),t.jsx("p",{className:"stat-number",children:T.activeUsers})]}),t.jsxs("div",{className:"stat-card",children:[t.jsx("h3",{children:"Suspended Users"}),t.jsx("p",{className:"stat-number",children:T.suspendedUsers})]}),t.jsxs("div",{className:"stat-card",children:[t.jsx("h3",{children:"Total Videos"}),t.jsx("p",{className:"stat-number",children:T.totalVideos})]}),t.jsxs("div",{className:"stat-card",children:[t.jsx("h3",{children:"Pending Approvals"}),t.jsx("p",{className:"stat-number",children:T.pendingVideos})]}),t.jsxs("div",{className:"stat-card",children:[t.jsx("h3",{children:"Active Subscriptions"}),t.jsx("p",{className:"stat-number",children:T.totalSubscriptions})]})]}),t.jsxs("div",{className:"recent-activity",children:[t.jsx("h3",{children:"Recent Activity"}),t.jsx("div",{className:"activity-list",children:u.slice(0,5).map(m=>t.jsxs("div",{className:"activity-item",children:[t.jsxs("span",{children:["New user: ",m.display_name||m.email]}),t.jsx("span",{children:new Date(m.created_at).toLocaleDateString()})]},m.id))})]})]}),o==="users"&&t.jsxs("div",{className:"admin-users",children:[t.jsxs("div",{className:"admin-filters",children:[t.jsx("input",{type:"text",placeholder:"Search users...",value:x,onChange:m=>F(m.target.value),className:"admin-search"}),t.jsxs("select",{value:h,onChange:m=>N(m.target.value),className:"admin-filter",children:[t.jsx("option",{value:"all",children:"All Status"}),t.jsx("option",{value:"active",children:"Active"}),t.jsx("option",{value:"suspended",children:"Suspended"})]})]}),t.jsx("div",{className:"users-table",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"User"}),t.jsx("th",{children:"Email"}),t.jsx("th",{children:"Joined"}),t.jsx("th",{children:"Status"}),t.jsx("th",{children:"Actions"})]})}),t.jsx("tbody",{children:g.map(m=>t.jsxs("tr",{children:[t.jsx("td",{children:t.jsxs("div",{className:"user-info",children:[t.jsx("img",{src:m.profile_image_url||"/default-avatar.jpg",alt:m.display_name,className:"user-avatar"}),t.jsx("span",{children:m.display_name||"No name"})]})}),t.jsx("td",{children:m.email}),t.jsx("td",{children:new Date(m.created_at).toLocaleDateString()}),t.jsx("td",{children:t.jsx("span",{className:`status-badge ${m.status||"active"}`,children:m.status||"active"})}),t.jsx("td",{children:t.jsxs("div",{className:"action-buttons",children:[t.jsx("button",{onClick:()=>b(m.id,"suspend"),className:"action-btn suspend",disabled:m.status==="suspended",children:"Suspend"}),t.jsx("button",{onClick:()=>b(m.id,"activate"),className:"action-btn activate",disabled:m.status==="active",children:"Activate"}),t.jsx("button",{onClick:()=>b(m.id,"delete"),className:"action-btn delete",children:"Delete"})]})})]},m.id))})]})})]}),o==="videos"&&t.jsxs("div",{className:"admin-videos",children:[t.jsxs("div",{className:"admin-filters",children:[t.jsx("input",{type:"text",placeholder:"Search videos...",value:x,onChange:m=>F(m.target.value),className:"admin-search"}),t.jsxs("select",{value:h,onChange:m=>N(m.target.value),className:"admin-filter",children:[t.jsx("option",{value:"all",children:"All Status"}),t.jsx("option",{value:"pending",children:"Pending"}),t.jsx("option",{value:"approved",children:"Approved"}),t.jsx("option",{value:"rejected",children:"Rejected"})]})]}),t.jsx("div",{className:"videos-table",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Video"}),t.jsx("th",{children:"Creator"}),t.jsx("th",{children:"Status"}),t.jsx("th",{children:"Uploaded"}),t.jsx("th",{children:"Actions"})]})}),t.jsx("tbody",{children:A.map(m=>{var E,B,ie;return t.jsxs("tr",{children:[t.jsx("td",{children:t.jsxs("div",{className:"video-info",children:[t.jsx("img",{src:m.thumbnail||"/default-thumbnail.jpg",alt:m.title,className:"video-thumbnail"}),t.jsxs("div",{children:[t.jsx("h4",{children:m.title}),t.jsxs("p",{children:[(E=m.description)==null?void 0:E.substring(0,100),"..."]})]})]})}),t.jsx("td",{children:((B=m.users)==null?void 0:B.display_name)||((ie=m.users)==null?void 0:ie.email)}),t.jsx("td",{children:t.jsx("span",{className:`status-badge ${m.verification_status}`,children:m.verification_status})}),t.jsx("td",{children:new Date(m.created_at).toLocaleDateString()}),t.jsx("td",{children:t.jsxs("div",{className:"action-buttons",children:[t.jsx("button",{onClick:()=>P(m.id,"approve"),className:"action-btn approve",disabled:m.verification_status==="approved",children:"Approve"}),t.jsx("button",{onClick:()=>P(m.id,"reject"),className:"action-btn reject",disabled:m.verification_status==="rejected",children:"Reject"}),t.jsx("button",{onClick:()=>P(m.id,"delete"),className:"action-btn delete",children:"Delete"})]})})]},m.id)})})]})})]}),o==="subscriptions"&&t.jsxs("div",{className:"admin-subscriptions",children:[t.jsx("h3",{children:"Subscription Management"}),t.jsx("div",{className:"subscriptions-table",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"User"}),t.jsx("th",{children:"Tier"}),t.jsx("th",{children:"Status"}),t.jsx("th",{children:"Start Date"}),t.jsx("th",{children:"End Date"})]})}),t.jsx("tbody",{children:v.map(m=>{var E,B;return t.jsxs("tr",{children:[t.jsx("td",{children:((E=m.users)==null?void 0:E.display_name)||((B=m.users)==null?void 0:B.email)}),t.jsx("td",{children:t.jsx("span",{className:`tier-badge ${m.tier}`,children:m.tier})}),t.jsx("td",{children:t.jsx("span",{className:`status-badge ${m.status}`,children:m.status})}),t.jsx("td",{children:new Date(m.current_period_start).toLocaleDateString()}),t.jsx("td",{children:new Date(m.current_period_end).toLocaleDateString()})]},m.id)})})]})})]}),o==="settings"&&t.jsxs("div",{className:"admin-settings",children:[t.jsx("h3",{children:"System Settings"}),t.jsxs("div",{className:"settings-section",children:[t.jsx("h4",{children:"Admin Configuration"}),t.jsx("p",{children:"Configure admin emails and system settings here."}),t.jsxs("div",{className:"setting-item",children:[t.jsx("label",{children:"Admin Emails (comma-separated):"}),t.jsx("input",{type:"text",placeholder:"admin@example.com, admin2@example.com",className:"setting-input"})]}),t.jsx("button",{className:"save-settings-btn",children:"Save Settings"})]})]})]})]})]}):null},Al=()=>{const[e,s]=l.useState(""),[r,a]=l.useState(""),[n,i]=l.useState(!0),[o,c]=l.useState(""),u=ge(),f=async j=>{if(j.preventDefault(),c(""),n){const{error:M}=await _.auth.signInWithPassword({email:e,password:r});M?c(M.message):(c("Logged in! Redirecting..."),setTimeout(()=>{u("/")},1e3))}else{const{error:M}=await _.auth.signUp({email:e,password:r});c(M?M.message:"Signup successful! Check your email for a confirmation link.")}};return t.jsxs("div",{style:{maxWidth:400,margin:"2rem auto",padding:20,border:"1px solid #ccc",borderRadius:8},children:[t.jsx("h2",{children:n?"Login":"Sign Up"}),t.jsxs("form",{onSubmit:f,children:[t.jsx("input",{type:"email",placeholder:"Email",value:e,required:!0,onChange:j=>s(j.target.value),style:{width:"100%",marginBottom:10,padding:8}}),t.jsx("input",{type:"password",placeholder:"Password",value:r,required:!0,onChange:j=>a(j.target.value),style:{width:"100%",marginBottom:10,padding:8}}),t.jsx("button",{type:"submit",style:{width:"100%",padding:10},children:n?"Login":"Sign Up"})]}),t.jsx("button",{onClick:()=>{i(!n),c("")},style:{marginTop:10,width:"100%",background:"none",border:"none",color:"#007bff",cursor:"pointer"},children:n?"Don't have an account? Sign Up":"Already have an account? Login"}),o&&t.jsx("div",{style:{marginTop:15,color:"red"},children:o})]})},Dl=()=>t.jsx("div",{className:"privacy-policy-container",children:t.jsxs("div",{className:"privacy-policy-content",children:[t.jsx("div",{className:"logo",children:t.jsx("img",{src:Rt,alt:"ScreenMerch Logo",className:"logo-img"})}),t.jsx("h1",{children:"Privacy Policy"}),t.jsx("div",{className:"last-updated",children:"Last Updated: January 2025"}),t.jsxs("section",{children:[t.jsx("h2",{children:"Company Information"}),t.jsxs("p",{children:[t.jsx("strong",{children:"ScreenMerch"})," is committed to protecting your privacy and ensuring the security of your personal information. This Privacy Policy explains how we collect, use, protect, and handle your information when you use our custom merchandise platform and services."]}),t.jsxs("div",{className:"highlight-box",children:[t.jsx("strong",{children:"Contact Information:"}),t.jsx("br",{}),"Company: ScreenMerch",t.jsx("br",{}),"Website: screenmerch.com",t.jsx("br",{}),"Email: support@screenmerch.com",t.jsx("br",{}),"Privacy Officer: support@screenmerch.com"]})]}),t.jsxs("section",{children:[t.jsx("h2",{children:"Information We Collect"}),t.jsx("h3",{children:"Personal Information"}),t.jsxs("ul",{children:[t.jsxs("li",{children:[t.jsx("strong",{children:"Account Information:"})," Name, email address, username, password (encrypted)"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Contact Details:"})," Phone number (for order notifications), mailing address"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Billing Information:"})," Shipping and billing addresses, payment method details (processed securely through Stripe)"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Profile Data:"})," Profile pictures, preferences, customization settings"]})]}),t.jsx("h3",{children:"Content and Usage Information"}),t.jsxs("ul",{children:[t.jsxs("li",{children:[t.jsx("strong",{children:"Video Content:"})," Video files, screenshots, thumbnails, and images you upload"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Custom Designs:"})," Product customizations, text overlays, design modifications"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Order History:"})," Products ordered, preferences, purchase patterns"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Platform Usage:"})," Navigation patterns, feature usage, time spent on platform"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Technical Data:"})," IP address, browser type, device information, operating system"]})]})]}),t.jsxs("section",{className:"security-box",children:[t.jsx("h2",{children:"Content Processing and Protection"}),t.jsx("h3",{children:"Video Content Handling"}),t.jsx("p",{children:t.jsx("strong",{children:"How We Process Your Content:"})}),t.jsxs("ul",{children:[t.jsx("li",{children:"Video content is processed through secure, encrypted servers"}),t.jsx("li",{children:"We extract screenshots and thumbnails for merchandise creation"}),t.jsx("li",{children:"All processing occurs within our protected infrastructure"}),t.jsx("li",{children:"Content is never shared with unauthorized third parties"}),t.jsx("li",{children:"We maintain strict access controls for all uploaded content"})]}),t.jsx("h3",{children:"Content Rights and Usage"}),t.jsxs("ul",{children:[t.jsxs("li",{children:[t.jsx("strong",{children:"Your Content Ownership:"})," You retain ownership of your original content"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Platform License:"})," You grant us limited rights to process content for merchandise creation"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Exclusivity Protection:"})," We ensure your processed content remains exclusive to ScreenMerch"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"No Unauthorized Sharing:"})," Your content is never provided to competing platforms"]})]}),t.jsx("h3",{children:"Data Retention"}),t.jsxs("ul",{children:[t.jsx("li",{children:"Active account content: Retained while account is active"}),t.jsx("li",{children:"Order-related content: Retained for 7 years for legal/tax purposes"}),t.jsx("li",{children:"Backup content: Securely destroyed after 90 days in backups"}),t.jsx("li",{children:"Deleted account content: Permanently removed within 30 days"})]})]}),t.jsxs("section",{className:"sms-section",children:[t.jsx("h2",{children:"SMS Messaging and Communications"}),t.jsx("h3",{children:"SMS Consent and Usage"}),t.jsx("p",{children:"By providing your phone number and checking the SMS consent box during checkout, you explicitly consent to receive SMS text messages from ScreenMerch for the following purposes:"}),t.jsxs("ul",{children:[t.jsxs("li",{children:[t.jsx("strong",{children:"Order Notifications:"})," Updates about your order status, processing, and shipping"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Customer Service:"})," Support communications and order assistance"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Account Security:"})," Two-factor authentication and security alerts"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Important Updates:"})," Critical account or service notifications"]})]}),t.jsxs("div",{className:"highlight-box",children:[t.jsx("strong",{children:"Program Name:"})," ScreenMerch Notifications",t.jsx("br",{}),t.jsx("strong",{children:"Provider:"})," ScreenMerch",t.jsx("br",{}),t.jsx("strong",{children:"Purpose:"})," Order notifications and customer service communications",t.jsx("br",{}),t.jsx("strong",{children:"Frequency:"})," 1-3 messages per order, occasional service messages",t.jsx("br",{}),t.jsx("strong",{children:"Opt-Out:"})," Reply STOP to any SMS to unsubscribe immediately",t.jsx("br",{}),t.jsx("strong",{children:"Help:"})," Reply HELP to any SMS for assistance or contact support@screenmerch.com",t.jsx("br",{}),t.jsx("strong",{children:"Cost:"})," Message and data rates may apply based on your mobile carrier plan"]})]}),t.jsxs("section",{children:[t.jsx("h2",{children:"How We Use Your Information"}),t.jsx("h3",{children:"Primary Uses"}),t.jsxs("ul",{children:[t.jsxs("li",{children:[t.jsx("strong",{children:"Service Delivery:"})," Process and fulfill your custom merchandise orders"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Content Processing:"})," Transform your video content into printable merchandise designs"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Communication:"})," Send order notifications via SMS and email (with consent)"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Customer Support:"})," Provide assistance and resolve issues"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Platform Improvement:"})," Enhance our services and user experience"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Security:"})," Protect against fraud and unauthorized access"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Legal Compliance:"})," Meet regulatory and legal obligations"]})]}),t.jsx("h3",{children:"Platform Exclusivity Protection"}),t.jsxs("ul",{children:[t.jsx("li",{children:"We ensure your content remains exclusive to ScreenMerch platform"}),t.jsx("li",{children:"We monitor and prevent unauthorized use of your processed content"}),t.jsx("li",{children:"We maintain audit trails for content usage and access"})]})]}),t.jsxs("section",{children:[t.jsx("h2",{children:"Data Security and Protection"}),t.jsx("h3",{children:"Technical Safeguards"}),t.jsxs("ul",{children:[t.jsxs("li",{children:[t.jsx("strong",{children:"Encryption:"})," End-to-end encryption for data transmission and storage"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Access Controls:"})," Multi-factor authentication and role-based access"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Monitoring:"})," 24/7 security monitoring and intrusion detection"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Backups:"})," Secure, encrypted backups with restricted access"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Infrastructure:"})," SOC 2 compliant cloud infrastructure"]})]})]}),t.jsxs("section",{children:[t.jsx("h2",{children:"Your Privacy Rights"}),t.jsx("p",{children:"You have the right to:"}),t.jsxs("ul",{children:[t.jsxs("li",{children:[t.jsx("strong",{children:"Access:"})," Request a copy of your personal information"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Correction:"})," Update or correct inaccurate information"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Deletion:"})," Request deletion of your information (subject to legal requirements)"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Portability:"})," Receive your data in a structured, machine-readable format"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Opt-Out:"})," Withdraw consent for SMS communications"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Restriction:"})," Request limitations on how we process your data"]})]})]}),t.jsxs("section",{children:[t.jsx("h2",{children:"Contact Us"}),t.jsx("p",{children:"For privacy-related questions, concerns, or requests, please contact us:"}),t.jsxs("div",{className:"highlight-box",children:[t.jsx("strong",{children:"Privacy Officer:"})," support@screenmerch.com",t.jsx("br",{}),t.jsx("strong",{children:"General Support:"})," support@screenmerch.com",t.jsx("br",{}),t.jsx("strong",{children:"Website:"})," screenmerch.com",t.jsx("br",{}),t.jsx("strong",{children:"SMS Opt-Out:"})," Reply STOP to any message",t.jsx("br",{}),t.jsx("strong",{children:"Data Requests:"})," support@screenmerch.com"]})]}),t.jsxs("div",{className:"navigation-links",children:[t.jsx(pe,{to:"/",className:"nav-link",children:"← Back to ScreenMerch"})," |",t.jsx(pe,{to:"/terms-of-service",className:"nav-link",children:"Terms of Service →"})]})]})}),Pl=()=>t.jsx("div",{className:"terms-container",children:t.jsxs("div",{className:"terms-content",children:[t.jsx("div",{className:"logo",children:t.jsx("img",{src:Rt,alt:"ScreenMerch Logo",className:"logo-img"})}),t.jsx("h1",{children:"Terms of Service"}),t.jsx("div",{className:"last-updated",children:"Last Updated: January 2025"}),t.jsxs("section",{children:[t.jsx("h2",{children:"1. Acceptance of Terms"}),t.jsx("p",{children:'By accessing and using ScreenMerch ("the Service"), you accept and agree to be bound by the terms and provision of this agreement. These Terms of Service ("Terms") govern your use of the ScreenMerch website and services. If you do not agree to these terms, you must not use the Service.'})]}),t.jsxs("section",{children:[t.jsx("h2",{children:"2. Description of Service"}),t.jsx("p",{children:"ScreenMerch is a platform that allows users to create custom merchandise from video content, including screenshots and thumbnails. We facilitate the creation and ordering of custom products through third-party providers. Our platform is designed exclusively for creating merchandise through ScreenMerch services."})]}),t.jsxs("section",{className:"critical-box",children:[t.jsx("h2",{children:"3. CRITICAL: Intellectual Property Protection & Platform Exclusivity"}),t.jsx("h3",{children:"3.1 Reverse Engineering Prohibition"}),t.jsx("p",{children:t.jsx("strong",{children:"YOU EXPRESSLY AGREE AND ACKNOWLEDGE THAT:"})}),t.jsxs("ul",{children:[t.jsx("li",{children:"You will NOT reverse engineer, decompile, disassemble, or attempt to derive the source code of ScreenMerch platform"}),t.jsx("li",{children:"You will NOT attempt to discover underlying algorithms, methods, or processes used by ScreenMerch"}),t.jsx("li",{children:"You will NOT use any automated tools, bots, or scrapers to extract data or functionality from ScreenMerch"}),t.jsx("li",{children:"You will NOT create competing services based on ScreenMerch's functionality or design"}),t.jsx("li",{children:"You will NOT copy, reproduce, or replicate ScreenMerch's user interface, workflows, or business processes"})]}),t.jsx("h3",{children:"3.2 Platform Exclusivity Agreement"}),t.jsx("p",{children:t.jsx("strong",{children:"EXCLUSIVE USE COMMITMENT:"})}),t.jsxs("ul",{children:[t.jsx("li",{children:t.jsx("strong",{children:"You agree that any video images, screenshots, thumbnails, or content processed through ScreenMerch may ONLY be used to create products through ScreenMerch platform"})}),t.jsx("li",{children:"You will NOT use video content processed on ScreenMerch to create merchandise on any other platform (including but not limited to Printful, Teespring, Redbubble, Etsy, Amazon Merch, etc.)"}),t.jsx("li",{children:"You will NOT download, export, or transfer video images from ScreenMerch to create products elsewhere"}),t.jsx("li",{children:"You will NOT share, distribute, or provide ScreenMerch-processed content to third parties for merchandise creation"}),t.jsx("li",{children:"Any custom designs, layouts, or modifications created through ScreenMerch remain exclusive to ScreenMerch platform"})]}),t.jsx("h3",{children:"3.3 Enforcement and Penalties"}),t.jsx("p",{children:"Violation of these exclusivity and protection terms will result in:"}),t.jsxs("ul",{children:[t.jsx("li",{children:"Immediate account termination without refund"}),t.jsx("li",{children:"Legal action for breach of contract and intellectual property infringement"}),t.jsx("li",{children:"Monetary damages including lost profits and legal fees"}),t.jsx("li",{children:"Permanent ban from all ScreenMerch services"})]})]}),t.jsxs("section",{children:[t.jsx("h2",{children:"4. User Accounts"}),t.jsx("h3",{children:"Account Creation"}),t.jsxs("ul",{children:[t.jsx("li",{children:"You may be required to create an account to access certain features"}),t.jsx("li",{children:"You are responsible for maintaining the confidentiality of your account"}),t.jsx("li",{children:"You are responsible for all activities that occur under your account"}),t.jsx("li",{children:"You must provide accurate and complete information when creating an account"}),t.jsx("li",{children:"Each user may only maintain one active account"})]})]}),t.jsxs("section",{children:[t.jsx("h2",{children:"5. Content and Intellectual Property Rights"}),t.jsx("h3",{children:"5.1 User Content Ownership"}),t.jsxs("ul",{children:[t.jsx("li",{children:"You retain ownership of original content you upload to ScreenMerch"}),t.jsx("li",{children:"You grant ScreenMerch a limited, non-exclusive license to process your content for merchandise creation"}),t.jsx("li",{children:"You are responsible for ensuring you have rights to any content you upload"}),t.jsx("li",{children:"You must not upload copyrighted content without proper authorization"})]}),t.jsx("h3",{children:"5.2 ScreenMerch Intellectual Property"}),t.jsxs("ul",{children:[t.jsx("li",{children:"ScreenMerch platform, technology, algorithms, and processes are proprietary and protected"}),t.jsx("li",{children:"All ScreenMerch branding, logos, and design elements are owned by ScreenMerch"}),t.jsx("li",{children:"Product templates, layouts, and customization tools are ScreenMerch intellectual property"}),t.jsx("li",{children:"You may not use ScreenMerch IP for any purpose outside the intended service"})]})]}),t.jsxs("section",{children:[t.jsx("h2",{children:"6. Platform Usage Restrictions"}),t.jsx("h3",{children:"6.1 Prohibited Content"}),t.jsx("p",{children:"You may not upload or create products containing:"}),t.jsxs("ul",{children:[t.jsx("li",{children:"Copyrighted material without authorization"}),t.jsx("li",{children:"Illegal, harmful, threatening, or offensive content"}),t.jsx("li",{children:"Content that violates privacy or publicity rights"}),t.jsx("li",{children:"Trademarked material without permission"}),t.jsx("li",{children:"Adult or explicit content"}),t.jsx("li",{children:"Content promoting violence, hate, or discrimination"})]})]}),t.jsxs("section",{children:[t.jsx("h2",{children:"7. Orders and Payment"}),t.jsx("h3",{children:"7.1 Product Orders"}),t.jsxs("ul",{children:[t.jsx("li",{children:"All orders are subject to acceptance and product availability"}),t.jsx("li",{children:"Prices are displayed in USD and may change without notice"}),t.jsx("li",{children:"Payment is processed securely through Stripe"}),t.jsx("li",{children:"You agree to provide accurate billing information"}),t.jsx("li",{children:"Orders cannot be transferred to other platforms"})]}),t.jsx("h3",{children:"7.2 Refunds and Returns"}),t.jsxs("ul",{children:[t.jsx("li",{children:"Custom merchandise is typically non-refundable due to personalized nature"}),t.jsx("li",{children:"Defective or damaged products may be eligible for replacement"}),t.jsx("li",{children:"Refund requests must be submitted within 30 days of delivery"}),t.jsx("li",{children:"No refunds for violation of exclusivity terms"})]})]}),t.jsxs("section",{children:[t.jsx("h2",{children:"8. Prohibited Uses"}),t.jsx("p",{children:"You may not use ScreenMerch to:"}),t.jsxs("ul",{children:[t.jsx("li",{children:"Upload illegal, harmful, or offensive content"}),t.jsx("li",{children:"Infringe on intellectual property rights"}),t.jsx("li",{children:"Engage in fraudulent or deceptive practices"}),t.jsx("li",{children:"Attempt to circumvent security measures"}),t.jsx("li",{children:"Use automated systems to access the service"}),t.jsx("li",{children:"Reverse engineer or replicate our platform"}),t.jsx("li",{children:"Export content for use on competing platforms"}),t.jsx("li",{children:"Violate platform exclusivity agreements"})]})]}),t.jsxs("section",{children:[t.jsx("h2",{children:"9. Termination"}),t.jsx("h3",{children:"9.1 Termination by ScreenMerch"}),t.jsxs("ul",{children:[t.jsx("li",{children:"We may terminate accounts for violation of these terms"}),t.jsx("li",{children:"Immediate termination for reverse engineering or exclusivity violations"}),t.jsx("li",{children:"We reserve the right to refuse service to anyone"})]}),t.jsx("h3",{children:"9.2 Effect of Termination"}),t.jsxs("ul",{children:[t.jsx("li",{children:"All licenses granted to you terminate immediately"}),t.jsx("li",{children:"You must cease all use of ScreenMerch services"}),t.jsx("li",{children:"Outstanding orders may be cancelled"}),t.jsx("li",{children:"Exclusivity obligations survive termination"})]})]}),t.jsxs("section",{children:[t.jsx("h2",{children:"10. Contact Information"}),t.jsxs("div",{className:"highlight-box",children:[t.jsx("strong",{children:"ScreenMerch Support"}),t.jsx("br",{}),"Email: support@screenmerch.com",t.jsx("br",{}),"Website: screenmerch.com",t.jsx("br",{}),"Legal Issues: support@screenmerch.com"]})]}),t.jsxs("section",{children:[t.jsx("h2",{children:"11. Entire Agreement"}),t.jsx("p",{children:"These Terms of Service, together with our Privacy Policy, constitute the entire agreement between you and ScreenMerch regarding the use of our services."})]}),t.jsxs("div",{className:"navigation-links",children:[t.jsx(pe,{to:"/",className:"nav-link",children:"← Back to ScreenMerch"})," |",t.jsx(pe,{to:"/privacy-policy",className:"nav-link",children:"← Privacy Policy"})]})]})}),Tl=()=>{const[e]=us(),s=ge(),[r,a]=l.useState([]),[n,i]=l.useState(!1),[o,c]=l.useState(""),[u,f]=l.useState("");l.useEffect(()=>{const d=e.get("q");d&&(f(d),j(d))},[e]);const j=async d=>{if(!d||d.trim().length<2){c("Please enter at least 2 characters to search");return}i(!0),c(""),a([]);try{const T=await fetch(`${he.ENDPOINTS.BASE_URL}/api/search/creators?q=${encodeURIComponent(d.trim())}`);if(!T.ok)throw new Error(`Search failed: ${T.status}`);const w=await T.json();w.success?a(w.results||[]):c(w.error||"Search failed")}catch(T){console.error("Search error:",T),c("Unable to search at this time. Please try again.")}finally{i(!1)}},M=d=>{s(`/creator/${d}`)},v=d=>d?new Date(d).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"Unknown";return t.jsx("div",{className:"search-page",children:t.jsxs("div",{className:"search-container",children:[t.jsxs("div",{className:"search-header",children:[t.jsx("h1",{children:"Search Results"}),u&&t.jsxs("p",{className:"search-query",children:["Results for: ",t.jsxs("span",{className:"query-text",children:['"',u,'"']})]})]}),n&&t.jsxs("div",{className:"search-loading",children:[t.jsx("div",{className:"loading-spinner"}),t.jsx("p",{children:"Searching creators..."})]}),o&&t.jsx("div",{className:"search-error",children:t.jsx("p",{children:o})}),!n&&!o&&r.length===0&&u&&t.jsxs("div",{className:"search-no-results",children:[t.jsx("h3",{children:"No creators found"}),t.jsx("p",{children:"Try searching with different keywords or check the spelling."}),t.jsxs("div",{className:"search-suggestions",children:[t.jsx("p",{children:t.jsx("strong",{children:"Tips:"})}),t.jsxs("ul",{children:[t.jsx("li",{children:"Use shorter keywords"}),t.jsx("li",{children:"Try searching by username or display name"}),t.jsx("li",{children:"Check for typos"})]})]})]}),!n&&r.length>0&&t.jsxs("div",{className:"search-results",children:[t.jsx("div",{className:"results-header",children:t.jsxs("p",{className:"results-count",children:["Found ",r.length," creator",r.length!==1?"s":""]})}),t.jsx("div",{className:"creators-grid",children:r.map(d=>{var T,w;return t.jsxs("div",{className:"creator-card",onClick:()=>M(d.id),children:[t.jsxs("div",{className:"creator-avatar",children:[d.profile_image_url?t.jsx("img",{src:d.profile_image_url,alt:d.display_name,onError:x=>{x.target.style.display="none",x.target.nextSibling.style.display="flex"}}):null,t.jsx("div",{className:"avatar-placeholder",style:{display:d.profile_image_url?"none":"flex"},children:((w=(T=d.display_name)==null?void 0:T.charAt(0))==null?void 0:w.toUpperCase())||"?"})]}),t.jsxs("div",{className:"creator-info",children:[t.jsx("h3",{className:"creator-name",children:d.display_name}),t.jsxs("p",{className:"creator-username",children:["@",d.username]}),d.bio&&t.jsx("p",{className:"creator-bio",children:d.bio}),t.jsxs("div",{className:"creator-stats",children:[t.jsxs("span",{className:"video-count",children:[d.video_count||0," video",(d.video_count||0)!==1?"s":""]}),t.jsxs("span",{className:"joined-date",children:["Joined ",v(d.created_at)]})]})]}),t.jsx("div",{className:"creator-action",children:t.jsx("button",{className:"view-profile-btn",children:"View Profile"})})]},d.id)})})]})]})})},El=()=>{console.log("🔍 MerchandiseCategories component loading..."),console.log("🔍 Current URL:",window.location.href),console.log("🔍 Component rendered at:",new Date().toLocaleTimeString());const[e,s]=l.useState(!1),[r,a]=l.useState(!1),[n,i]=l.useState(null),o=(()=>{try{const d=localStorage.getItem("merch_screenshots");return d?JSON.parse(d):[]}catch{return console.warn("Invalid screenshots data in localStorage, clearing..."),localStorage.removeItem("merch_screenshots"),[]}})(),c=localStorage.getItem("merch_thumbnail"),u=(()=>{try{const d=localStorage.getItem("merch_video_data");return d?JSON.parse(d):{}}catch{return console.warn("Invalid video data in localStorage, clearing..."),localStorage.removeItem("merch_video_data"),{}}})();console.log("📸 Screenshots:",o.length),console.log("🎬 Video data:",u);const f=[{name:"Women's",emoji:"👩",category:"womens"},{name:"Men's",emoji:"👨",category:"mens"},{name:"Kids",emoji:"👶",category:"kids"},{name:"Mugs",emoji:"☕",category:"mugs"},{name:"Hats",emoji:"🧢",category:"hats"},{name:"Bags",emoji:"👜",category:"bags"},{name:"Pets",emoji:"🐕",category:"pets"},{name:"Stickers & Magnets",emoji:"🌟",category:"stickers"},{name:"Miscellaneous",emoji:"📦",category:"misc"}],j=async d=>{if(console.log("🎯 Category selected:",d),!(localStorage.getItem("user_authenticated")==="true")){i(d),a(!0);return}await M(d)},M=async d=>{s(!0);try{const T=localStorage.getItem("user_authenticated"),w=localStorage.getItem("user_email"),x=document.referrer||window.location.origin,F=(u==null?void 0:u.title)||"Unknown Video",h=(u==null?void 0:u.channelTitle)||"Unknown Creator";console.log("🔍 Creating product with category:",d),console.log("🔍 Video data:",{videoTitle:F,creatorName:h,videoUrl:x});const N={thumbnail:c,videoUrl:x,videoTitle:F,creatorName:h,screenshots:o.slice(0,6),isAuthenticated:T==="true",userEmail:w||"",category:d};console.log("Request data:",N);const H=await fetch(`${he.BASE_URL}/create_product`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(N)});if(!H.ok)throw new Error(`HTTP error! status: ${H.status}`);const X=await H.json();console.log("✅ Product creation result:",X),X.success?window.location.href=X.product_url:(console.error("❌ Product creation failed:",X.error),alert("Failed to create product. Please try again."))}catch(T){console.error("❌ Error creating product:",T),alert("Error creating product. Please try again.")}finally{s(!1)}},v=async()=>{n&&(await M(n),i(null))};try{return console.log("🔍 About to render component..."),t.jsxs("div",{className:"merchandise-categories",children:[(c||o.length>0)&&t.jsxs("div",{className:"top-section",children:[t.jsx("h3",{children:"Screenshots Selected"}),t.jsxs("div",{className:"screenshots-container",children:[c&&t.jsxs("div",{className:"video-thumbnail-container",children:[t.jsx("img",{src:c,alt:"Video Thumbnail",className:"video-thumbnail"}),t.jsx("span",{className:"thumbnail-label",children:"Video Thumbnail"})]}),o.length>0&&t.jsx("div",{className:"screenshots-grid",children:o.slice(0,6).map((d,T)=>t.jsx("img",{src:d,alt:`Screenshot ${T+1}`,className:"screenshot-thumbnail"},T))})]})]}),t.jsxs("div",{className:"categories-container",children:[t.jsx("h1",{className:"categories-title",children:"Choose Your Product Category"}),t.jsx("p",{className:"categories-subtitle",children:"Select a category to see available products"}),t.jsx("div",{className:"categories-grid",children:f.map((d,T)=>t.jsxs("div",{className:`category-box ${e?"disabled":""}`,onClick:()=>!e&&j(d.category),children:[t.jsx("div",{className:"category-emoji",children:d.emoji}),t.jsx("div",{className:"category-name",children:d.name}),e&&t.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"rgba(147, 51, 234, 0.8)",backdropFilter:"blur(5px)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"600",fontSize:"1.1rem",borderRadius:"20px"},children:"Creating..."})]},T))}),t.jsx("div",{style:{marginTop:"2rem",textAlign:"center"},children:t.jsx("button",{style:{background:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(10px)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"12px",padding:"12px 24px",color:"white",fontSize:"1rem",fontWeight:"500",cursor:"pointer"},onClick:()=>window.history.back(),children:"← Back to Video"})})]}),t.jsx(qt,{isOpen:r,onClose:()=>{a(!1),i(null)},onSuccess:v})]})}catch(d){return console.error("🚨 Error rendering MerchandiseCategories:",d),t.jsxs("div",{style:{padding:"50px",background:"red",color:"white",fontSize:"24px",minHeight:"100vh",textAlign:"center"},children:[t.jsx("h1",{children:"ERROR CAUGHT!"}),t.jsxs("p",{children:["Component failed to render: ",d.message]}),t.jsx("button",{onClick:()=>window.history.back(),children:"← Back to Video"})]})}},Ul=()=>{const[e,s]=l.useState(null),[r,a]=l.useState([]),[n,i]=l.useState(null),[o]=l.useState(l.useRef(null)),[c,u]=l.useState(!1),[f,j]=l.useState(!0);l.useEffect(()=>{const x=localStorage.getItem("screenshot_selection_data");if(x){const F=JSON.parse(x);s(F),i(F.thumbnail),j(!1)}else window.location.href="/"},[]);const M=async()=>{const x=o.current;if(console.log("Grab Screenshot clicked"),!x){alert("Video not loaded yet. Please wait for the video to load.");return}if(r.length>=6){alert("Maximum 6 screenshots allowed. Please delete some screenshots first.");return}const F=(e==null?void 0:e.thumbnail)||(e==null?void 0:e.poster)||x.poster;if(F&&F!=="undefined"&&F!=="null"){console.log("Using video thumbnail as screenshot"),a(N=>[...N,F]),alert("Screenshot captured successfully!");return}console.log("No thumbnail available, creating placeholder");const h=`https://via.placeholder.com/300x200/FF5722/FFFFFF?text=Screenshot+${r.length+1}`;a(N=>[...N,h]),alert("Screenshot captured successfully! (using placeholder)")},v=x=>{a(F=>F.filter((h,N)=>N!==x))},d=()=>{if(r.length===0){alert("No screenshots to clear.");return}window.confirm("Are you sure you want to clear all screenshots? This action cannot be undone.")&&(a([]),alert("All screenshots cleared successfully!"))},T=async()=>{try{if(!(localStorage.getItem("user_authenticated")==="true")){const H={thumbnail:n,videoUrl:e.videoUrl,screenshots:r.slice(0,6)};localStorage.setItem("pending_merch_data",JSON.stringify(H)),u(!0);return}console.log("Make Merch clicked, sending request to:",he.ENDPOINTS.CREATE_PRODUCT);const F={thumbnail:n,videoUrl:e.videoUrl,screenshots:r.slice(0,6)};console.log("Request data:",F);const h=await fetch(he.ENDPOINTS.CREATE_PRODUCT,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(F)});if(console.log("Response status:",h.status),!h.ok){const H=await h.text();throw console.error("Server error response:",H),alert(`Server returned error ${h.status}: ${H}`),new Error(`Server error: ${h.status} - ${H}`)}const N=await h.json();console.log("✅ SUCCESS! Response data:",N),console.log("✅ Product URL:",N.product_url),N.success&&N.product_url?(console.log("🚀 Attempting to open merchandise page:",N.product_url),window.location.href=N.product_url):(console.error("❌ Failed to create product:",N),alert(`Failed to create merch product page: ${N.error||"Unknown error"}`))}catch(x){console.error("Make Merch error:",x),alert(`Error connecting to merch server: ${x.message}. Please check the console for more details.`)}},w=async()=>{const x=localStorage.getItem("pending_merch_data");if(x){localStorage.removeItem("pending_merch_data");try{const F=JSON.parse(x);console.log("Creating merch product after authentication:",F);const h=await fetch(he.ENDPOINTS.CREATE_PRODUCT,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(F)});if(!h.ok)throw new Error(`HTTP error! status: ${h.status}`);const N=await h.json();N.success&&N.product_url?(console.log("Merch product created successfully, redirecting to:",N.product_url),window.location.href=N.product_url):(console.error("Failed to create product:",N),alert(`Failed to create merch product: ${N.error||"Unknown error"}`))}catch(F){console.error("Error creating merch product after auth:",F),alert("Error creating merch product. Please try again.")}}};return f?t.jsx("div",{className:"screenshot-selection-loading",children:"Loading..."}):e?t.jsxs("div",{className:"screenshot-selection-page",children:[t.jsxs("div",{className:"screenshot-selection-header",children:[t.jsx("h1",{children:"Screenshot Selection"}),t.jsx("p",{children:"Capture screenshots from your video to create merchandise"})]}),t.jsxs("div",{className:"screenshot-selection-content",children:[t.jsxs("div",{className:"video-section",children:[t.jsxs("h3",{children:["Video: ",e.videoTitle]}),t.jsx("div",{className:"video-container",children:t.jsx("video",{ref:o,controls:!0,playsInline:!0,style:{width:"100%",maxWidth:"640px",height:"360px",background:"#000"},poster:n||"",src:e.videoUrl,children:"Your browser does not support the video tag."})}),t.jsxs("div",{className:"video-actions",children:[t.jsx("button",{className:"grab-screenshot-btn",onClick:M,disabled:r.length>=6,children:r.length>=6?"Max Screenshots Reached":"Grab Screenshot"}),t.jsx("p",{className:"screenshot-hint",children:'Click "Grab Screenshot" to capture the current frame of the video'})]})]}),t.jsxs("div",{className:"screenshots-section",children:[t.jsxs("div",{className:"screenshots-header",children:[t.jsxs("h3",{children:["Captured Screenshots (",r.length,"/6)"]}),r.length>0&&t.jsx("button",{className:"clear-all-btn",onClick:d,title:"Clear all screenshots",children:"Clear All"})]}),t.jsx("div",{className:"screenshots-grid",children:[0,1,2,3,4,5].map(x=>t.jsxs("div",{className:"screenshot-box",children:[t.jsxs("h4",{children:["Screenshot ",x+1]}),r[x]?t.jsxs("div",{className:"screenshot-wrapper",children:[t.jsx("img",{src:r[x],alt:`Screenshot ${x+1}`,className:"screenshot-preview"}),t.jsx("button",{className:"delete-screenshot-btn",onClick:()=>v(x),title:"Delete screenshot",children:"×"})]}):t.jsx("div",{className:"screenshot-placeholder",children:t.jsx("span",{children:"No screenshot"})})]},x))})]}),t.jsxs("div",{className:"merch-actions",children:[t.jsx("button",{className:"make-merch-btn",onClick:T,disabled:r.length===0,children:r.length===0?"Add Screenshots First":"Create Merchandise"}),t.jsx("p",{className:"merch-hint",children:r.length===0?"Capture at least one screenshot to create merchandise":`Ready to create merchandise with ${r.length} screenshot${r.length!==1?"s":""}`})]})]}),t.jsx(qt,{isOpen:c,onClose:()=>u(!1),onSuccess:w})]}):t.jsx("div",{className:"screenshot-selection-error",children:"No video data found. Please go back and try again."})},Ol=()=>{const[e,s]=l.useState(!1),[r,a]=l.useState(0),[n,i]=l.useState(null),[o,c]=l.useState("All"),u=()=>c("All"),f=ms();l.useEffect(()=>{(async()=>{const v=f.pathname.match(/^\/profile\/(.+)$/);if(v){const d=v[1];try{const T=await fetch(`${he.ENDPOINTS.USER_SUBSCRIPTION}/${d}/subscription`);if(T.ok){const w=await T.json();i(w)}else i({isThirdTier:!1})}catch(T){console.error("Error fetching subscription data:",T),i({isThirdTier:!1})}}else i(null)})()},[f.pathname]);const j=e&&!(n!=null&&n.isThirdTier);return t.jsxs("div",{style:{display:"flex",flexDirection:"column",minHeight:"100vh"},children:[t.jsx(oa,{setSidebar:s,resetCategory:u}),t.jsxs("div",{style:{display:"flex",flex:1},children:[j&&t.jsx(kl,{sidebar:e,category:r,setCategory:a}),t.jsxs("div",{className:"main-content-area",style:{flex:1,display:"flex",flexDirection:"column"},children:[t.jsx("div",{style:{flex:1},children:t.jsxs(Vr,{children:[t.jsx(de,{path:"/",element:t.jsx(ml,{sidebar:e,category:r,selectedCategory:o,setSelectedCategory:c})}),t.jsx(de,{path:"/video/:categoryId/:videoId",element:t.jsx(xl,{})}),t.jsx(de,{path:"/upload",element:t.jsx(yl,{sidebar:e})}),t.jsx(de,{path:"/profile/:username",element:t.jsx(vl,{sidebar:e})}),t.jsx(de,{path:"/approve-subscription",element:t.jsx(jl,{})}),t.jsx(de,{path:"/dashboard",element:t.jsx(wl,{sidebar:e})}),t.jsx(de,{path:"/subscription",element:t.jsx(Sl,{})}),t.jsx(de,{path:"/subscription-success",element:t.jsx(bl,{})}),t.jsx(de,{path:"/success",element:t.jsx(_l,{})}),t.jsx(de,{path:"/coming-soon",element:t.jsx(Cl,{})}),t.jsx(de,{path:"/admin",element:t.jsx(Ml,{})}),t.jsx(de,{path:"/auth",element:t.jsx(Al,{})}),t.jsx(de,{path:"/privacy-policy",element:t.jsx(Dl,{})}),t.jsx(de,{path:"/terms-of-service",element:t.jsx(Pl,{})}),t.jsx(de,{path:"/search",element:t.jsx(Tl,{})}),t.jsx(de,{path:"/merchandise",element:t.jsx(El,{})}),t.jsx(de,{path:"/screenshot-selection",element:t.jsx(Ul,{})})]})}),t.jsx(la,{})]})]})]})};rs.createRoot(document.getElementById("root")).render(t.jsx($r.StrictMode,{children:t.jsx(Br,{children:t.jsx(Ol,{})})}))});export default Rl();
